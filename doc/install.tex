%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\part{Installing and using the system}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Installing and using the system}
\cutname{install.html}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This part of the manual gives basic information to get and install the
system.

\section{Simple installation procedure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In order to quickly install the last version of \TOM, the best thing
to do is the following:
{\bf
\begin{itemize}
\item browse the \ahref{\tompage}{TOM Home Page}
\item get the last jtom-bundle-verion.jar distribution
\item get the associated scripts
\item customize the scripts according to your system
\end{itemize}
}

\section{Requirements and download}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The current version of \TOM\ is available at \ahref{\tompage}{TOM Home Page}.
In this page, you will find two kinds of releases:

\begin{itemize}
\item The stable distribution corresponds to major releases of \TOM;
\item The ``Cutting Edge'' distribution corresponds to the last
  releases of \TOM. This is a way for keeping your system in sync with
  the latest developments. Be warned--the cutting edge is not for
  everyone! 
\end{itemize}

Depending on the distribution, \TOM\ is avaible in different formats:
\begin{itemize}
\item Releases: is a way to get a major release as a software package;
\item Bundles: is  a way to get a major release of \TOM, including all
  needed dependencies;
\item Jar distributions: corresponds to compiled stable versions of \TOM;
\item Jar devel distributions: corresponds to compiled development versions of \TOM;
\item Daily distribution: is a snapshot of the source control;
  system. This is a way to get the last version of a package that pass
  all the regression tests;

\item CVS distribution: is a way to get the last source version of the
  system.
\end{itemize}

\paragraph{Compiling and runtime tools}
\TOM\ is written in Java and \TOM\ itself. You will need a Java
compiler and interpreter to compile and run \TOM. 
\\We actually use Sun JDK 1.3.1 and 1.4 tools for development and runtime
excecution.
\\Some tests have already been realized with gcj
and Jikes without any particular issues.

\paragraph{Package dependencies}
\TOM\ software depends on others packages:
\begin{itemize}
\item shared-objects
\item JJTraveler
\item aterm-java
\end{itemize}
The following figure shows the dependencies order:

\imgsrc{depgraphjtom.pgn}

Such packages are available at:
\begin{itemize}
\item \ahref{\tompage}{\TOM\ Home Page}
\item \ahref{\packagebase}{CWI package base Page}
\end{itemize}    

\section{Installation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Depending on the\TOM\ package you download, here is the installation
instructions.

\subsection{Installing the bundle package}
This is the simplest way to have quickly \TOM\ running on your
computer.
\begin{itemize}
\item Untar the package:
\begin{verbatim}
  > tar xzf jtom-bundle-VERSION.tar.gz
\end{verbatim}
\item Download and unpack the required packages:
\begin{verbatim}
  > ./collect.sh
\end{verbatim}
\item Configure, build and install:
\begin{verbatim}
  > ./configure --help gives a complete list of available configuration parameters.
  > ./configure <<configuration parameters>>
  > gmake
\end{verbatim}
\end{itemize}

Once all is done, you are ready using \TOM\ using jtom command.

\subsection{Installing \TOM\ package}

\paragraph{Installation process}
\begin{enumerate}
\item Get and install the shared-objects package
\begin{verbatim}
 a. Type `./configure --prefix=<SHARED-DIR>'
 b. Type `make'
 c. Type `make install'
\end{verbatim}
\item Get and install the JJTraveler package
\begin{verbatim}
 a. Type `./configure --prefix=<JJT-DIR>'
 b. Type `make'
 c. Type `make install'
\end{verbatim}
\item Get and install the aterm-java package
\begin{verbatim}
 a. Type `./configure --prefix=<ATERM-DIR>
                      --with-JJTraveler=<JJT-DIR> 
                      --with-shared-objects=<SHARED-DIR>' 
 b. Type `make'
 c. Type `make install'
\end{verbatim}
\item Configure and install \TOM\ package:
\begin{verbatim}
 a. `./configure --prefix=<INSTALLDIR>
                 --with-shared-objects=<SHARED-DIR> 
                 --with-aterm-java=<ATERM-DIR>'
 b. Type `make' to compile the package.
 c. Type `make install' to install the package.
\end{verbatim}
\end{enumerate}


\section{Command line Arguments}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{NAME}
     jtom - compile \TOM\ file (.t) into specified target languages

\subsection{SYNOPSIS}
\verb|        jtom [-hceVvioDCfWldpsO] [-I path] filename[.t]|

\subsection{DESCRIPTION}
\begin{tabular}{|l|l|}
\hline
\verb#--help | -h#&            Show the help \\
\verb#--cCode | -c#&           Generate C code (default is Java)\\
\verb#--eCode | -e#&           Generate Eiffel code (default is Java)\\
\verb#--version | -V#&         Print the version of TOM\\
\verb#--verbose | -v#&         Set verbose mode on: give duration
                               information on each compilation passes\\
\verb#--intermediate | -i#&    Generate intermediate files \\
\verb#--noOutput | -o#&        Do not generate code \\
\verb#--noDeclaration | -D#&   Do not generate code for declarations \\
\verb#--doCompile | -C#&       Start after type-checking (used after a
                               compilation process with --intermediate option\\
\verb#--noCheck | -f#&         Do not realize checking phases \\
\verb#--Wall#&       Print all warnings \\
\verb#--noWarning#&       Do not print warning \\
\verb#--lazyType | -l#&        Use universal type \\
\verb#--import <path> | -I#&   Path for \%include construct to find included files\\
\verb#--pretty | -p#&          Generate readable code with indentation \\
\verb#--atermStat | -s#&       Print internal ATerm statistics \\
\verb#--optimize | -O#&        Optimized generated code \\
\verb#--static#&               Generate static functions \\
\verb#--debug#&                Generate debug primitives \\
\verb#--memory#&               Add memory management while debugging (not correct with list matching)\\
\hline
\end{tabular}

\section{For developpers}\label{developpers}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{CVS repository}
The latest developments of \TOM\ are available from anonymous cvs at:
\\cvs -d :pserver:cvs@cvs-sop.inria.fr:/CVS/aircube checkout jtom
\paragraph{\TOM\ Architecture}
In \TOM\ directory architecture, 2 main branches can be underlined:
`stable' and `src'...
The `stable' branch contains the stable material to build a running
\TOM\ compiler. The `src' branch is used to make new developments.
Once in src directory, you can modify the sources. then, 
\begin{enumerate}
\item Type `make' to build a new system and use jtom.src to use and
  test the new system.
\item At `src' directory level, type `make bootstrap' to bootstrap and
  install a new system.
  If something goes wrong, re-install the stable version:
  `cd ../../stable'; `make install'
  Then, correct the `src' directory
\item If you are happy from the result, type `make bootinstall' to
  make the current version become the stable one.   WARNING: this action may be VERY DANGEROUS !!!
\end{enumerate}
Please send a mail to \mailto{Pierre-Etienne.Moreau@loria.fr} to propose your
suggestions.

\paragraph{Additional tools for developments}
To simplify \TOM\ development, an extra package called Apigen is used
to generate data structures used by \TOM. All generated files can be
found in `jtom $\backslash$adt' directory.
\\This package is available at
\ahref{\packagebase}{CWI package base Page}.
WARNING: We will need to install JUnit to build this package.
Once TomSignature.adt is modified, `make api' to re-generate \TOM\
data structures.
 

<project name="imported" basedir="." default="...">

  <property name="javacSource" value="1.4"/>
  <property name="javacTarget" value="1.4"/>
  <property name="nowarnings"  value="false"/>
  <property name="optimize"    value="on"/>
  <property name="optimize2"   value="off"/>
  <property name="verbose"     value="off"/>
  <property name="pretty"      value="off"/>
  <property name="visitable"   value="on"/>
  <property name="tomfork"     value="on"/>
  <property name="memoryInitSize" value="512m" />
  <property name="memoryMaxSize"  value="1024m" />

  <property environment="env"/>
  <property name="tom.home"    value="${env.TOM_HOME}"/>

  <property name="tomconfigfile"  location="${tom.home}/Tom.xml"/>
  <property name="gomconfigfile"  location="${tom.home}/Gom.xml"/>

  <path id="external.classpath">
    <fileset dir="${user.home}/.ant/lib/">
      <include name="*.jar"/>
    </fileset>
  </path>

  <target name="tom.init">
    <fail unless="tom.home"
          message="tom.home has to be defined in your environment,
          to find the Tom classes"/>
    <!-- Define the classpath to run tom and related tools -->
    <path id="tom.classpath">
      <path refid="external.classpath"/>
      <fileset dir="${tom.home}/lib">
        <include name="*.jar"/>
      </fileset>
    </path>

    <taskdef name="tom"
             classname="tom.engine.tools.ant.TomTask"
             classpathref="tom.classpath"/>
    <taskdef name="tomantlr"
             classname="org.apache.tools.ant.taskdefs.optional.ANTLR">
      <classpath refid="tom.classpath"/>
    </taskdef>
    <taskdef name="gom"
             classname="tom.gom.tools.ant.GomTask"
             classpathref="tom.classpath"/>
    <taskdef name="antlrmapper"
             classname="tom.antlrmapper.AntTask"
             classpathref="tom.classpath"/>
    <taskdef name="tom.junit"
             classname="org.apache.tools.ant.taskdefs.optional.junit.JUnitTask"
             classpathref="tom.classpath"/>

    <presetdef name="tom.preset">
      <tom config="${tomconfigfile}"
           nowarn="${nowarnings}"
           optimize="${optimize}"
           optimize2="${optimize2}"
           verbose="${verbose}"
           fork="${tomfork}"
           pretty="${pretty}">
        <classpath refid="tom.classpath"/>
      </tom>
    </presetdef>

    <presetdef name="gom.preset">
      <gom config="${gomconfigfile}">
        <classpath refid="tom.classpath"/>
      </gom>
    </presetdef>

    <presetdef name="javac.preset">
      <javac target="${javacTarget}"
             source="${javacSource}"
             nowarn="${nowarnings}"
             fork="${tomfork}"
             memoryInitialSize="${memoryInitSize}"
             memoryMaximumSize="${memoryMaxSize}">
        <classpath refid="tom.classpath"/>
      </javac>
    </presetdef>
  </target>
</project>

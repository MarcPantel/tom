/* Generated by TOM (version 2.6): Do not edit this file *//*
 *
 * TOM - To One Matching Compiler
 *
 * Copyright (c) 2000-2008, INRIA
 * Nancy, France.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 * Pierre-Etienne Moreau  e-mail: Pierre-Etienne.Moreau@loria.fr
 * Antoine Reilles        e-mail: Antoine.Reilles@loria.fr
 *
 **/

package tom.engine.verifier;

import tom.engine.*;
import aterm.*;
import java.util.*;
import tom.engine.tools.SymbolTable;

import tom.engine.adt.tomsignature.*;
import tom.engine.adt.tomconstraint.types.*;
import tom.engine.adt.tomdeclaration.types.*;
import tom.engine.adt.tomexpression.types.*;
import tom.engine.adt.tominstruction.types.*;
import tom.engine.adt.tomname.types.*;
import tom.engine.adt.tomoption.types.*;
import tom.engine.adt.tomsignature.types.*;
import tom.engine.adt.tomterm.types.*;
import tom.engine.adt.tomslot.types.*;
import tom.engine.adt.tomtype.types.*;
import tom.engine.adt.il.*;
import tom.engine.adt.il.types.*;
import tom.library.sl.Strategy;
import tom.library.sl.VisitFailure;
import tom.library.sl.Introspector;
import tom.library.sl.BasicStrategy;

import tom.engine.exception.TomRuntimeException;

public class Verifier {

  // ------------------------------------------------------------
  /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */  /* Generated by TOM (version 2.6): Do not edit this file */    public static   tom.engine.adt.tominstruction.types.InstructionList  tom_append_list_concInstruction( tom.engine.adt.tominstruction.types.InstructionList l1,  tom.engine.adt.tominstruction.types.InstructionList  l2) {     if( l1.isEmptyconcInstruction() ) {       return l2;     } else if( l2.isEmptyconcInstruction() ) {       return l1;     } else if(  l1.getTailconcInstruction() .isEmptyconcInstruction() ) {       return  tom.engine.adt.tominstruction.types.instructionlist.ConsconcInstruction.make( l1.getHeadconcInstruction() ,l2) ;     } else {       return  tom.engine.adt.tominstruction.types.instructionlist.ConsconcInstruction.make( l1.getHeadconcInstruction() ,tom_append_list_concInstruction( l1.getTailconcInstruction() ,l2)) ;     }   }   public static   tom.engine.adt.tominstruction.types.InstructionList  tom_get_slice_concInstruction( tom.engine.adt.tominstruction.types.InstructionList  begin,  tom.engine.adt.tominstruction.types.InstructionList  end, tom.engine.adt.tominstruction.types.InstructionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcInstruction()  ||  (end== tom.engine.adt.tominstruction.types.instructionlist.EmptyconcInstruction.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.tominstruction.types.instructionlist.ConsconcInstruction.make( begin.getHeadconcInstruction() ,( tom.engine.adt.tominstruction.types.InstructionList )tom_get_slice_concInstruction( begin.getTailconcInstruction() ,end,tail)) ;   }    /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */     public static   tom.engine.adt.il.types.InstrList  tom_append_list_semicolon( tom.engine.adt.il.types.InstrList l1,  tom.engine.adt.il.types.InstrList  l2) {     if( l1.isEmptysemicolon() ) {       return l2;     } else if( l2.isEmptysemicolon() ) {       return l1;     } else if(  l1.getTailsemicolon() .isEmptysemicolon() ) {       return  tom.engine.adt.il.types.instrlist.Conssemicolon.make( l1.getHeadsemicolon() ,l2) ;     } else {       return  tom.engine.adt.il.types.instrlist.Conssemicolon.make( l1.getHeadsemicolon() ,tom_append_list_semicolon( l1.getTailsemicolon() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.InstrList  tom_get_slice_semicolon( tom.engine.adt.il.types.InstrList  begin,  tom.engine.adt.il.types.InstrList  end, tom.engine.adt.il.types.InstrList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptysemicolon()  ||  (end== tom.engine.adt.il.types.instrlist.Emptysemicolon.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.instrlist.Conssemicolon.make( begin.getHeadsemicolon() ,( tom.engine.adt.il.types.InstrList )tom_get_slice_semicolon( begin.getTailsemicolon() ,end,tail)) ;   }      public static   tom.engine.adt.il.types.ExprList  tom_append_list_concExpr( tom.engine.adt.il.types.ExprList l1,  tom.engine.adt.il.types.ExprList  l2) {     if( l1.isEmptyconcExpr() ) {       return l2;     } else if( l2.isEmptyconcExpr() ) {       return l1;     } else if(  l1.getTailconcExpr() .isEmptyconcExpr() ) {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,l2) ;     } else {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,tom_append_list_concExpr( l1.getTailconcExpr() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.ExprList  tom_get_slice_concExpr( tom.engine.adt.il.types.ExprList  begin,  tom.engine.adt.il.types.ExprList  end, tom.engine.adt.il.types.ExprList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcExpr()  ||  (end== tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( begin.getHeadconcExpr() ,( tom.engine.adt.il.types.ExprList )tom_get_slice_concExpr( begin.getTailconcExpr() ,end,tail)) ;   }      public static   tom.engine.adt.il.types.SubstitutionList  tom_append_list_subs( tom.engine.adt.il.types.SubstitutionList l1,  tom.engine.adt.il.types.SubstitutionList  l2) {     if( l1.isEmptysubs() ) {       return l2;     } else if( l2.isEmptysubs() ) {       return l1;     } else if(  l1.getTailsubs() .isEmptysubs() ) {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,l2) ;     } else {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,tom_append_list_subs( l1.getTailsubs() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.SubstitutionList  tom_get_slice_subs( tom.engine.adt.il.types.SubstitutionList  begin,  tom.engine.adt.il.types.SubstitutionList  end, tom.engine.adt.il.types.SubstitutionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptysubs()  ||  (end== tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( begin.getHeadsubs() ,( tom.engine.adt.il.types.SubstitutionList )tom_get_slice_subs( begin.getTailsubs() ,end,tail)) ;   }      public static   tom.engine.adt.il.types.TermList  tom_append_list_concTerm( tom.engine.adt.il.types.TermList l1,  tom.engine.adt.il.types.TermList  l2) {     if( l1.isEmptyconcTerm() ) {       return l2;     } else if( l2.isEmptyconcTerm() ) {       return l1;     } else if(  l1.getTailconcTerm() .isEmptyconcTerm() ) {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,l2) ;     } else {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,tom_append_list_concTerm( l1.getTailconcTerm() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.TermList  tom_get_slice_concTerm( tom.engine.adt.il.types.TermList  begin,  tom.engine.adt.il.types.TermList  end, tom.engine.adt.il.types.TermList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcTerm()  ||  (end== tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( begin.getHeadconcTerm() ,( tom.engine.adt.il.types.TermList )tom_get_slice_concTerm( begin.getTailconcTerm() ,end,tail)) ;   }    /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */   public static   tom.library.sl.Strategy  tom_append_list_Sequence( tom.library.sl.Strategy  l1,  tom.library.sl.Strategy  l2) {     if(( l1 == null )) {       return l2;     } else if(( l2 == null )) {       return l1;     } else if(( (l1 instanceof tom.library.sl.Sequence) )) {       if(( ((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )) == null )) {         return ( (l2==null)?((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1):new tom.library.sl.Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1),l2) );       } else {         return ( (tom_append_list_Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),l2)==null)?((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1):new tom.library.sl.Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1),tom_append_list_Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),l2)) );       }     } else {       return ( (l2==null)?l1:new tom.library.sl.Sequence(l1,l2) );     }   }   public static   tom.library.sl.Strategy  tom_get_slice_Sequence( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if( (begin.equals(end)) ) {       return tail;     } else if( (end.equals(tail))  && (( end == null ) ||  (end.equals(( null ))) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return ( (( tom.library.sl.Strategy )tom_get_slice_Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),end,tail)==null)?((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.FIRST) ):begin):new tom.library.sl.Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.FIRST) ):begin),( tom.library.sl.Strategy )tom_get_slice_Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),end,tail)) );   }      public static   tom.library.sl.Strategy  tom_append_list_Choice( tom.library.sl.Strategy  l1,  tom.library.sl.Strategy  l2) {     if(( l1 ==null )) {       return l2;     } else if(( l2 ==null )) {       return l1;     } else if(( (l1 instanceof tom.library.sl.Choice) )) {       if(( ((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.THEN) ):( null )) ==null )) {         return ( (l2==null)?((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.FIRST) ):l1):new tom.library.sl.Choice(((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.FIRST) ):l1),l2) );       } else {         return ( (tom_append_list_Choice(((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.THEN) ):( null )),l2)==null)?((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.FIRST) ):l1):new tom.library.sl.Choice(((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.FIRST) ):l1),tom_append_list_Choice(((( (l1 instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Choice.THEN) ):( null )),l2)) );       }     } else {       return ( (l2==null)?l1:new tom.library.sl.Choice(l1,l2) );     }   }   public static   tom.library.sl.Strategy  tom_get_slice_Choice( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if( (begin.equals(end)) ) {       return tail;     } else if( (end.equals(tail))  && (( end ==null ) ||  (end.equals(( null ))) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return ( (( tom.library.sl.Strategy )tom_get_slice_Choice(((( (begin instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Choice.THEN) ):( null )),end,tail)==null)?((( (begin instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Choice.FIRST) ):begin):new tom.library.sl.Choice(((( (begin instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Choice.FIRST) ):begin),( tom.library.sl.Strategy )tom_get_slice_Choice(((( (begin instanceof tom.library.sl.Choice) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Choice.THEN) ):( null )),end,tail)) );   }      public static   tom.library.sl.Strategy  tom_append_list_SequenceId( tom.library.sl.Strategy  l1,  tom.library.sl.Strategy  l2) {     if(( l1 == null )) {       return l2;     } else if(( l2 == null )) {       return l1;     } else if(( (l1 instanceof tom.library.sl.SequenceId) )) {       if(( ((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.THEN) ):( null )) == null )) {         return ( (l2==null)?((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.FIRST) ):l1):new tom.library.sl.SequenceId(((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.FIRST) ):l1),l2) );       } else {         return ( (tom_append_list_SequenceId(((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.THEN) ):( null )),l2)==null)?((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.FIRST) ):l1):new tom.library.sl.SequenceId(((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.FIRST) ):l1),tom_append_list_SequenceId(((( (l1 instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.SequenceId.THEN) ):( null )),l2)) );       }     } else {       return ( (l2==null)?l1:new tom.library.sl.SequenceId(l1,l2) );     }   }   public static   tom.library.sl.Strategy  tom_get_slice_SequenceId( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if( (begin.equals(end)) ) {       return tail;     } else if( (end.equals(tail))  && (( end == null ) ||  (end.equals(( null ))) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return ( (( tom.library.sl.Strategy )tom_get_slice_SequenceId(((( (begin instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.SequenceId.THEN) ):( null )),end,tail)==null)?((( (begin instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.SequenceId.FIRST) ):begin):new tom.library.sl.SequenceId(((( (begin instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.SequenceId.FIRST) ):begin),( tom.library.sl.Strategy )tom_get_slice_SequenceId(((( (begin instanceof tom.library.sl.SequenceId) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.SequenceId.THEN) ):( null )),end,tail)) );   }    /* Generated by TOM (version 2.6): Do not edit this file */ /* Generated by TOM (version 2.6): Do not edit this file */public static  tom.library.sl.Strategy  tom_make_Try( tom.library.sl.Strategy  v) { return ( ( (( (( null )==null)?( new tom.library.sl.Identity() ):new tom.library.sl.Choice(( new tom.library.sl.Identity() ),( null )) )==null)?v:new tom.library.sl.Choice(v,( (( null )==null)?( new tom.library.sl.Identity() ):new tom.library.sl.Choice(( new tom.library.sl.Identity() ),( null )) )) ) );}public static  tom.library.sl.Strategy  tom_make_TopDown( tom.library.sl.Strategy  v) { return ( ( new tom.library.sl.Mu(( new tom.library.sl.MuVar("_x") ),( (( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ),( null )) )==null)?v:new tom.library.sl.Sequence(v,( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ),( null )) )) )) ) );}public static  tom.library.sl.Strategy  tom_make_InnermostId( tom.library.sl.Strategy  v) { return ( ( new tom.library.sl.Mu(( new tom.library.sl.MuVar("_x") ),( (( (( null )==null)?( (( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )==null)?v:new tom.library.sl.SequenceId(v,( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )) ):new tom.library.sl.Sequence(( (( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )==null)?v:new tom.library.sl.SequenceId(v,( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )) ),( null )) )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ),( (( null )==null)?( (( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )==null)?v:new tom.library.sl.SequenceId(v,( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )) ):new tom.library.sl.Sequence(( (( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )==null)?v:new tom.library.sl.SequenceId(v,( (( null )==null)?( new tom.library.sl.MuVar("_x") ):new tom.library.sl.SequenceId(( new tom.library.sl.MuVar("_x") ),( null )) )) ),( null )) )) )) ) );}   /* Generated by TOM (version 2.6): Do not edit this file */ 











  // ------------------------------------------------------------

  private SymbolTable symbolTable;
  private boolean camlsemantics = false;

  public Verifier(boolean camlsemantics) {
    super();
    this.camlsemantics = camlsemantics;
  }

  public void setSymbolTable(SymbolTable symbolTable) {
    this.symbolTable = symbolTable;
  }

  public SymbolTable getSymbolTable() {
    return symbolTable;
  }

  public boolean isCamlSemantics() {
    return camlsemantics;
  }

  public Term termFromTomTerm(TomTerm tomterm) {
    {{ Object tomMatch292NameNumber_freshVar_0=tomterm;if ( (tomMatch292NameNumber_freshVar_0 instanceof tom.engine.adt.tomterm.types.TomTerm) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch292NameNumber_freshSubject_1=(( tom.engine.adt.tomterm.types.TomTerm )tomMatch292NameNumber_freshVar_0);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch292NameNumber_freshVar_2=tomMatch292NameNumber_freshSubject_1;if ( (tomMatch292NameNumber_freshVar_2 instanceof tom.engine.adt.tomterm.types.tomterm.ExpressionToTomTerm) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch292NameNumber_freshVar_1= tomMatch292NameNumber_freshVar_2.getAstExpression() ;

        return termFromExpresssion(tomMatch292NameNumber_freshVar_1);
      }}}}}}{ Object tomMatch292NameNumber_freshVar_3=tomterm;if ( (tomMatch292NameNumber_freshVar_3 instanceof tom.engine.adt.tomterm.types.TomTerm) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch292NameNumber_freshSubject_1=(( tom.engine.adt.tomterm.types.TomTerm )tomMatch292NameNumber_freshVar_3);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch292NameNumber_freshVar_5=tomMatch292NameNumber_freshSubject_1;if ( (tomMatch292NameNumber_freshVar_5 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch292NameNumber_freshVar_4= tomMatch292NameNumber_freshVar_5.getAstName() ;

        return termFromTomName(tomMatch292NameNumber_freshVar_4);
      }}}}}}}

    System.out.println("termFromTomTerm don't know how to handle this: " + tomterm);
    return  tom.engine.adt.il.types.term.repr.make("foirade") ;
  }

  Variable variableFromTomName(TomName name) {
    {{ Object tomMatch293NameNumber_freshVar_0=name;if ( (tomMatch293NameNumber_freshVar_0 instanceof tom.engine.adt.tomname.types.TomName) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshSubject_1=(( tom.engine.adt.tomname.types.TomName )tomMatch293NameNumber_freshVar_0);{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshVar_2=tomMatch293NameNumber_freshSubject_1;if ( (tomMatch293NameNumber_freshVar_2 instanceof tom.engine.adt.tomname.types.tomname.Name) ) {{  String  tomMatch293NameNumber_freshVar_1= tomMatch293NameNumber_freshVar_2.getString() ;

        return  tom.engine.adt.il.types.variable.var.make(tomMatch293NameNumber_freshVar_1) ;
      }}}}}}{ Object tomMatch293NameNumber_freshVar_3=name;if ( (tomMatch293NameNumber_freshVar_3 instanceof tom.engine.adt.tomname.types.TomName) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshSubject_1=(( tom.engine.adt.tomname.types.TomName )tomMatch293NameNumber_freshVar_3);{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshVar_5=tomMatch293NameNumber_freshSubject_1;if ( (tomMatch293NameNumber_freshVar_5 instanceof tom.engine.adt.tomname.types.tomname.PositionName) ) {{  tom.engine.adt.tomname.types.TomNumberList  tomMatch293NameNumber_freshVar_4= tomMatch293NameNumber_freshVar_5.getNumberList() ;

        return  tom.engine.adt.il.types.variable.var.make(TomBase.tomNumberListToString(tomMatch293NameNumber_freshVar_4)) ;
      }}}}}}{ Object tomMatch293NameNumber_freshVar_6=name;if ( (tomMatch293NameNumber_freshVar_6 instanceof tom.engine.adt.tomname.types.TomName) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshSubject_1=(( tom.engine.adt.tomname.types.TomName )tomMatch293NameNumber_freshVar_6);{  tom.engine.adt.tomname.types.TomName  tomMatch293NameNumber_freshVar_7=tomMatch293NameNumber_freshSubject_1;if ( (tomMatch293NameNumber_freshVar_7 instanceof tom.engine.adt.tomname.types.tomname.EmptyName) ) {

        return  tom.engine.adt.il.types.variable.var.make("emptyName") ;
      }}}}}}

    return  tom.engine.adt.il.types.variable.var.make("error while building variable name") ;
  }

  Term termFromTomName(TomName name) {
    return  tom.engine.adt.il.types.term.tau.make( tom.engine.adt.il.types.absterm.absvar.make(variableFromTomName(name)) ) ;
  }

  public Term termFromExpresssion(Expression expression) {
    {{ Object tomMatch294NameNumber_freshVar_0=expression;if ( (tomMatch294NameNumber_freshVar_0 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch294NameNumber_freshVar_0);{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshVar_4=tomMatch294NameNumber_freshSubject_1;if ( (tomMatch294NameNumber_freshVar_4 instanceof tom.engine.adt.tomexpression.types.expression.GetSlot) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch294NameNumber_freshVar_1= tomMatch294NameNumber_freshVar_4.getAstName() ;{  String  tomMatch294NameNumber_freshVar_2= tomMatch294NameNumber_freshVar_4.getSlotNameString() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch294NameNumber_freshVar_3= tomMatch294NameNumber_freshVar_4.getVariable() ;{  tom.engine.adt.tomname.types.TomName  tomMatch294NameNumber_freshVar_6=tomMatch294NameNumber_freshVar_1;if ( (tomMatch294NameNumber_freshVar_6 instanceof tom.engine.adt.tomname.types.tomname.Name) ) {{  String  tomMatch294NameNumber_freshVar_5= tomMatch294NameNumber_freshVar_6.getString() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch294NameNumber_freshVar_8=tomMatch294NameNumber_freshVar_3;if ( (tomMatch294NameNumber_freshVar_8 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch294NameNumber_freshVar_7= tomMatch294NameNumber_freshVar_8.getAstName() ;

        Term term = termFromTomName(tomMatch294NameNumber_freshVar_7);
        return  tom.engine.adt.il.types.term.slot.make( tom.engine.adt.il.types.symbol.fsymbol.make(tomMatch294NameNumber_freshVar_5) , term, tomMatch294NameNumber_freshVar_2) ;
      }}}}}}}}}}}}}}{ Object tomMatch294NameNumber_freshVar_9=expression;if ( (tomMatch294NameNumber_freshVar_9 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch294NameNumber_freshVar_9);{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshVar_11=tomMatch294NameNumber_freshSubject_1;if ( (tomMatch294NameNumber_freshVar_11 instanceof tom.engine.adt.tomexpression.types.expression.TomTermToExpression) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch294NameNumber_freshVar_10= tomMatch294NameNumber_freshVar_11.getAstTerm() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch294NameNumber_freshVar_13=tomMatch294NameNumber_freshVar_10;if ( (tomMatch294NameNumber_freshVar_13 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch294NameNumber_freshVar_12= tomMatch294NameNumber_freshVar_13.getAstName() ;

        Term term = termFromTomName(tomMatch294NameNumber_freshVar_12);
        return term;
      }}}}}}}}}{ Object tomMatch294NameNumber_freshVar_14=expression;if ( (tomMatch294NameNumber_freshVar_14 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch294NameNumber_freshVar_14);{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshVar_16=tomMatch294NameNumber_freshSubject_1;if ( (tomMatch294NameNumber_freshVar_16 instanceof tom.engine.adt.tomexpression.types.expression.Cast) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch294NameNumber_freshVar_15= tomMatch294NameNumber_freshVar_16.getSource() ;

        return termFromExpresssion(tomMatch294NameNumber_freshVar_15);
      }}}}}}}

    System.out.println("termFromExpresssion don't know how to handle this: " + expression);
    return  tom.engine.adt.il.types.term.repr.make("autre foirade avec " + expression) ;
  }

  public Expr exprFromExpression(Expression expression) {
    {{ Object tomMatch295NameNumber_freshVar_0=expression;if ( (tomMatch295NameNumber_freshVar_0 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch295NameNumber_freshVar_0);{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshVar_1=tomMatch295NameNumber_freshSubject_1;if ( (tomMatch295NameNumber_freshVar_1 instanceof tom.engine.adt.tomexpression.types.expression.TrueTL) ) {
 return  tom.engine.adt.il.types.expr.iltrue.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ) ; }}}}}{ Object tomMatch295NameNumber_freshVar_2=expression;if ( (tomMatch295NameNumber_freshVar_2 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch295NameNumber_freshVar_2);{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshVar_3=tomMatch295NameNumber_freshSubject_1;if ( (tomMatch295NameNumber_freshVar_3 instanceof tom.engine.adt.tomexpression.types.expression.FalseTL) ) {
 return  tom.engine.adt.il.types.expr.ilfalse.make() ; }}}}}{ Object tomMatch295NameNumber_freshVar_4=expression;if ( (tomMatch295NameNumber_freshVar_4 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch295NameNumber_freshVar_4);{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshVar_7=tomMatch295NameNumber_freshSubject_1;if ( (tomMatch295NameNumber_freshVar_7 instanceof tom.engine.adt.tomexpression.types.expression.IsFsym) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch295NameNumber_freshVar_5= tomMatch295NameNumber_freshVar_7.getAstName() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch295NameNumber_freshVar_6= tomMatch295NameNumber_freshVar_7.getVariable() ;{  tom.engine.adt.tomname.types.TomName  tomMatch295NameNumber_freshVar_9=tomMatch295NameNumber_freshVar_5;if ( (tomMatch295NameNumber_freshVar_9 instanceof tom.engine.adt.tomname.types.tomname.Name) ) {{  String  tomMatch295NameNumber_freshVar_8= tomMatch295NameNumber_freshVar_9.getString() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch295NameNumber_freshVar_11=tomMatch295NameNumber_freshVar_6;if ( (tomMatch295NameNumber_freshVar_11 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch295NameNumber_freshVar_10= tomMatch295NameNumber_freshVar_11.getAstName() ;

        Term term = termFromTomName(tomMatch295NameNumber_freshVar_10);
        return  tom.engine.adt.il.types.expr.isfsym.make(term,  tom.engine.adt.il.types.symbol.fsymbol.make(tomMatch295NameNumber_freshVar_8) ) ;
      }}}}}}}}}}}}}{ Object tomMatch295NameNumber_freshVar_12=expression;if ( (tomMatch295NameNumber_freshVar_12 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch295NameNumber_freshVar_12);{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshVar_15=tomMatch295NameNumber_freshSubject_1;if ( (tomMatch295NameNumber_freshVar_15 instanceof tom.engine.adt.tomexpression.types.expression.EqualTerm) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch295NameNumber_freshVar_13= tomMatch295NameNumber_freshVar_15.getKid1() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch295NameNumber_freshVar_14= tomMatch295NameNumber_freshVar_15.getKid2() ;

        return  tom.engine.adt.il.types.expr.eq.make(termFromTomTerm(tomMatch295NameNumber_freshVar_13), termFromTomTerm(tomMatch295NameNumber_freshVar_14)) ;
      }}}}}}}{ Object tomMatch295NameNumber_freshVar_16=expression;if ( (tomMatch295NameNumber_freshVar_16 instanceof tom.engine.adt.tomexpression.types.Expression) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tomMatch295NameNumber_freshVar_16);{  tom.engine.adt.tomexpression.types.Expression  tomMatch295NameNumber_freshVar_17=tomMatch295NameNumber_freshSubject_1;if ( (tomMatch295NameNumber_freshVar_17 instanceof tom.engine.adt.tomexpression.types.expression.IsSort) ) {
 return  tom.engine.adt.il.types.expr.iltrue.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ) ; }}}}}}

    System.out.println("exprFromExpression don't know how to handle this: " + expression);
    return  tom.engine.adt.il.types.expr.ilfalse.make() ;
  }

  public Instr instrFromInstructionList(InstructionList instrlist) {
    InstrList list =  tom.engine.adt.il.types.instrlist.Emptysemicolon.make() ;
    while (!instrlist.isEmptyconcInstruction()) {
      Instruction i = (Instruction) instrlist.getHeadconcInstruction();
      instrlist = instrlist.getTailconcInstruction();
      list = tom_append_list_semicolon(list, tom.engine.adt.il.types.instrlist.Conssemicolon.make(instrFromInstruction(i), tom.engine.adt.il.types.instrlist.Emptysemicolon.make() ) );
    }
    return  tom.engine.adt.il.types.instr.sequence.make(list) ;
  }

  public Instr instrFromInstruction(Instruction automata) {
    {{ Object tomMatch296NameNumber_freshVar_0=automata;if ( (tomMatch296NameNumber_freshVar_0 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_0);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_3=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_3 instanceof tom.engine.adt.tominstruction.types.instruction.TypedAction) ) {{  tom.engine.adt.tomconstraint.types.Constraint  tomMatch296NameNumber_freshVar_1= tomMatch296NameNumber_freshVar_3.getPositivePattern() ;{  tom.engine.adt.tomconstraint.types.ConstraintList  tomMatch296NameNumber_freshVar_2= tomMatch296NameNumber_freshVar_3.getNegativePatternList() ;

        return  tom.engine.adt.il.types.instr.accept.make(tomMatch296NameNumber_freshVar_1.toATerm(), tomMatch296NameNumber_freshVar_2.toATerm()) ;
      }}}}}}}{ Object tomMatch296NameNumber_freshVar_4=automata;if ( (tomMatch296NameNumber_freshVar_4 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_4);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_8=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_8 instanceof tom.engine.adt.tominstruction.types.instruction.If) ) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch296NameNumber_freshVar_5= tomMatch296NameNumber_freshVar_8.getCondition() ;{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_6= tomMatch296NameNumber_freshVar_8.getSuccesInst() ;{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_7= tomMatch296NameNumber_freshVar_8.getFailureInst() ;


        return  tom.engine.adt.il.types.instr.ITE.make(exprFromExpression(tomMatch296NameNumber_freshVar_5), instrFromInstruction(tomMatch296NameNumber_freshVar_6), instrFromInstruction(tomMatch296NameNumber_freshVar_7)) 

;
      }}}}}}}}{ Object tomMatch296NameNumber_freshVar_9=automata;if ( (tomMatch296NameNumber_freshVar_9 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_9);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_13=tomMatch296NameNumber_freshSubject_1;{ boolean tomMatch296NameNumber_freshVar_16= false ;{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_12= null ;{  tom.engine.adt.tomexpression.types.Expression  tomMatch296NameNumber_freshVar_11= null ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_10= null ;if ( (tomMatch296NameNumber_freshVar_13 instanceof tom.engine.adt.tominstruction.types.instruction.Let) ) {{tomMatch296NameNumber_freshVar_16= true ;tomMatch296NameNumber_freshVar_10= tomMatch296NameNumber_freshVar_13.getVariable() ;tomMatch296NameNumber_freshVar_11= tomMatch296NameNumber_freshVar_13.getSource() ;tomMatch296NameNumber_freshVar_12= tomMatch296NameNumber_freshVar_13.getAstInstruction() ;}} else {if ( (tomMatch296NameNumber_freshVar_13 instanceof tom.engine.adt.tominstruction.types.instruction.LetRef) ) {{tomMatch296NameNumber_freshVar_16= true ;tomMatch296NameNumber_freshVar_10= tomMatch296NameNumber_freshVar_13.getVariable() ;tomMatch296NameNumber_freshVar_11= tomMatch296NameNumber_freshVar_13.getSource() ;tomMatch296NameNumber_freshVar_12= tomMatch296NameNumber_freshVar_13.getAstInstruction() ;}}}if ( tomMatch296NameNumber_freshVar_16== true  ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_15=tomMatch296NameNumber_freshVar_10;if ( (tomMatch296NameNumber_freshVar_15 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch296NameNumber_freshVar_14= tomMatch296NameNumber_freshVar_15.getAstName() ;

        Variable thevar = variableFromTomName(tomMatch296NameNumber_freshVar_14);
        return  tom.engine.adt.il.types.instr.ILLet.make(thevar, termFromExpresssion(tomMatch296NameNumber_freshVar_11), instrFromInstruction(tomMatch296NameNumber_freshVar_12)) 

;
      }}}}}}}}}}}}{ Object tomMatch296NameNumber_freshVar_17=automata;if ( (tomMatch296NameNumber_freshVar_17 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_17);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_20=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_20 instanceof tom.engine.adt.tominstruction.types.instruction.Assign) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_18= tomMatch296NameNumber_freshVar_20.getVariable() ;{  tom.engine.adt.tomexpression.types.Expression  tomMatch296NameNumber_freshVar_19= tomMatch296NameNumber_freshVar_20.getSource() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_22=tomMatch296NameNumber_freshVar_18;if ( (tomMatch296NameNumber_freshVar_22 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch296NameNumber_freshVar_21= tomMatch296NameNumber_freshVar_22.getAstName() ;

        Variable thevar = variableFromTomName(tomMatch296NameNumber_freshVar_21);
        return  tom.engine.adt.il.types.instr.ILLet.make(thevar, termFromExpresssion(tomMatch296NameNumber_freshVar_19),  tom.engine.adt.il.types.instr.refuse.make() ) 

; /* check that refuse is correct here */
      }}}}}}}}}}{ Object tomMatch296NameNumber_freshVar_23=automata;if ( (tomMatch296NameNumber_freshVar_23 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_23);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_27=tomMatch296NameNumber_freshSubject_1;{ boolean tomMatch296NameNumber_freshVar_29= false ;{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_26= null ;{  tom.engine.adt.tomexpression.types.Expression  tomMatch296NameNumber_freshVar_25= null ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_24= null ;if ( (tomMatch296NameNumber_freshVar_27 instanceof tom.engine.adt.tominstruction.types.instruction.Let) ) {{tomMatch296NameNumber_freshVar_29= true ;tomMatch296NameNumber_freshVar_24= tomMatch296NameNumber_freshVar_27.getVariable() ;tomMatch296NameNumber_freshVar_25= tomMatch296NameNumber_freshVar_27.getSource() ;tomMatch296NameNumber_freshVar_26= tomMatch296NameNumber_freshVar_27.getAstInstruction() ;}} else {if ( (tomMatch296NameNumber_freshVar_27 instanceof tom.engine.adt.tominstruction.types.instruction.LetRef) ) {{tomMatch296NameNumber_freshVar_29= true ;tomMatch296NameNumber_freshVar_24= tomMatch296NameNumber_freshVar_27.getVariable() ;tomMatch296NameNumber_freshVar_25= tomMatch296NameNumber_freshVar_27.getSource() ;tomMatch296NameNumber_freshVar_26= tomMatch296NameNumber_freshVar_27.getAstInstruction() ;}}}if ( tomMatch296NameNumber_freshVar_29== true  ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_28=tomMatch296NameNumber_freshVar_24;if ( (tomMatch296NameNumber_freshVar_28 instanceof tom.engine.adt.tomterm.types.tomterm.UnamedVariable) ) {

        return instrFromInstruction(tomMatch296NameNumber_freshVar_26);
      }}}}}}}}}}}{ Object tomMatch296NameNumber_freshVar_30=automata;if ( (tomMatch296NameNumber_freshVar_30 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_30);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_33=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_33 instanceof tom.engine.adt.tominstruction.types.instruction.Assign) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_31= tomMatch296NameNumber_freshVar_33.getVariable() ;{  tom.engine.adt.tomexpression.types.Expression  tomMatch296NameNumber_freshVar_32= tomMatch296NameNumber_freshVar_33.getSource() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch296NameNumber_freshVar_34=tomMatch296NameNumber_freshVar_31;if ( (tomMatch296NameNumber_freshVar_34 instanceof tom.engine.adt.tomterm.types.tomterm.UnamedVariable) ) {

        return  tom.engine.adt.il.types.instr.refuse.make() ; /* check that refuse is correct here */
      }}}}}}}}}{ Object tomMatch296NameNumber_freshVar_35=automata;if ( (tomMatch296NameNumber_freshVar_35 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_35);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_37=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_37 instanceof tom.engine.adt.tominstruction.types.instruction.CompiledPattern) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_36= tomMatch296NameNumber_freshVar_37.getAutomataInst() ;

        return instrFromInstruction(tomMatch296NameNumber_freshVar_36);
      }}}}}}{ Object tomMatch296NameNumber_freshVar_38=automata;if ( (tomMatch296NameNumber_freshVar_38 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_38);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_40=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_40 instanceof tom.engine.adt.tominstruction.types.instruction.AbstractBlock) ) {{  tom.engine.adt.tominstruction.types.InstructionList  tomMatch296NameNumber_freshVar_39= tomMatch296NameNumber_freshVar_40.getInstList() ;{  tom.engine.adt.tominstruction.types.InstructionList  tomMatch296NameNumber_freshVar_41=tomMatch296NameNumber_freshVar_39;if ( ((tomMatch296NameNumber_freshVar_41 instanceof tom.engine.adt.tominstruction.types.instructionlist.ConsconcInstruction) || (tomMatch296NameNumber_freshVar_41 instanceof tom.engine.adt.tominstruction.types.instructionlist.EmptyconcInstruction)) ) {if (!( tomMatch296NameNumber_freshVar_41.isEmptyconcInstruction() )) {{  tom.engine.adt.tominstruction.types.InstructionList  tomMatch296NameNumber_freshVar_42= tomMatch296NameNumber_freshVar_41.getTailconcInstruction() ;if ( tomMatch296NameNumber_freshVar_42.isEmptyconcInstruction() ) {

        return instrFromInstruction( tomMatch296NameNumber_freshVar_41.getHeadconcInstruction() );
      }}}}}}}}}}}{ Object tomMatch296NameNumber_freshVar_43=automata;if ( (tomMatch296NameNumber_freshVar_43 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_43);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_45=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_45 instanceof tom.engine.adt.tominstruction.types.instruction.AbstractBlock) ) {{  tom.engine.adt.tominstruction.types.InstructionList  tomMatch296NameNumber_freshVar_44= tomMatch296NameNumber_freshVar_45.getInstList() ;{  tom.engine.adt.tominstruction.types.InstructionList  tomMatch296NameNumber_freshVar_46=tomMatch296NameNumber_freshVar_44;if ( ((tomMatch296NameNumber_freshVar_46 instanceof tom.engine.adt.tominstruction.types.instructionlist.ConsconcInstruction) || (tomMatch296NameNumber_freshVar_46 instanceof tom.engine.adt.tominstruction.types.instructionlist.EmptyconcInstruction)) ) {

        return instrFromInstructionList(tomMatch296NameNumber_freshVar_46);
      }}}}}}}}{ Object tomMatch296NameNumber_freshVar_48=automata;if ( (tomMatch296NameNumber_freshVar_48 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch296NameNumber_freshVar_48);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch296NameNumber_freshVar_49=tomMatch296NameNumber_freshSubject_1;if ( (tomMatch296NameNumber_freshVar_49 instanceof tom.engine.adt.tominstruction.types.instruction.Nop) ) {

        // tom uses nop in the iffalse part of ITE
        return  tom.engine.adt.il.types.instr.refuse.make() ;
      }}}}}}

    System.out.println("instrFromInstruction don't know how to handle this : " + automata);
    return  tom.engine.adt.il.types.instr.refuse.make() ;
  }

  private SubstitutionList abstractSubstitutionFromAccept(Instr instr) {
    SubstitutionList substitution =  tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ;
    {{ Object tomMatch297NameNumber_freshVar_0=instr;if ( (tomMatch297NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch297NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch297NameNumber_freshVar_0);{  tom.engine.adt.il.types.Instr  tomMatch297NameNumber_freshVar_3=tomMatch297NameNumber_freshSubject_1;if ( (tomMatch297NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.instr.accept) ) {{  aterm.ATerm  tomMatch297NameNumber_freshVar_1= tomMatch297NameNumber_freshVar_3.getPositive() ;{  aterm.ATerm  tomMatch297NameNumber_freshVar_2= tomMatch297NameNumber_freshVar_3.getNegative() ;

        Constraint positivePattern = Constraint.fromTerm(tomMatch297NameNumber_freshVar_1);
        ArrayList<TomTerm> subjectList = new ArrayList<TomTerm>();
        try{
          tom_make_TopDown(tom_make_CollectSubjects(subjectList)).visitLight(positivePattern);
        }catch(VisitFailure e){
          throw new TomRuntimeException("VisitFailure in Verifier.abstractSubstitutionFromAccept:" + e.getMessage()); 
        }
        for(TomTerm subject: subjectList){
          {{ Object tomMatch298NameNumber_freshVar_0=subject;if ( (tomMatch298NameNumber_freshVar_0 instanceof tom.engine.adt.tomterm.types.TomTerm) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch298NameNumber_freshSubject_1=(( tom.engine.adt.tomterm.types.TomTerm )tomMatch298NameNumber_freshVar_0);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch298NameNumber_freshVar_2=tomMatch298NameNumber_freshSubject_1;if ( (tomMatch298NameNumber_freshVar_2 instanceof tom.engine.adt.tomterm.types.tomterm.Variable) ) {{  tom.engine.adt.tomname.types.TomName  tomMatch298NameNumber_freshVar_1= tomMatch298NameNumber_freshVar_2.getAstName() ;

              substitution = tom_append_list_subs(substitution, tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.is.make(variableFromTomName(tomMatch298NameNumber_freshVar_1), termFromTomTerm(subject)) , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) )


;
            }}}}}}}
          
        }
      }}}}}}}}

    return substitution;
  }

  public static class CollectSubjects extends tom.library.sl.BasicStrategy {private  java.util.List  list;public CollectSubjects( java.util.List  list) {super(( new tom.library.sl.Identity() ));this.list=list;}public  java.util.List  getlist() {return list;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.tomconstraint.types.Constraint  visit_Constraint( tom.engine.adt.tomconstraint.types.Constraint  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch299NameNumber_freshVar_0=tom__arg;if ( (tomMatch299NameNumber_freshVar_0 instanceof tom.engine.adt.tomconstraint.types.Constraint) ) {{  tom.engine.adt.tomconstraint.types.Constraint  tomMatch299NameNumber_freshSubject_1=(( tom.engine.adt.tomconstraint.types.Constraint )tomMatch299NameNumber_freshVar_0);{  tom.engine.adt.tomconstraint.types.Constraint  tomMatch299NameNumber_freshVar_3=tomMatch299NameNumber_freshSubject_1;if ( (tomMatch299NameNumber_freshVar_3 instanceof tom.engine.adt.tomconstraint.types.constraint.MatchConstraint) ) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch299NameNumber_freshVar_1= tomMatch299NameNumber_freshVar_3.getPattern() ;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch299NameNumber_freshVar_2= tomMatch299NameNumber_freshVar_3.getSubject() ;


        list.add(tomMatch299NameNumber_freshVar_2);
      }}}}}}}}return _visit_Constraint(tom__arg,introspector); }public  tom.engine.adt.tomconstraint.types.Constraint  _visit_Constraint( tom.engine.adt.tomconstraint.types.Constraint  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.tomconstraint.types.Constraint )any.visit(environment,introspector));} else {return (( tom.engine.adt.tomconstraint.types.Constraint )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.tomconstraint.types.Constraint) ) {return visit_Constraint((( tom.engine.adt.tomconstraint.types.Constraint )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_CollectSubjects( java.util.List  t0) { return new CollectSubjects(t0);}



  public Collection build_tree(Instruction automata) {
    // System.out.println("Build derivation tree for: " + automata);

    // collects the accept in the automata
    Collection localAccepts = collectAccept(automata);

    Iterator iter = localAccepts.iterator();
    Collection treeList = new HashSet();
    while(iter.hasNext()) {
      Instr localAccept = (Instr) iter.next();

      // builds the initial abstract substitution
      SubstitutionList initialsubstitution = abstractSubstitutionFromAccept(localAccept);
      Environment startingenv =  tom.engine.adt.il.types.environment.env.make(initialsubstitution, instrFromInstruction(automata)) 
;

      Deriv startingderiv =  tom.engine.adt.il.types.deriv.ebs.make(startingenv,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , localAccept) ) 
;

      Collection treeListPre = applySemanticsRules(startingderiv);
      // replace substitutions in trees
      Iterator it = treeListPre.iterator();
      while(it.hasNext()) {
        DerivTree tree = (DerivTree) it.next();
        SubstitutionList outputsubst = getOutputSubstitution(tree);
        tree = replaceUndefinedSubstitution(tree,outputsubst);
        treeList.add(tree);
      }
    }

    return treeList;
  }

  public Map getConstraints(Instruction automata) {
    // collects the accept in the automata
    Collection localAccepts = collectAccept(automata);

    Iterator iter = localAccepts.iterator();
    Map constraintList = new HashMap();
    while(iter.hasNext()) {
      Instr localAccept = (Instr) iter.next();

      // builds the initial abstract substitution
      SubstitutionList initialsubstitution = abstractSubstitutionFromAccept(localAccept);
      Expr constraints = buildConstraint(initialsubstitution,
          instrFromInstruction(automata),
          localAccept);
      constraintList.put(localAccept,constraints);
    }
    return constraintList;
  }

  public static class substitutionCollector extends tom.library.sl.BasicStrategy {private  SubstRef  outsubst;public substitutionCollector( SubstRef  outsubst) {super(( new tom.library.sl.Identity() ));this.outsubst=outsubst;}public  SubstRef  getoutsubst() {return outsubst;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.il.types.Expr  visit_Expr( tom.engine.adt.il.types.Expr  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch300NameNumber_freshVar_0=tom__arg;if ( (tomMatch300NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch300NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch300NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch300NameNumber_freshVar_2=tomMatch300NameNumber_freshSubject_1;if ( (tomMatch300NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.expr.iltrue) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch300NameNumber_freshVar_1= tomMatch300NameNumber_freshVar_2.getSubst() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch300NameNumber_freshVar_3=tomMatch300NameNumber_freshVar_1;if ( ((tomMatch300NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch300NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch300NameNumber_freshVar_3.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch300NameNumber_freshVar_5= tomMatch300NameNumber_freshVar_3.getHeadsubs() ;if ( (tomMatch300NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch300NameNumber_freshVar_4= tomMatch300NameNumber_freshVar_3.getTailsubs() ;if ( tomMatch300NameNumber_freshVar_4.isEmptysubs() ) {( new tom.library.sl.Fail() )


.visitLight(tomMatch300NameNumber_freshSubject_1);
      }}}}}}}}}}}}}{ Object tomMatch300NameNumber_freshVar_6=tom__arg;if ( (tomMatch300NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch300NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch300NameNumber_freshVar_6);{  tom.engine.adt.il.types.Expr  tomMatch300NameNumber_freshVar_8=tomMatch300NameNumber_freshSubject_1;if ( (tomMatch300NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.expr.iltrue) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch300NameNumber_freshVar_7= tomMatch300NameNumber_freshVar_8.getSubst() ;

        outsubst.set(tomMatch300NameNumber_freshVar_7);
      }}}}}}}return _visit_Expr(tom__arg,introspector); }public  tom.engine.adt.il.types.Expr  _visit_Expr( tom.engine.adt.il.types.Expr  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.il.types.Expr )any.visit(environment,introspector));} else {return (( tom.engine.adt.il.types.Expr )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.il.types.Expr) ) {return visit_Expr((( tom.engine.adt.il.types.Expr )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_substitutionCollector( SubstRef  t0) { return new substitutionCollector(t0);}


  public SubstitutionList collectSubstitutionInConstraint(Expr expr) {
    SubstRef output = new SubstRef( tom.engine.adt.il.types.substitutionlist.Emptysubs.make() );
    try {
      ( new tom.library.sl.Mu(( new tom.library.sl.MuVar("x") ),tom_make_Try(( (( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ),( null )) )==null)?tom_make_substitutionCollector(output):new tom.library.sl.Sequence(tom_make_substitutionCollector(output),( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ),( null )) )) ))) ).visitLight(expr);
    } catch (tom.library.sl.VisitFailure e) {
      throw new TomRuntimeException("Strategy substitutionCollector failed");
    }
    return output.get();
  }

  public static class outputSubstitutionCollector extends tom.library.sl.BasicStrategy {private  SubstRef  outsubst;public outputSubstitutionCollector( SubstRef  outsubst) {super(( new tom.library.sl.Identity() ));this.outsubst=outsubst;}public  SubstRef  getoutsubst() {return outsubst;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.il.types.Deriv  visit_Deriv( tom.engine.adt.il.types.Deriv  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch301NameNumber_freshVar_0=tom__arg;if ( (tomMatch301NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch301NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch301NameNumber_freshVar_0);{  tom.engine.adt.il.types.Deriv  tomMatch301NameNumber_freshVar_3=tomMatch301NameNumber_freshSubject_1;if ( (tomMatch301NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch301NameNumber_freshVar_1= tomMatch301NameNumber_freshVar_3.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch301NameNumber_freshVar_2= tomMatch301NameNumber_freshVar_3.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch301NameNumber_freshVar_6=tomMatch301NameNumber_freshVar_1;if ( (tomMatch301NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch301NameNumber_freshVar_4= tomMatch301NameNumber_freshVar_6.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch301NameNumber_freshVar_5= tomMatch301NameNumber_freshVar_6.getI() ;{  tom.engine.adt.il.types.Instr  tomMatch301NameNumber_freshVar_7=tomMatch301NameNumber_freshVar_5;if ( (tomMatch301NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.instr.accept) ) {{  tom.engine.adt.il.types.Environment  tomMatch301NameNumber_freshVar_10=tomMatch301NameNumber_freshVar_2;if ( (tomMatch301NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch301NameNumber_freshVar_8= tomMatch301NameNumber_freshVar_10.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch301NameNumber_freshVar_9= tomMatch301NameNumber_freshVar_10.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch301NameNumber_freshVar_12=tomMatch301NameNumber_freshVar_8;if ( ((tomMatch301NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch301NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch301NameNumber_freshVar_12.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch301NameNumber_freshVar_14= tomMatch301NameNumber_freshVar_12.getHeadsubs() ;if ( (tomMatch301NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch301NameNumber_freshVar_13= tomMatch301NameNumber_freshVar_12.getTailsubs() ;if ( tomMatch301NameNumber_freshVar_13.isEmptysubs() ) {{  tom.engine.adt.il.types.Instr  tomMatch301NameNumber_freshVar_11=tomMatch301NameNumber_freshVar_9;if ( (tomMatch301NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.instr.accept) ) {


        outsubst.set(tomMatch301NameNumber_freshVar_4);
      }}}}}}}}}}}}}}}}}}}}}}}}}}}return _visit_Deriv(tom__arg,introspector); }public  tom.engine.adt.il.types.Deriv  _visit_Deriv( tom.engine.adt.il.types.Deriv  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.il.types.Deriv )any.visit(environment,introspector));} else {return (( tom.engine.adt.il.types.Deriv )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.il.types.Deriv) ) {return visit_Deriv((( tom.engine.adt.il.types.Deriv )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_outputSubstitutionCollector( SubstRef  t0) { return new outputSubstitutionCollector(t0);}



  public SubstitutionList getOutputSubstitution(DerivTree subject) {
    SubstRef output = new SubstRef( tom.engine.adt.il.types.substitutionlist.Emptysubs.make() );
    try {
      tom_make_TopDown(tom_make_outputSubstitutionCollector(output)).visitLight(subject);
    } catch (tom.library.sl.VisitFailure e) {
      throw new TomRuntimeException("Strategy outputSubstitutionCollector failed");
    }
    return output.get();
  }

  public static class acceptCollector extends tom.library.sl.BasicStrategy {private  java.util.Collection  store;public acceptCollector( java.util.Collection  store) {super(( new tom.library.sl.Identity() ));this.store=store;}public  java.util.Collection  getstore() {return store;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.tominstruction.types.Instruction  visit_Instruction( tom.engine.adt.tominstruction.types.Instruction  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch302NameNumber_freshVar_0=tom__arg;if ( (tomMatch302NameNumber_freshVar_0 instanceof tom.engine.adt.tominstruction.types.Instruction) ) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch302NameNumber_freshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tomMatch302NameNumber_freshVar_0);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch302NameNumber_freshVar_3=tomMatch302NameNumber_freshSubject_1;if ( (tomMatch302NameNumber_freshVar_3 instanceof tom.engine.adt.tominstruction.types.instruction.TypedAction) ) {{  tom.engine.adt.tomconstraint.types.Constraint  tomMatch302NameNumber_freshVar_1= tomMatch302NameNumber_freshVar_3.getPositivePattern() ;{  tom.engine.adt.tomconstraint.types.ConstraintList  tomMatch302NameNumber_freshVar_2= tomMatch302NameNumber_freshVar_3.getNegativePatternList() ;


        store.add( tom.engine.adt.il.types.instr.accept.make(tomMatch302NameNumber_freshVar_1.toATerm(), tomMatch302NameNumber_freshVar_2.toATerm()) );
      }}}}}}}}return _visit_Instruction(tom__arg,introspector); }public  tom.engine.adt.tominstruction.types.Instruction  _visit_Instruction( tom.engine.adt.tominstruction.types.Instruction  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.tominstruction.types.Instruction )any.visit(environment,introspector));} else {return (( tom.engine.adt.tominstruction.types.Instruction )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.tominstruction.types.Instruction) ) {return visit_Instruction((( tom.engine.adt.tominstruction.types.Instruction )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_acceptCollector( java.util.Collection  t0) { return new acceptCollector(t0);}



  public Collection collectAccept(Instruction subject) {
    Collection result = new HashSet();
    try {
      tom_make_TopDown(tom_make_acceptCollector(result)).visitLight(subject);
    } catch (tom.library.sl.VisitFailure e) {
      throw new TomRuntimeException("Strategy collectAccept failed");
    }
    return result;
  }


  /**
   * The axioms the mapping has to verify
   */
  protected Seq seqFromTerm(Term sp) {
    TermList ded =  tom.engine.adt.il.types.termlist.ConsconcTerm.make(sp, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ;
    {{ Object tomMatch303NameNumber_freshVar_0=sp;if ( (tomMatch303NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch303NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch303NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch303NameNumber_freshVar_1=tomMatch303NameNumber_freshSubject_1;if ( (tomMatch303NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.term.appSubsT) ) {

        TermList follow = applyMappingRules(replaceVariablesInTerm(sp));
        ded = tom_append_list_concTerm(ded,tom_append_list_concTerm(follow, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ));
      }}}}}}

    return  tom.engine.adt.il.types.seq.dedterm.make(tom_append_list_concTerm(ded, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() )) ;
  }

  protected ExprList exprListFromExpr(Expr sp) {
    ExprList ded =  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(sp, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ;
    {{ Object tomMatch304NameNumber_freshVar_0=sp;if ( (tomMatch304NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch304NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch304NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch304NameNumber_freshVar_1=tomMatch304NameNumber_freshSubject_1;if ( (tomMatch304NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.expr.appSubsE) ) {

        ExprList follow = applyExprRules(replaceVariablesInExpr(sp));
        ded = tom_append_list_concExpr(ded,tom_append_list_concExpr(follow, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ));
      }}}}}}


    // System.out.println("dedexpr gives: " + ded);
    return ded;
  }

  protected SubstitutionList reduceSubstitutionWithMappingRules(SubstitutionList subst) {
    {{ Object tomMatch305NameNumber_freshVar_0=subst;if ( (tomMatch305NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch305NameNumber_freshVar_0);{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshVar_1=tomMatch305NameNumber_freshSubject_1;if ( ((tomMatch305NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch305NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if ( tomMatch305NameNumber_freshVar_1.isEmptysubs() ) {

        return subst;
      }}}}}}{ Object tomMatch305NameNumber_freshVar_2=subst;if ( (tomMatch305NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch305NameNumber_freshVar_2);{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshVar_3=tomMatch305NameNumber_freshSubject_1;if ( ((tomMatch305NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch305NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch305NameNumber_freshVar_3.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch305NameNumber_freshVar_8= tomMatch305NameNumber_freshVar_3.getHeadsubs() ;if ( (tomMatch305NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.substitution.is) ) {{  tom.engine.adt.il.types.Variable  tomMatch305NameNumber_freshVar_6= tomMatch305NameNumber_freshVar_8.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch305NameNumber_freshVar_7= tomMatch305NameNumber_freshVar_8.getTerm() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshVar_4= tomMatch305NameNumber_freshVar_3.getTailsubs() ;

        SubstitutionList tail = reduceSubstitutionWithMappingRules(tomMatch305NameNumber_freshVar_4);
        return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.is.make(tomMatch305NameNumber_freshVar_6, reduceTermWithMappingRules(replaceVariablesInTerm( tom.engine.adt.il.types.term.appSubsT.make(tail, tomMatch305NameNumber_freshVar_7) ))) ,tom_append_list_subs(tail, tom.engine.adt.il.types.substitutionlist.Emptysubs.make() )) ;
      }}}}}}}}}}}{ Object tomMatch305NameNumber_freshVar_9=subst;if ( (tomMatch305NameNumber_freshVar_9 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch305NameNumber_freshVar_9);{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshVar_10=tomMatch305NameNumber_freshSubject_1;if ( ((tomMatch305NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch305NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch305NameNumber_freshVar_10.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch305NameNumber_freshVar_13= tomMatch305NameNumber_freshVar_10.getHeadsubs() ;if ( (tomMatch305NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch305NameNumber_freshVar_11= tomMatch305NameNumber_freshVar_10.getTailsubs() ;

        SubstitutionList tail = reduceSubstitutionWithMappingRules(tomMatch305NameNumber_freshVar_11);
        return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() ,tom_append_list_subs(tail, tom.engine.adt.il.types.substitutionlist.Emptysubs.make() )) ;
      }}}}}}}}}}

    return subst;
  }
  protected Expr reduceWithMappingRules(Expr ex) {
    {{ Object tomMatch306NameNumber_freshVar_0=ex;if ( (tomMatch306NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_3=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.expr.eq) ) {{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_1= tomMatch306NameNumber_freshVar_3.getLt() ;{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_2= tomMatch306NameNumber_freshVar_3.getRt() ;{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_5=tomMatch306NameNumber_freshVar_1;if ( (tomMatch306NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch306NameNumber_freshVar_4= tomMatch306NameNumber_freshVar_5.getAbst() ;{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_7=tomMatch306NameNumber_freshVar_2;if ( (tomMatch306NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch306NameNumber_freshVar_6= tomMatch306NameNumber_freshVar_7.getAbst() ;

        return  tom.engine.adt.il.types.expr.teq.make(tomMatch306NameNumber_freshVar_4, tomMatch306NameNumber_freshVar_6) ;
      }}}}}}}}}}}}}{ Object tomMatch306NameNumber_freshVar_8=ex;if ( (tomMatch306NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_8);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_11=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.expr.isfsym) ) {{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_9= tomMatch306NameNumber_freshVar_11.getT() ;{  tom.engine.adt.il.types.Symbol  tomMatch306NameNumber_freshVar_10= tomMatch306NameNumber_freshVar_11.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_13=tomMatch306NameNumber_freshVar_9;if ( (tomMatch306NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch306NameNumber_freshVar_12= tomMatch306NameNumber_freshVar_13.getAbst() ;

        return  tom.engine.adt.il.types.expr.tisfsym.make(tomMatch306NameNumber_freshVar_12, tomMatch306NameNumber_freshVar_10) ;
      }}}}}}}}}}{ Object tomMatch306NameNumber_freshVar_14=ex;if ( (tomMatch306NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_14);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_17=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_17 instanceof tom.engine.adt.il.types.expr.eq) ) {{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_15= tomMatch306NameNumber_freshVar_17.getLt() ;{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_16= tomMatch306NameNumber_freshVar_17.getRt() ;

        // first reduce the argument
        return reduceWithMappingRules( tom.engine.adt.il.types.expr.eq.make(reduceTermWithMappingRules(tomMatch306NameNumber_freshVar_15), reduceTermWithMappingRules(tomMatch306NameNumber_freshVar_16)) );
      }}}}}}}{ Object tomMatch306NameNumber_freshVar_18=ex;if ( (tomMatch306NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_18);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_21=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.expr.isfsym) ) {{  tom.engine.adt.il.types.Term  tomMatch306NameNumber_freshVar_19= tomMatch306NameNumber_freshVar_21.getT() ;{  tom.engine.adt.il.types.Symbol  tomMatch306NameNumber_freshVar_20= tomMatch306NameNumber_freshVar_21.getSymbol() ;

        return reduceWithMappingRules( tom.engine.adt.il.types.expr.isfsym.make(reduceTermWithMappingRules(tomMatch306NameNumber_freshVar_19), tomMatch306NameNumber_freshVar_20) );
      }}}}}}}{ Object tomMatch306NameNumber_freshVar_22=ex;if ( (tomMatch306NameNumber_freshVar_22 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_22);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_24=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_24 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_23= tomMatch306NameNumber_freshVar_24.getExp() ;

        return  tom.engine.adt.il.types.expr.ilnot.make(reduceWithMappingRules(tomMatch306NameNumber_freshVar_23)) ;
      }}}}}}{ Object tomMatch306NameNumber_freshVar_25=ex;if ( (tomMatch306NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_25);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_27=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_27 instanceof tom.engine.adt.il.types.expr.iltrue) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch306NameNumber_freshVar_26= tomMatch306NameNumber_freshVar_27.getSubst() ;

        return  tom.engine.adt.il.types.expr.iltrue.make(reduceSubstitutionWithMappingRules(tomMatch306NameNumber_freshVar_26)) ;
      }}}}}}{ Object tomMatch306NameNumber_freshVar_28=ex;if ( (tomMatch306NameNumber_freshVar_28 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_28);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_29=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_29 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

        return ex;
      }}}}}{ Object tomMatch306NameNumber_freshVar_30=ex;if ( (tomMatch306NameNumber_freshVar_30 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_30);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_33=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_33 instanceof tom.engine.adt.il.types.expr.iland) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_31= tomMatch306NameNumber_freshVar_33.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_32= tomMatch306NameNumber_freshVar_33.getRight() ;

        return  tom.engine.adt.il.types.expr.iland.make(reduceWithMappingRules(tomMatch306NameNumber_freshVar_31), reduceWithMappingRules(tomMatch306NameNumber_freshVar_32)) ;
      }}}}}}}{ Object tomMatch306NameNumber_freshVar_34=ex;if ( (tomMatch306NameNumber_freshVar_34 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch306NameNumber_freshVar_34);{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_37=tomMatch306NameNumber_freshSubject_1;if ( (tomMatch306NameNumber_freshVar_37 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_35= tomMatch306NameNumber_freshVar_37.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch306NameNumber_freshVar_36= tomMatch306NameNumber_freshVar_37.getRight() ;

        return  tom.engine.adt.il.types.expr.ilor.make(reduceWithMappingRules(tomMatch306NameNumber_freshVar_35), reduceWithMappingRules(tomMatch306NameNumber_freshVar_36)) ;
      }}}}}}}}

    System.out.println("reduceWithMappingRules : nothing applies to:" + ex);
    return ex;
  }

  protected Term reduceTermWithMappingRules(Term trm) {
    {{ Object tomMatch307NameNumber_freshVar_0=trm;if ( (tomMatch307NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch307NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_1=tomMatch307NameNumber_freshSubject_1;if ( (tomMatch307NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.term.tau) ) {

        return trm;
      }}}}}{ Object tomMatch307NameNumber_freshVar_2=trm;if ( (tomMatch307NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch307NameNumber_freshVar_2);{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_6=tomMatch307NameNumber_freshSubject_1;if ( (tomMatch307NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.term.subterm) ) {{  tom.engine.adt.il.types.Symbol  tomMatch307NameNumber_freshVar_3= tomMatch307NameNumber_freshVar_6.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_4= tomMatch307NameNumber_freshVar_6.getT() ;{  int  tomMatch307NameNumber_freshVar_5= tomMatch307NameNumber_freshVar_6.getIndex() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_7=tomMatch307NameNumber_freshVar_4;if ( (tomMatch307NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.term.subterm) ) {

        return reduceTermWithMappingRules( tom.engine.adt.il.types.term.subterm.make(tomMatch307NameNumber_freshVar_3, reduceTermWithMappingRules(tomMatch307NameNumber_freshVar_4), tomMatch307NameNumber_freshVar_5) );
      }}}}}}}}}}{ Object tomMatch307NameNumber_freshVar_8=trm;if ( (tomMatch307NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch307NameNumber_freshVar_8);{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_12=tomMatch307NameNumber_freshSubject_1;if ( (tomMatch307NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.term.slot) ) {{  tom.engine.adt.il.types.Symbol  tomMatch307NameNumber_freshVar_9= tomMatch307NameNumber_freshVar_12.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_10= tomMatch307NameNumber_freshVar_12.getT() ;{  String  tomMatch307NameNumber_freshVar_11= tomMatch307NameNumber_freshVar_12.getName() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_13=tomMatch307NameNumber_freshVar_10;if ( (tomMatch307NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.term.slot) ) {

        return reduceTermWithMappingRules( tom.engine.adt.il.types.term.slot.make(tomMatch307NameNumber_freshVar_9, reduceTermWithMappingRules(tomMatch307NameNumber_freshVar_10), tomMatch307NameNumber_freshVar_11) );
      }}}}}}}}}}{ Object tomMatch307NameNumber_freshVar_14=trm;if ( (tomMatch307NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch307NameNumber_freshVar_14);{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_18=tomMatch307NameNumber_freshSubject_1;if ( (tomMatch307NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.term.subterm) ) {{  tom.engine.adt.il.types.Symbol  tomMatch307NameNumber_freshVar_15= tomMatch307NameNumber_freshVar_18.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_16= tomMatch307NameNumber_freshVar_18.getT() ;{  int  tomMatch307NameNumber_freshVar_17= tomMatch307NameNumber_freshVar_18.getIndex() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_20=tomMatch307NameNumber_freshVar_16;if ( (tomMatch307NameNumber_freshVar_20 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch307NameNumber_freshVar_19= tomMatch307NameNumber_freshVar_20.getAbst() ;

        // we shall test if term t has symbol s
        AbsTerm term =  tom.engine.adt.il.types.absterm.st.make(tomMatch307NameNumber_freshVar_15, tomMatch307NameNumber_freshVar_19, tomMatch307NameNumber_freshVar_17) ;
        return  tom.engine.adt.il.types.term.tau.make(term) ;
      }}}}}}}}}}}{ Object tomMatch307NameNumber_freshVar_21=trm;if ( (tomMatch307NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch307NameNumber_freshVar_21);{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_25=tomMatch307NameNumber_freshSubject_1;if ( (tomMatch307NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.term.slot) ) {{  tom.engine.adt.il.types.Symbol  tomMatch307NameNumber_freshVar_22= tomMatch307NameNumber_freshVar_25.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_23= tomMatch307NameNumber_freshVar_25.getT() ;{  String  tomMatch307NameNumber_freshVar_24= tomMatch307NameNumber_freshVar_25.getName() ;{  tom.engine.adt.il.types.Term  tomMatch307NameNumber_freshVar_27=tomMatch307NameNumber_freshVar_23;if ( (tomMatch307NameNumber_freshVar_27 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch307NameNumber_freshVar_26= tomMatch307NameNumber_freshVar_27.getAbst() ;

        // we shall test if term t has symbol s
        AbsTerm term =  tom.engine.adt.il.types.absterm.sl.make(tomMatch307NameNumber_freshVar_22, tomMatch307NameNumber_freshVar_26, tomMatch307NameNumber_freshVar_24) ;
        return  tom.engine.adt.il.types.term.tau.make(term) ;
      }}}}}}}}}}}}

    System.out.println("reduceTermWithMappingRules : nothing applies to:" + trm);
    return trm;
  }

  protected TermList applyMappingRules(Term trm) {
    {{ Object tomMatch308NameNumber_freshVar_0=trm;if ( (tomMatch308NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch308NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_1=tomMatch308NameNumber_freshSubject_1;if ( (tomMatch308NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.term.tau) ) {

        return  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ;
      }}}}}{ Object tomMatch308NameNumber_freshVar_2=trm;if ( (tomMatch308NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch308NameNumber_freshVar_2);{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_6=tomMatch308NameNumber_freshSubject_1;if ( (tomMatch308NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.term.subterm) ) {{  tom.engine.adt.il.types.Symbol  tomMatch308NameNumber_freshVar_3= tomMatch308NameNumber_freshVar_6.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_4= tomMatch308NameNumber_freshVar_6.getT() ;{  int  tomMatch308NameNumber_freshVar_5= tomMatch308NameNumber_freshVar_6.getIndex() ;{  tom.engine.adt.il.types.Symbol  tom_s=tomMatch308NameNumber_freshVar_3;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_7=tomMatch308NameNumber_freshVar_4;if ( (tomMatch308NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.term.subterm) ) {{  int  tom_index=tomMatch308NameNumber_freshVar_5;

        // first reduce the argument
        TermList reduced = applyMappingRules(tomMatch308NameNumber_freshVar_4);
        TermList res =  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ;
        while(!reduced.isEmptyconcTerm()) {
          Term head = reduced.getHeadconcTerm();
          if (head.istau()) {
            TermList hl = applyMappingRules(head);
            while(!hl.isEmptyconcTerm()) {
              Term h = hl.getHeadconcTerm();
              res = tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.subterm.make(tom_s, h, tom_index) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) );
              hl = hl.getTailconcTerm();
            }
          } else {
            res = tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.subterm.make(tom_s, head, tom_index) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) );
          }
          reduced = reduced.getTailconcTerm();
        }
        return tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() );
      }}}}}}}}}}}}{ Object tomMatch308NameNumber_freshVar_8=trm;if ( (tomMatch308NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch308NameNumber_freshVar_8);{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_12=tomMatch308NameNumber_freshSubject_1;if ( (tomMatch308NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.term.slot) ) {{  tom.engine.adt.il.types.Symbol  tomMatch308NameNumber_freshVar_9= tomMatch308NameNumber_freshVar_12.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_10= tomMatch308NameNumber_freshVar_12.getT() ;{  String  tomMatch308NameNumber_freshVar_11= tomMatch308NameNumber_freshVar_12.getName() ;{  tom.engine.adt.il.types.Symbol  tom_s=tomMatch308NameNumber_freshVar_9;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_13=tomMatch308NameNumber_freshVar_10;if ( (tomMatch308NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.term.slot) ) {{  String  tom_slotName=tomMatch308NameNumber_freshVar_11;

        // first reduce the argument
        TermList reduced = applyMappingRules(tomMatch308NameNumber_freshVar_10);
        TermList res =  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ;
        while(!reduced.isEmptyconcTerm()) {
          Term head = reduced.getHeadconcTerm();
          if (head.istau()) {
            TermList hl = applyMappingRules(head);
            while(!hl.isEmptyconcTerm()) {
              Term h = hl.getHeadconcTerm();
              res = tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.slot.make(tom_s, h, tom_slotName) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) );
              hl = hl.getTailconcTerm();
            }
          } else {
            res = tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.slot.make(tom_s, head, tom_slotName) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) );
          }
          reduced = reduced.getTailconcTerm();
        }
        return tom_append_list_concTerm(res, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() );
      }}}}}}}}}}}}{ Object tomMatch308NameNumber_freshVar_14=trm;if ( (tomMatch308NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch308NameNumber_freshVar_14);{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_18=tomMatch308NameNumber_freshSubject_1;if ( (tomMatch308NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.term.subterm) ) {{  tom.engine.adt.il.types.Symbol  tomMatch308NameNumber_freshVar_15= tomMatch308NameNumber_freshVar_18.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_16= tomMatch308NameNumber_freshVar_18.getT() ;{  int  tomMatch308NameNumber_freshVar_17= tomMatch308NameNumber_freshVar_18.getIndex() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_20=tomMatch308NameNumber_freshVar_16;if ( (tomMatch308NameNumber_freshVar_20 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch308NameNumber_freshVar_19= tomMatch308NameNumber_freshVar_20.getAbst() ;

        // we shall test if term t has symbol s
        AbsTerm term =  tom.engine.adt.il.types.absterm.st.make(tomMatch308NameNumber_freshVar_15, tomMatch308NameNumber_freshVar_19, tomMatch308NameNumber_freshVar_17) ;
        return  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.tau.make(term) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ) ;
      }}}}}}}}}}}{ Object tomMatch308NameNumber_freshVar_21=trm;if ( (tomMatch308NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch308NameNumber_freshVar_21);{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_25=tomMatch308NameNumber_freshSubject_1;if ( (tomMatch308NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.term.slot) ) {{  tom.engine.adt.il.types.Symbol  tomMatch308NameNumber_freshVar_22= tomMatch308NameNumber_freshVar_25.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_23= tomMatch308NameNumber_freshVar_25.getT() ;{  String  tomMatch308NameNumber_freshVar_24= tomMatch308NameNumber_freshVar_25.getName() ;{  tom.engine.adt.il.types.Term  tomMatch308NameNumber_freshVar_27=tomMatch308NameNumber_freshVar_23;if ( (tomMatch308NameNumber_freshVar_27 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch308NameNumber_freshVar_26= tomMatch308NameNumber_freshVar_27.getAbst() ;

        // we shall test if term t has symbol s
        AbsTerm term =  tom.engine.adt.il.types.absterm.sl.make(tomMatch308NameNumber_freshVar_22, tomMatch308NameNumber_freshVar_26, tomMatch308NameNumber_freshVar_24) ;
        return  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.ConsconcTerm.make( tom.engine.adt.il.types.term.tau.make(term) , tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ) ;
      }}}}}}}}}}}}

    System.out.println("apply TermRules : nothing applies to:" + trm);
    return  tom.engine.adt.il.types.termlist.ConsconcTerm.make(trm, tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) ;
  }

  protected ExprList applyExprRules(Expr ex) {
    {{ Object tomMatch309NameNumber_freshVar_0=ex;if ( (tomMatch309NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_3=tomMatch309NameNumber_freshSubject_1;if ( (tomMatch309NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.expr.eq) ) {{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_1= tomMatch309NameNumber_freshVar_3.getLt() ;{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_2= tomMatch309NameNumber_freshVar_3.getRt() ;{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_5=tomMatch309NameNumber_freshVar_1;if ( (tomMatch309NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch309NameNumber_freshVar_4= tomMatch309NameNumber_freshVar_5.getAbst() ;{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_7=tomMatch309NameNumber_freshVar_2;if ( (tomMatch309NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch309NameNumber_freshVar_6= tomMatch309NameNumber_freshVar_7.getAbst() ;

        return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.teq.make(tomMatch309NameNumber_freshVar_4, tomMatch309NameNumber_freshVar_6) , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ) ;
      }}}}}}}}}}}}}{ Object tomMatch309NameNumber_freshVar_8=ex;if ( (tomMatch309NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_8);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_11=tomMatch309NameNumber_freshSubject_1;if ( (tomMatch309NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.expr.isfsym) ) {{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_9= tomMatch309NameNumber_freshVar_11.getT() ;{  tom.engine.adt.il.types.Symbol  tomMatch309NameNumber_freshVar_10= tomMatch309NameNumber_freshVar_11.getSymbol() ;{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_13=tomMatch309NameNumber_freshVar_9;if ( (tomMatch309NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch309NameNumber_freshVar_12= tomMatch309NameNumber_freshVar_13.getAbst() ;

        return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.tisfsym.make(tomMatch309NameNumber_freshVar_12, tomMatch309NameNumber_freshVar_10) , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ) ;
      }}}}}}}}}}{ Object tomMatch309NameNumber_freshVar_14=ex;if ( (tomMatch309NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_14);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_17=tomMatch309NameNumber_freshSubject_1;if ( (tomMatch309NameNumber_freshVar_17 instanceof tom.engine.adt.il.types.expr.eq) ) {{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_15= tomMatch309NameNumber_freshVar_17.getLt() ;{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_16= tomMatch309NameNumber_freshVar_17.getRt() ;

        // first reduce the argument
        Term reducedl = applyMappingRules(tomMatch309NameNumber_freshVar_15).reverse().getHeadconcTerm();
        Term reducedr = applyMappingRules(tomMatch309NameNumber_freshVar_16).reverse().getHeadconcTerm();

        ExprList taill = applyExprRules( tom.engine.adt.il.types.expr.eq.make(reducedl, reducedr) );
        ExprList res =  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex,tom_append_list_concExpr(taill, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() )) ;
      }}}}}}}{ Object tomMatch309NameNumber_freshVar_18=ex;if ( (tomMatch309NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_18);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_21=tomMatch309NameNumber_freshSubject_1;if ( (tomMatch309NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.expr.isfsym) ) {{  tom.engine.adt.il.types.Term  tomMatch309NameNumber_freshVar_19= tomMatch309NameNumber_freshVar_21.getT() ;{  tom.engine.adt.il.types.Symbol  tomMatch309NameNumber_freshVar_20= tomMatch309NameNumber_freshVar_21.getSymbol() ;

        // first reduce the argument
        TermList reduced = applyMappingRules(tomMatch309NameNumber_freshVar_19);
        ExprList res =  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ;
        while(!reduced.isEmptyconcTerm()) {
          Term head = reduced.getHeadconcTerm();
          res = tom_append_list_concExpr(res, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.isfsym.make(head, tomMatch309NameNumber_freshVar_20) , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) );
          reduced = reduced.getTailconcTerm();
        }
        {{ Object tomMatch310NameNumber_freshVar_0=res;if ( (tomMatch310NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.ExprList) ) {{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_freshSubject_1=(( tom.engine.adt.il.types.ExprList )tomMatch310NameNumber_freshVar_0);{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_freshVar_1=tomMatch310NameNumber_freshSubject_1;if ( ((tomMatch310NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.ConsconcExpr) || (tomMatch310NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.EmptyconcExpr)) ) {{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_begin_3=tomMatch310NameNumber_freshVar_1;{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_end_4=tomMatch310NameNumber_freshVar_1;do {{{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_freshVar_2=tomMatch310NameNumber_end_4;if (!( tomMatch310NameNumber_freshVar_2.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.ExprList  tomMatch310NameNumber_freshVar_5= tomMatch310NameNumber_freshVar_2.getTailconcExpr() ;if ( tomMatch310NameNumber_freshVar_5.isEmptyconcExpr() ) {

            ExprList taill = applyExprRules( tomMatch310NameNumber_freshVar_2.getHeadconcExpr() );
            return tom_append_list_concExpr(tom_get_slice_concExpr(tomMatch310NameNumber_begin_3,tomMatch310NameNumber_end_4, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ),tom_append_list_concExpr(taill, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ));
          }}}}if ( tomMatch310NameNumber_end_4.isEmptyconcExpr() ) {tomMatch310NameNumber_end_4=tomMatch310NameNumber_begin_3;} else {tomMatch310NameNumber_end_4= tomMatch310NameNumber_end_4.getTailconcExpr() ;}}} while(!( (tomMatch310NameNumber_end_4==tomMatch310NameNumber_begin_3) ));}}}}}}}}

      }}}}}}}{ Object tomMatch309NameNumber_freshVar_22=ex;if ( (tomMatch309NameNumber_freshVar_22 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_22);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_24=tomMatch309NameNumber_freshSubject_1;if ( (tomMatch309NameNumber_freshVar_24 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_23= tomMatch309NameNumber_freshVar_24.getExp() ;

        ExprList exprList = applyExprRules(tomMatch309NameNumber_freshVar_23);
        ExprList newExprList =  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ;
        while(!exprList.isEmptyconcExpr()) {
          Expr localExpr = exprList.getHeadconcExpr();
          exprList = exprList.getTailconcExpr();
          newExprList = tom_append_list_concExpr(newExprList, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.ilnot.make(localExpr) , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) );
        }
        return newExprList;
      }}}}}}{ Object tomMatch309NameNumber_freshVar_25=ex;if ( (tomMatch309NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch309NameNumber_freshVar_25);{  tom.engine.adt.il.types.Expr  tomMatch309NameNumber_freshVar_26=tomMatch309NameNumber_freshSubject_1;{ boolean tomMatch309NameNumber_freshVar_27= false ;if ( (tomMatch309NameNumber_freshVar_26 instanceof tom.engine.adt.il.types.expr.iltrue) ) {tomMatch309NameNumber_freshVar_27= true ;} else {if ( (tomMatch309NameNumber_freshVar_26 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {tomMatch309NameNumber_freshVar_27= true ;}}if ( tomMatch309NameNumber_freshVar_27== true  ) {

        return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ;
      }}}}}}}

    System.out.println("apply ExprRules : nothing applies to:" + ex);
    return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make(ex, tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) ;
  }

  protected Expr buildConstraint(SubstitutionList substitution, Instr pil,Instr goal) {
    {{ Object tomMatch311NameNumber_freshVar_0=pil;if ( (tomMatch311NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch311NameNumber_freshVar_0);{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_2=tomMatch311NameNumber_freshSubject_1;if ( (tomMatch311NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.instr.sequence) ) {{  tom.engine.adt.il.types.InstrList  tomMatch311NameNumber_freshVar_1= tomMatch311NameNumber_freshVar_2.getInstrlist() ;{  tom.engine.adt.il.types.InstrList  tomMatch311NameNumber_freshVar_3=tomMatch311NameNumber_freshVar_1;if ( ((tomMatch311NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.instrlist.Conssemicolon) || (tomMatch311NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.instrlist.Emptysemicolon)) ) {if (!( tomMatch311NameNumber_freshVar_3.isEmptysemicolon() )) {{  tom.engine.adt.il.types.Instr  tom_h= tomMatch311NameNumber_freshVar_3.getHeadsemicolon() ;{  tom.engine.adt.il.types.InstrList  tomMatch311NameNumber_freshVar_4= tomMatch311NameNumber_freshVar_3.getTailsemicolon() ;{  tom.engine.adt.il.types.InstrList  tom_t=tomMatch311NameNumber_freshVar_4;

        Expr goalFromHead = buildConstraint(substitution,tom_h,goal);
        if (!tom_t.isEmptysemicolon()) {
          Expr refuseFromHead = buildConstraint(substitution,tom_h, tom.engine.adt.il.types.instr.refuse.make() );
          Expr goalFromTail = buildConstraint(substitution, tom.engine.adt.il.types.instr.sequence.make(tom_t) ,goal);
          if(this.isCamlSemantics()) {
            return  tom.engine.adt.il.types.expr.ilor.make(goalFromHead,  tom.engine.adt.il.types.expr.iland.make(refuseFromHead, goalFromTail) ) ;
          } else {
            return  tom.engine.adt.il.types.expr.ilor.make(goalFromHead, goalFromTail) ;
          }
        } else {
          return goalFromHead;
        }
      }}}}}}}}}}}}{ Object tomMatch311NameNumber_freshVar_6=pil;if ( (tomMatch311NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch311NameNumber_freshVar_6);{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_10=tomMatch311NameNumber_freshSubject_1;if ( (tomMatch311NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.instr.ILLet) ) {{  tom.engine.adt.il.types.Variable  tomMatch311NameNumber_freshVar_7= tomMatch311NameNumber_freshVar_10.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch311NameNumber_freshVar_8= tomMatch311NameNumber_freshVar_10.getT() ;{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_9= tomMatch311NameNumber_freshVar_10.getBody() ;

        // update the substitution
        Term t = replaceVariablesInTerm( tom.engine.adt.il.types.term.appSubsT.make(substitution, tomMatch311NameNumber_freshVar_8) );
        substitution = tom_append_list_subs(substitution, tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.is.make(tomMatch311NameNumber_freshVar_7, t) , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) );
        //return `iland(eq(tau(absvar(x)),u),buildConstraint(substitution,i,goal));
        return buildConstraint(substitution,tomMatch311NameNumber_freshVar_9,goal);
      }}}}}}}}{ Object tomMatch311NameNumber_freshVar_11=pil;if ( (tomMatch311NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch311NameNumber_freshVar_11);{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_15=tomMatch311NameNumber_freshSubject_1;if ( (tomMatch311NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.instr.ITE) ) {{  tom.engine.adt.il.types.Expr  tomMatch311NameNumber_freshVar_12= tomMatch311NameNumber_freshVar_15.getE() ;{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_13= tomMatch311NameNumber_freshVar_15.getIft() ;{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_14= tomMatch311NameNumber_freshVar_15.getIff() ;

        Expr closedExpr = replaceVariablesInExpr( tom.engine.adt.il.types.expr.appSubsE.make(substitution, tomMatch311NameNumber_freshVar_12) );
        Expr constraintTrue  =  tom.engine.adt.il.types.expr.iland.make(closedExpr, buildConstraint(substitution,tomMatch311NameNumber_freshVar_13,goal)) ;
        Expr constraintFalse =  tom.engine.adt.il.types.expr.iland.make( tom.engine.adt.il.types.expr.ilnot.make(closedExpr) , buildConstraint(substitution,tomMatch311NameNumber_freshVar_14,goal)) ;
        return  tom.engine.adt.il.types.expr.ilor.make(constraintTrue, constraintFalse) ;
      }}}}}}}}{ Object tomMatch311NameNumber_freshVar_16=pil;if ( (tomMatch311NameNumber_freshVar_16 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch311NameNumber_freshVar_16);{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_17=tomMatch311NameNumber_freshSubject_1;if ( (tomMatch311NameNumber_freshVar_17 instanceof tom.engine.adt.il.types.instr.refuse) ) {

        if (pil == goal) {
          return  tom.engine.adt.il.types.expr.iltrue.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ) ;
        } else {
          return  tom.engine.adt.il.types.expr.ilfalse.make() ;
        }
      }}}}}{ Object tomMatch311NameNumber_freshVar_18=pil;if ( (tomMatch311NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch311NameNumber_freshVar_18);{  tom.engine.adt.il.types.Instr  tomMatch311NameNumber_freshVar_19=tomMatch311NameNumber_freshSubject_1;if ( (tomMatch311NameNumber_freshVar_19 instanceof tom.engine.adt.il.types.instr.accept) ) {

        if (pil == goal) {
          return  tom.engine.adt.il.types.expr.iltrue.make(substitution) ;
        } else {
          return  tom.engine.adt.il.types.expr.ilfalse.make() ;
        }
      }}}}}}

    // default case, should not happen
    return  tom.engine.adt.il.types.expr.ilfalse.make() ;
  }

  protected Collection applySemanticsRules(Deriv post) {
    Collection c = new HashSet();
    {{ Object tomMatch312NameNumber_freshVar_0=post;if ( (tomMatch312NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_0);{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshVar_3=tomMatch312NameNumber_freshSubject_1;if ( (tomMatch312NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_1= tomMatch312NameNumber_freshVar_3.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_2= tomMatch312NameNumber_freshVar_3.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_6=tomMatch312NameNumber_freshVar_1;if ( (tomMatch312NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_4= tomMatch312NameNumber_freshVar_6.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_5= tomMatch312NameNumber_freshVar_6.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tom_e=tomMatch312NameNumber_freshVar_4;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_8=tomMatch312NameNumber_freshVar_5;if ( (tomMatch312NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.instr.sequence) ) {{  tom.engine.adt.il.types.InstrList  tomMatch312NameNumber_freshVar_7= tomMatch312NameNumber_freshVar_8.getInstrlist() ;{  tom.engine.adt.il.types.InstrList  tomMatch312NameNumber_freshVar_12=tomMatch312NameNumber_freshVar_7;if ( ((tomMatch312NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.instrlist.Conssemicolon) || (tomMatch312NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.instrlist.Emptysemicolon)) ) {if (!( tomMatch312NameNumber_freshVar_12.isEmptysemicolon() )) {{  tom.engine.adt.il.types.Instr  tom_h= tomMatch312NameNumber_freshVar_12.getHeadsemicolon() ;{  tom.engine.adt.il.types.InstrList  tomMatch312NameNumber_freshVar_13= tomMatch312NameNumber_freshVar_12.getTailsemicolon() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_11=tomMatch312NameNumber_freshVar_2;if ( (tomMatch312NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_9= tomMatch312NameNumber_freshVar_11.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_10= tomMatch312NameNumber_freshVar_11.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_15=tomMatch312NameNumber_freshVar_9;if ( ((tomMatch312NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch312NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch312NameNumber_freshVar_15.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch312NameNumber_freshVar_17= tomMatch312NameNumber_freshVar_15.getHeadsubs() ;if ( (tomMatch312NameNumber_freshVar_17 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_16= tomMatch312NameNumber_freshVar_15.getTailsubs() ;if ( tomMatch312NameNumber_freshVar_16.isEmptysubs() ) {{  tom.engine.adt.il.types.Instr  tom_ip=tomMatch312NameNumber_freshVar_10;

        if(instructionContains(tom_h,tom_ip)) {
          // ends the derivation
          Deriv up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_e, tom_h) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , tom_ip) ) ;
          Collection pre_list = applySemanticsRules(up);

          Iterator it = pre_list.iterator();
          while(it.hasNext()) {
            DerivTree pre = (DerivTree) it.next();
            c.add( tom.engine.adt.il.types.derivtree.derivrule.make("seqa", post, pre,  tom.engine.adt.il.types.seq.seq.make() ) );
          }
        } else {
          // continue the derivation with t
          Deriv up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_e,  tom.engine.adt.il.types.instr.sequence.make(tomMatch312NameNumber_freshVar_13) ) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , tom_ip) ) ;
          Collection post_list = applySemanticsRules(up);

          if(this.isCamlSemantics()) {
            up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_e, tom_h) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ,  tom.engine.adt.il.types.instr.refuse.make() ) ) ;
            Collection pre_list = applySemanticsRules(up);
            Iterator it = pre_list.iterator();
            while(it.hasNext()) {
              DerivTree pre = (DerivTree) it.next();
              Iterator it2 = post_list.iterator();
              while(it2.hasNext()) {
                DerivTree pre2 = (DerivTree) it2.next();
                c.add( tom.engine.adt.il.types.derivtree.derivrule2.make("seqb", post, pre, pre2,  tom.engine.adt.il.types.seq.seq.make() ) );
              }
            }
          } else {
            Iterator it = post_list.iterator();
            while(it.hasNext()) {
              DerivTree pre = (DerivTree) it.next();
              c.add( tom.engine.adt.il.types.derivtree.derivrule2.make("seqb", post,  tom.engine.adt.il.types.derivtree.endderiv.make() , pre,  tom.engine.adt.il.types.seq.seq.make() ) );
            }
          }
        }
      }}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch312NameNumber_freshVar_18=post;if ( (tomMatch312NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_18);{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshVar_21=tomMatch312NameNumber_freshSubject_1;if ( (tomMatch312NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_19= tomMatch312NameNumber_freshVar_21.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_20= tomMatch312NameNumber_freshVar_21.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_24=tomMatch312NameNumber_freshVar_19;if ( (tomMatch312NameNumber_freshVar_24 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_22= tomMatch312NameNumber_freshVar_24.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_23= tomMatch312NameNumber_freshVar_24.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tom_e=tomMatch312NameNumber_freshVar_22;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_28=tomMatch312NameNumber_freshVar_23;if ( (tomMatch312NameNumber_freshVar_28 instanceof tom.engine.adt.il.types.instr.ILLet) ) {{  tom.engine.adt.il.types.Variable  tomMatch312NameNumber_freshVar_25= tomMatch312NameNumber_freshVar_28.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch312NameNumber_freshVar_26= tomMatch312NameNumber_freshVar_28.getT() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_27= tomMatch312NameNumber_freshVar_28.getBody() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_31=tomMatch312NameNumber_freshVar_20;if ( (tomMatch312NameNumber_freshVar_31 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_29= tomMatch312NameNumber_freshVar_31.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_30= tomMatch312NameNumber_freshVar_31.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_32=tomMatch312NameNumber_freshVar_29;if ( ((tomMatch312NameNumber_freshVar_32 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch312NameNumber_freshVar_32 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch312NameNumber_freshVar_32.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch312NameNumber_freshVar_34= tomMatch312NameNumber_freshVar_32.getHeadsubs() ;if ( (tomMatch312NameNumber_freshVar_34 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_33= tomMatch312NameNumber_freshVar_32.getTailsubs() ;if ( tomMatch312NameNumber_freshVar_33.isEmptysubs() ) {


        // build condition
        Seq cond = seqFromTerm( tom.engine.adt.il.types.term.appSubsT.make(tom_e, tomMatch312NameNumber_freshVar_26) );
        // find "t"
        Term t = null;
        {{ Object tomMatch313NameNumber_freshVar_0=cond;if ( (tomMatch313NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch313NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch313NameNumber_freshVar_0);{  tom.engine.adt.il.types.Seq  tomMatch313NameNumber_freshVar_2=tomMatch313NameNumber_freshSubject_1;if ( (tomMatch313NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.seq.dedterm) ) {{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_freshVar_1= tomMatch313NameNumber_freshVar_2.getTerms() ;{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_freshVar_3=tomMatch313NameNumber_freshVar_1;if ( ((tomMatch313NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.termlist.ConsconcTerm) || (tomMatch313NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.termlist.EmptyconcTerm)) ) {{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_begin_5=tomMatch313NameNumber_freshVar_3;{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_end_6=tomMatch313NameNumber_freshVar_3;do {{{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_freshVar_4=tomMatch313NameNumber_end_6;if (!( tomMatch313NameNumber_freshVar_4.isEmptyconcTerm() )) {{  tom.engine.adt.il.types.TermList  tomMatch313NameNumber_freshVar_7= tomMatch313NameNumber_freshVar_4.getTailconcTerm() ;if ( tomMatch313NameNumber_freshVar_7.isEmptyconcTerm() ) {
 t =  tomMatch313NameNumber_freshVar_4.getHeadconcTerm() ; }}}}if ( tomMatch313NameNumber_end_6.isEmptyconcTerm() ) {tomMatch313NameNumber_end_6=tomMatch313NameNumber_begin_5;} else {tomMatch313NameNumber_end_6= tomMatch313NameNumber_end_6.getTailconcTerm() ;}}} while(!( (tomMatch313NameNumber_end_6==tomMatch313NameNumber_begin_5) ));}}}}}}}}}}{ Object tomMatch313NameNumber_freshVar_8=cond;if ( (tomMatch313NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch313NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch313NameNumber_freshVar_8);
 if (t == null) {
            System.out.println("seqFromTerm has a problem with " + cond);
          }
          }}}}

        Deriv up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_append_list_subs(tom_e, tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.is.make(tomMatch312NameNumber_freshVar_25, t) , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ), tomMatch312NameNumber_freshVar_27) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , tomMatch312NameNumber_freshVar_30) 
            ) 


;
        Collection pre_list = applySemanticsRules(up);
        Iterator it = pre_list.iterator();
        while(it.hasNext()) {
          DerivTree pre = (DerivTree) it.next();
          c.add( tom.engine.adt.il.types.derivtree.derivrule.make("let", post, pre, cond) );
        }
      }}}}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch312NameNumber_freshVar_35=post;if ( (tomMatch312NameNumber_freshVar_35 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_35);{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshVar_38=tomMatch312NameNumber_freshSubject_1;if ( (tomMatch312NameNumber_freshVar_38 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_36= tomMatch312NameNumber_freshVar_38.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_37= tomMatch312NameNumber_freshVar_38.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_41=tomMatch312NameNumber_freshVar_36;if ( (tomMatch312NameNumber_freshVar_41 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_39= tomMatch312NameNumber_freshVar_41.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_40= tomMatch312NameNumber_freshVar_41.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tom_e=tomMatch312NameNumber_freshVar_39;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_45=tomMatch312NameNumber_freshVar_40;if ( (tomMatch312NameNumber_freshVar_45 instanceof tom.engine.adt.il.types.instr.ITE) ) {{  tom.engine.adt.il.types.Expr  tomMatch312NameNumber_freshVar_42= tomMatch312NameNumber_freshVar_45.getE() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_43= tomMatch312NameNumber_freshVar_45.getIft() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_44= tomMatch312NameNumber_freshVar_45.getIff() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_48=tomMatch312NameNumber_freshVar_37;if ( (tomMatch312NameNumber_freshVar_48 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_46= tomMatch312NameNumber_freshVar_48.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_47= tomMatch312NameNumber_freshVar_48.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_49=tomMatch312NameNumber_freshVar_46;if ( ((tomMatch312NameNumber_freshVar_49 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch312NameNumber_freshVar_49 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch312NameNumber_freshVar_49.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch312NameNumber_freshVar_51= tomMatch312NameNumber_freshVar_49.getHeadsubs() ;if ( (tomMatch312NameNumber_freshVar_51 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_50= tomMatch312NameNumber_freshVar_49.getTailsubs() ;if ( tomMatch312NameNumber_freshVar_50.isEmptysubs() ) {{  tom.engine.adt.il.types.Instr  tom_ip=tomMatch312NameNumber_freshVar_47;


        // build condition
        ExprList cond = exprListFromExpr( tom.engine.adt.il.types.expr.appSubsE.make(tom_e, tomMatch312NameNumber_freshVar_42) );

        Deriv up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_e, tomMatch312NameNumber_freshVar_43) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , tom_ip) ) ;
        String rulename = "iftrue";

        Collection pre_list = applySemanticsRules(up);
        Iterator it = pre_list.iterator();
        while(it.hasNext()) {
          DerivTree pre = (DerivTree) it.next();
          c.add( tom.engine.adt.il.types.derivtree.derivrule.make(rulename, post, pre,  tom.engine.adt.il.types.seq.dedexpr.make(tom_append_list_concExpr(cond, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.iltrue.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ) , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) )) ) );
        }

        up =  tom.engine.adt.il.types.deriv.ebs.make( tom.engine.adt.il.types.environment.env.make(tom_e, tomMatch312NameNumber_freshVar_44) ,  tom.engine.adt.il.types.environment.env.make( tom.engine.adt.il.types.substitutionlist.Conssubs.make( tom.engine.adt.il.types.substitution.undefsubs.make() , tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) , tom_ip) ) ;
        rulename = "iffalse";

        pre_list = applySemanticsRules(up);
        it = pre_list.iterator();
        while(it.hasNext()) {
          DerivTree pre = (DerivTree) it.next();
          c.add( tom.engine.adt.il.types.derivtree.derivrule.make(rulename, post, pre,  tom.engine.adt.il.types.seq.dedexpr.make(tom_append_list_concExpr(cond, tom.engine.adt.il.types.exprlist.ConsconcExpr.make( tom.engine.adt.il.types.expr.ilfalse.make() , tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) )) ) );
        }
      }}}}}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch312NameNumber_freshVar_52=post;if ( (tomMatch312NameNumber_freshVar_52 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_52);{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshVar_55=tomMatch312NameNumber_freshSubject_1;if ( (tomMatch312NameNumber_freshVar_55 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_53= tomMatch312NameNumber_freshVar_55.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_54= tomMatch312NameNumber_freshVar_55.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_58=tomMatch312NameNumber_freshVar_53;if ( (tomMatch312NameNumber_freshVar_58 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_56= tomMatch312NameNumber_freshVar_58.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_57= tomMatch312NameNumber_freshVar_58.getI() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_59=tomMatch312NameNumber_freshVar_57;if ( (tomMatch312NameNumber_freshVar_59 instanceof tom.engine.adt.il.types.instr.accept) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_62=tomMatch312NameNumber_freshVar_54;if ( (tomMatch312NameNumber_freshVar_62 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_60= tomMatch312NameNumber_freshVar_62.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_61= tomMatch312NameNumber_freshVar_62.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_64=tomMatch312NameNumber_freshVar_60;if ( ((tomMatch312NameNumber_freshVar_64 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch312NameNumber_freshVar_64 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch312NameNumber_freshVar_64.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch312NameNumber_freshVar_66= tomMatch312NameNumber_freshVar_64.getHeadsubs() ;if ( (tomMatch312NameNumber_freshVar_66 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_65= tomMatch312NameNumber_freshVar_64.getTailsubs() ;if ( tomMatch312NameNumber_freshVar_65.isEmptysubs() ) {{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_63=tomMatch312NameNumber_freshVar_61;if ( (tomMatch312NameNumber_freshVar_63 instanceof tom.engine.adt.il.types.instr.accept) ) {


        c.add( tom.engine.adt.il.types.derivtree.derivrule.make("axiom_accept", post,  tom.engine.adt.il.types.derivtree.endderiv.make() ,  tom.engine.adt.il.types.seq.seq.make() ) );
      }}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch312NameNumber_freshVar_67=post;if ( (tomMatch312NameNumber_freshVar_67 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_67);{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshVar_70=tomMatch312NameNumber_freshSubject_1;if ( (tomMatch312NameNumber_freshVar_70 instanceof tom.engine.adt.il.types.deriv.ebs) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_68= tomMatch312NameNumber_freshVar_70.getLhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_69= tomMatch312NameNumber_freshVar_70.getRhs() ;{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_73=tomMatch312NameNumber_freshVar_68;if ( (tomMatch312NameNumber_freshVar_73 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_71= tomMatch312NameNumber_freshVar_73.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_72= tomMatch312NameNumber_freshVar_73.getI() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_74=tomMatch312NameNumber_freshVar_72;if ( (tomMatch312NameNumber_freshVar_74 instanceof tom.engine.adt.il.types.instr.refuse) ) {{  tom.engine.adt.il.types.Environment  tomMatch312NameNumber_freshVar_77=tomMatch312NameNumber_freshVar_69;if ( (tomMatch312NameNumber_freshVar_77 instanceof tom.engine.adt.il.types.environment.env) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_75= tomMatch312NameNumber_freshVar_77.getSubs() ;{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_76= tomMatch312NameNumber_freshVar_77.getI() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_79=tomMatch312NameNumber_freshVar_75;if ( ((tomMatch312NameNumber_freshVar_79 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch312NameNumber_freshVar_79 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch312NameNumber_freshVar_79.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch312NameNumber_freshVar_81= tomMatch312NameNumber_freshVar_79.getHeadsubs() ;if ( (tomMatch312NameNumber_freshVar_81 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch312NameNumber_freshVar_80= tomMatch312NameNumber_freshVar_79.getTailsubs() ;if ( tomMatch312NameNumber_freshVar_80.isEmptysubs() ) {{  tom.engine.adt.il.types.Instr  tomMatch312NameNumber_freshVar_78=tomMatch312NameNumber_freshVar_76;if ( (tomMatch312NameNumber_freshVar_78 instanceof tom.engine.adt.il.types.instr.refuse) ) {

        c.add( tom.engine.adt.il.types.derivtree.derivrule.make("axiom_refuse", post,  tom.engine.adt.il.types.derivtree.endderiv.make() ,  tom.engine.adt.il.types.seq.seq.make() ) );
      }}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch312NameNumber_freshVar_82=post;if ( (tomMatch312NameNumber_freshVar_82 instanceof tom.engine.adt.il.types.Deriv) ) {{  tom.engine.adt.il.types.Deriv  tomMatch312NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Deriv )tomMatch312NameNumber_freshVar_82);

        if (c.isEmpty()) {
          //System.out.println("Error " + post);
        }
      }}}}

    return c;
  }

  public static class stratInstructionContains extends tom.library.sl.BasicStrategy {private  tom.engine.adt.il.types.Instr  goal;private  java.util.Collection  c;public stratInstructionContains( tom.engine.adt.il.types.Instr  goal,  java.util.Collection  c) {super(( new tom.library.sl.Identity() ));this.goal=goal;this.c=c;}public  tom.engine.adt.il.types.Instr  getgoal() {return goal;}public  java.util.Collection  getc() {return c;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.il.types.Instr  visit_Instr( tom.engine.adt.il.types.Instr  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch314NameNumber_freshVar_0=tom__arg;if ( (tomMatch314NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch314NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch314NameNumber_freshVar_0);{  tom.engine.adt.il.types.Instr  tom_x=tomMatch314NameNumber_freshSubject_1;


        if (tom_x== goal) {
          c.add(goal);
          ( new tom.library.sl.Fail() ).visitLight(tom_x);
        }
      }}}}}return _visit_Instr(tom__arg,introspector); }public  tom.engine.adt.il.types.Instr  _visit_Instr( tom.engine.adt.il.types.Instr  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.il.types.Instr )any.visit(environment,introspector));} else {return (( tom.engine.adt.il.types.Instr )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.il.types.Instr) ) {return visit_Instr((( tom.engine.adt.il.types.Instr )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_stratInstructionContains( tom.engine.adt.il.types.Instr  t0,  java.util.Collection  t1) { return new stratInstructionContains(t0,t1);}


  protected boolean instructionContains(Instr i, Instr goal) {
    Collection collect = new HashSet();
    try {
      ( new tom.library.sl.Mu(( new tom.library.sl.MuVar("x") ),tom_make_Try(( (( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ),( null )) )==null)?tom_make_stratInstructionContains(goal,collect):new tom.library.sl.Sequence(tom_make_stratInstructionContains(goal,collect),( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("x") )) ),( null )) )) ))) ).visitLight(i);
    } catch(tom.library.sl.VisitFailure e) {
      System.out.println("strategy instructionContains failed");
    }
    return !collect.isEmpty();
  }

  /**
   * To replace undefsubst in tree by the computed value
   * which leads to axiom
   */
  public static class replaceUndefsubs extends tom.library.sl.BasicStrategy {private  tom.engine.adt.il.types.SubstitutionList  arg;public replaceUndefsubs( tom.engine.adt.il.types.SubstitutionList  arg) {super(( new tom.library.sl.Identity() ));this.arg=arg;}public  tom.engine.adt.il.types.SubstitutionList  getarg() {return arg;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.il.types.SubstitutionList  visit_SubstitutionList( tom.engine.adt.il.types.SubstitutionList  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch315NameNumber_freshVar_0=tom__arg;if ( (tomMatch315NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch315NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch315NameNumber_freshVar_0);{  tom.engine.adt.il.types.SubstitutionList  tomMatch315NameNumber_freshVar_1=tomMatch315NameNumber_freshSubject_1;if ( ((tomMatch315NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch315NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch315NameNumber_freshVar_1.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch315NameNumber_freshVar_3= tomMatch315NameNumber_freshVar_1.getHeadsubs() ;if ( (tomMatch315NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch315NameNumber_freshVar_2= tomMatch315NameNumber_freshVar_1.getTailsubs() ;if ( tomMatch315NameNumber_freshVar_2.isEmptysubs() ) {


        return arg;
      }}}}}}}}}}}return _visit_SubstitutionList(tom__arg,introspector); }public  tom.engine.adt.il.types.SubstitutionList  _visit_SubstitutionList( tom.engine.adt.il.types.SubstitutionList  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.il.types.SubstitutionList )any.visit(environment,introspector));} else {return (( tom.engine.adt.il.types.SubstitutionList )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.il.types.SubstitutionList) ) {return visit_SubstitutionList((( tom.engine.adt.il.types.SubstitutionList )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_replaceUndefsubs( tom.engine.adt.il.types.SubstitutionList  t0) { return new replaceUndefsubs(t0);}



  private DerivTree replaceUndefinedSubstitution(DerivTree subject,
      SubstitutionList subs) {
    try {
      subject = (DerivTree) tom_make_TopDown(tom_make_replaceUndefsubs(subs)).visitLight(subject);
    } catch (tom.library.sl.VisitFailure e) {
      throw new TomRuntimeException("Strategy replaceUndefsubs failed");
    }
    return subject;
  }

  



  static private class SubstRef {
    private SubstitutionList sublist;
    public SubstRef(SubstitutionList slist) {
      sublist = slist;
    }
    public void set(SubstitutionList ssublist) {
      this.sublist = ssublist;
    }
    public SubstitutionList get() {
      return sublist;
    }
  }

  /**
   * These functions deals with substitution application
   */
  public static class replaceVariableByTerm extends tom.library.sl.BasicStrategy {private  java.util.Map  map;public replaceVariableByTerm( java.util.Map  map) {super(( new tom.library.sl.Identity() ));this.map=map;}public  java.util.Map  getmap() {return map;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.il.types.Term  visit_Term( tom.engine.adt.il.types.Term  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch316NameNumber_freshVar_0=tom__arg;if ( (tomMatch316NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch316NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch316NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch316NameNumber_freshVar_2=tomMatch316NameNumber_freshSubject_1;if ( (tomMatch316NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch316NameNumber_freshVar_1= tomMatch316NameNumber_freshVar_2.getAbst() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch316NameNumber_freshVar_4=tomMatch316NameNumber_freshVar_1;if ( (tomMatch316NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.absterm.absvar) ) {{  tom.engine.adt.il.types.Variable  tomMatch316NameNumber_freshVar_3= tomMatch316NameNumber_freshVar_4.getVarname() ;{  tom.engine.adt.il.types.Variable  tomMatch316NameNumber_freshVar_5=tomMatch316NameNumber_freshVar_3;if ( (tomMatch316NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.variable.var) ) {{  tom.engine.adt.il.types.Variable  tom_v=tomMatch316NameNumber_freshVar_3;


        if (map.containsKey(tom_v)) {
          return (Term)map.get(tom_v);
        }
        return tomMatch316NameNumber_freshSubject_1;
      }}}}}}}}}}}}}return _visit_Term(tom__arg,introspector); }public  tom.engine.adt.il.types.Term  _visit_Term( tom.engine.adt.il.types.Term  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.engine.adt.il.types.Term )any.visit(environment,introspector));} else {return (( tom.engine.adt.il.types.Term )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.engine.adt.il.types.Term) ) {return visit_Term((( tom.engine.adt.il.types.Term )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_replaceVariableByTerm( java.util.Map  t0) { return new replaceVariableByTerm(t0);}



  public Term replaceVariablesInTerm(Term subject) {
    {{ Object tomMatch317NameNumber_freshVar_0=subject;if ( (tomMatch317NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch317NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch317NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch317NameNumber_freshVar_3=tomMatch317NameNumber_freshSubject_1;if ( (tomMatch317NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.term.appSubsT) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch317NameNumber_freshVar_1= tomMatch317NameNumber_freshVar_3.getSubs() ;{  tom.engine.adt.il.types.Term  tomMatch317NameNumber_freshVar_2= tomMatch317NameNumber_freshVar_3.getT() ;{  tom.engine.adt.il.types.Term  tom_term=tomMatch317NameNumber_freshVar_2;

        Map map = buildVariableMap(tomMatch317NameNumber_freshVar_1, new HashMap());
        Term t = tom_term;
        try {
          t = (Term) tom_make_TopDown(tom_make_replaceVariableByTerm(map)).visitLight(tom_term);
        } catch (tom.library.sl.VisitFailure e) {
          throw new TomRuntimeException("Strategy replaceVariableByTerm failed");
        }
        return t;
      }}}}}}}}}

    return subject;
  }

  public Expr replaceVariablesInExpr(Expr subject) {
    {{ Object tomMatch318NameNumber_freshVar_0=subject;if ( (tomMatch318NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch318NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch318NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch318NameNumber_freshVar_3=tomMatch318NameNumber_freshSubject_1;if ( (tomMatch318NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.expr.appSubsE) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch318NameNumber_freshVar_1= tomMatch318NameNumber_freshVar_3.getSubs() ;{  tom.engine.adt.il.types.Expr  tomMatch318NameNumber_freshVar_2= tomMatch318NameNumber_freshVar_3.getE() ;{  tom.engine.adt.il.types.Expr  tom_term=tomMatch318NameNumber_freshVar_2;

        Map map = buildVariableMap(tomMatch318NameNumber_freshVar_1, new HashMap());
        Expr t = tom_term;
        try {
          t = (Expr) tom_make_TopDown(tom_make_replaceVariableByTerm(map)).visitLight(tom_term);
        } catch (tom.library.sl.VisitFailure e) {
          throw new TomRuntimeException("Strategy replaceVariableByTerm failed");
        }
        return t;
      }}}}}}}}}

    return subject;
  }

  private Map buildVariableMap(SubstitutionList sublist, Map map) {
    {{ Object tomMatch319NameNumber_freshVar_0=sublist;if ( (tomMatch319NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch319NameNumber_freshVar_0);{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshVar_1=tomMatch319NameNumber_freshSubject_1;if ( ((tomMatch319NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch319NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if ( tomMatch319NameNumber_freshVar_1.isEmptysubs() ) {
 return map; }}}}}}{ Object tomMatch319NameNumber_freshVar_2=sublist;if ( (tomMatch319NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch319NameNumber_freshVar_2);{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshVar_3=tomMatch319NameNumber_freshSubject_1;if ( ((tomMatch319NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch319NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch319NameNumber_freshVar_3.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch319NameNumber_freshVar_6= tomMatch319NameNumber_freshVar_3.getHeadsubs() ;if ( (tomMatch319NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshVar_4= tomMatch319NameNumber_freshVar_3.getTailsubs() ;
 return buildVariableMap(tomMatch319NameNumber_freshVar_4,map);}}}}}}}}}{ Object tomMatch319NameNumber_freshVar_7=sublist;if ( (tomMatch319NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch319NameNumber_freshVar_7);{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshVar_8=tomMatch319NameNumber_freshSubject_1;if ( ((tomMatch319NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch319NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch319NameNumber_freshVar_8.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch319NameNumber_freshVar_13= tomMatch319NameNumber_freshVar_8.getHeadsubs() ;if ( (tomMatch319NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.substitution.is) ) {{  tom.engine.adt.il.types.Variable  tomMatch319NameNumber_freshVar_11= tomMatch319NameNumber_freshVar_13.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch319NameNumber_freshVar_12= tomMatch319NameNumber_freshVar_13.getTerm() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch319NameNumber_freshVar_9= tomMatch319NameNumber_freshVar_8.getTailsubs() ;

        map.put(tomMatch319NameNumber_freshVar_11,tomMatch319NameNumber_freshVar_12);
        return buildVariableMap(tomMatch319NameNumber_freshVar_9,map);
      }}}}}}}}}}}}

    return null;
  }

  public void mappingReduce(Map input) {
    Iterator it = input.keySet().iterator();
    while(it.hasNext()) {
      Object key = it.next();
      Expr value = (Expr) input.get(key);
      input.put(key,reduceWithMappingRules(value));
    }
  }

  public void booleanReduce(Map input) {
    Iterator it = input.keySet().iterator();
    while(it.hasNext()) {
      Object key = it.next();
      Expr value = (Expr) input.get(key);
      input.put(key,booleanSimplify(value));
    }
  }

  public Expr booleanSimplify(Expr expr) {
    Strategy booleanSimplifier = new BooleanSimplifier();
    Expr res =  tom.engine.adt.il.types.expr.ilfalse.make() ;
    try {
      res = (Expr) tom_make_InnermostId(booleanSimplifier).visitLight(expr);
    } catch (tom.library.sl.VisitFailure e) {
      System.out.println("humm");
    }
    return res;
  }

  public class BooleanSimplifier extends BasicStrategy {
    public BooleanSimplifier() {
      super(( new tom.library.sl.Identity() ));
    }

    public Object visitLight(Object o, Introspector i) throws tom.library.sl.VisitFailure {
      if (o instanceof Expr) {
        Expr arg = (Expr) o;
        {{ Object tomMatch320NameNumber_freshVar_0=arg;if ( (tomMatch320NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_3=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.expr.iland) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_1= tomMatch320NameNumber_freshVar_3.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_2= tomMatch320NameNumber_freshVar_3.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_4=tomMatch320NameNumber_freshVar_1;if ( (tomMatch320NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

            return  tom.engine.adt.il.types.expr.ilfalse.make() ;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_5=arg;if ( (tomMatch320NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_5);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_8=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.expr.iland) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_6= tomMatch320NameNumber_freshVar_8.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_7= tomMatch320NameNumber_freshVar_8.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_9=tomMatch320NameNumber_freshVar_7;if ( (tomMatch320NameNumber_freshVar_9 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

            return  tom.engine.adt.il.types.expr.ilfalse.make() ;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_10=arg;if ( (tomMatch320NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_10);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_13=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_11= tomMatch320NameNumber_freshVar_13.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_12= tomMatch320NameNumber_freshVar_13.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_14=tomMatch320NameNumber_freshVar_11;if ( (tomMatch320NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.expr.iltrue) ) {

            return tomMatch320NameNumber_freshVar_11;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_15=arg;if ( (tomMatch320NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_15);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_18=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_16= tomMatch320NameNumber_freshVar_18.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_17= tomMatch320NameNumber_freshVar_18.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_19=tomMatch320NameNumber_freshVar_17;if ( (tomMatch320NameNumber_freshVar_19 instanceof tom.engine.adt.il.types.expr.iltrue) ) {

            return tomMatch320NameNumber_freshVar_17;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_20=arg;if ( (tomMatch320NameNumber_freshVar_20 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_20);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_23=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_23 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_21= tomMatch320NameNumber_freshVar_23.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_22= tomMatch320NameNumber_freshVar_23.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_24=tomMatch320NameNumber_freshVar_21;if ( (tomMatch320NameNumber_freshVar_24 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

            return tomMatch320NameNumber_freshVar_22;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_25=arg;if ( (tomMatch320NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_25);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_28=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_28 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_26= tomMatch320NameNumber_freshVar_28.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_27= tomMatch320NameNumber_freshVar_28.getRight() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_29=tomMatch320NameNumber_freshVar_27;if ( (tomMatch320NameNumber_freshVar_29 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

            return tomMatch320NameNumber_freshVar_26;
          }}}}}}}}}{ Object tomMatch320NameNumber_freshVar_30=arg;if ( (tomMatch320NameNumber_freshVar_30 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_30);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_32=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_32 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_31= tomMatch320NameNumber_freshVar_32.getExp() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_33=tomMatch320NameNumber_freshVar_31;if ( (tomMatch320NameNumber_freshVar_33 instanceof tom.engine.adt.il.types.expr.iltrue) ) {

            return  tom.engine.adt.il.types.expr.ilfalse.make() ;
          }}}}}}}}{ Object tomMatch320NameNumber_freshVar_34=arg;if ( (tomMatch320NameNumber_freshVar_34 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch320NameNumber_freshVar_34);{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_36=tomMatch320NameNumber_freshSubject_1;if ( (tomMatch320NameNumber_freshVar_36 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_35= tomMatch320NameNumber_freshVar_36.getExp() ;{  tom.engine.adt.il.types.Expr  tomMatch320NameNumber_freshVar_37=tomMatch320NameNumber_freshVar_35;if ( (tomMatch320NameNumber_freshVar_37 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {

            return  tom.engine.adt.il.types.expr.iltrue.make( tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) ;
          }}}}}}}}}

      }
      return any.visitLight(o,i);
    }
  }

}

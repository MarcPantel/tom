/* Generated by TOM (version 2.6alpha): Do not edit this file *//*
 *
 * TOM - To One Matching Compiler
 *
 * Copyright (c) 2000-2008, INRIA
 * Nancy, France.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 * Pierre-Etienne Moreau  e-mail: Pierre-Etienne.Moreau@loria.fr
 * Antoine Reilles        e-mail: Antoine.Reilles@loria.fr
 *
 **/

package tom.engine.verifier;

import tom.engine.*;
import aterm.*;
import aterm.pure.*;
import java.util.*;

import tom.engine.adt.tomconstraint.types.*;
import tom.engine.adt.tomdeclaration.types.*;
import tom.engine.adt.tomexpression.types.*;
import tom.engine.adt.tominstruction.types.*;
import tom.engine.adt.tomname.types.*;
import tom.engine.adt.tomoption.types.*;
import tom.engine.adt.tomsignature.types.*;
import tom.engine.adt.tomterm.types.*;
import tom.engine.adt.tomslot.types.*;
import tom.engine.adt.tomtype.types.*;

import tom.engine.adt.il.*;
import tom.engine.adt.il.types.*;
import tom.engine.adt.zenon.*;
import tom.engine.adt.zenon.types.*;

import tom.engine.exception.TomRuntimeException;


public class ZenonOutput {

  // ------------------------------------------------------------
  /* Generated by TOM (version 2.6alpha): Do not edit this file *//* Generated by TOM (version 2.6alpha): Do not edit this file *//* Generated by TOM (version 2.6alpha): Do not edit this file */  /* Generated by TOM (version 2.6alpha): Do not edit this file */ /* Generated by TOM (version 2.6alpha): Do not edit this file *//* Generated by TOM (version 2.6alpha): Do not edit this file */     private static   tom.engine.adt.il.types.ExprList  tom_append_list_concExpr( tom.engine.adt.il.types.ExprList l1,  tom.engine.adt.il.types.ExprList  l2) {     if( l1.isEmptyconcExpr() ) {       return l2;     } else if( l2.isEmptyconcExpr() ) {       return l1;     } else if(  l1.getTailconcExpr() .isEmptyconcExpr() ) {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,l2) ;     } else {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,tom_append_list_concExpr( l1.getTailconcExpr() ,l2)) ;     }   }   private static   tom.engine.adt.il.types.ExprList  tom_get_slice_concExpr( tom.engine.adt.il.types.ExprList  begin,  tom.engine.adt.il.types.ExprList  end, tom.engine.adt.il.types.ExprList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcExpr()  ||  (end== tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( begin.getHeadconcExpr() ,( tom.engine.adt.il.types.ExprList )tom_get_slice_concExpr( begin.getTailconcExpr() ,end,tail)) ;   }      private static   tom.engine.adt.il.types.SubstitutionList  tom_append_list_subs( tom.engine.adt.il.types.SubstitutionList l1,  tom.engine.adt.il.types.SubstitutionList  l2) {     if( l1.isEmptysubs() ) {       return l2;     } else if( l2.isEmptysubs() ) {       return l1;     } else if(  l1.getTailsubs() .isEmptysubs() ) {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,l2) ;     } else {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,tom_append_list_subs( l1.getTailsubs() ,l2)) ;     }   }   private static   tom.engine.adt.il.types.SubstitutionList  tom_get_slice_subs( tom.engine.adt.il.types.SubstitutionList  begin,  tom.engine.adt.il.types.SubstitutionList  end, tom.engine.adt.il.types.SubstitutionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptysubs()  ||  (end== tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( begin.getHeadsubs() ,( tom.engine.adt.il.types.SubstitutionList )tom_get_slice_subs( begin.getTailsubs() ,end,tail)) ;   }      private static   tom.engine.adt.il.types.TermList  tom_append_list_concTerm( tom.engine.adt.il.types.TermList l1,  tom.engine.adt.il.types.TermList  l2) {     if( l1.isEmptyconcTerm() ) {       return l2;     } else if( l2.isEmptyconcTerm() ) {       return l1;     } else if(  l1.getTailconcTerm() .isEmptyconcTerm() ) {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,l2) ;     } else {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,tom_append_list_concTerm( l1.getTailconcTerm() ,l2)) ;     }   }   private static   tom.engine.adt.il.types.TermList  tom_get_slice_concTerm( tom.engine.adt.il.types.TermList  begin,  tom.engine.adt.il.types.TermList  end, tom.engine.adt.il.types.TermList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcTerm()  ||  (end== tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( begin.getHeadconcTerm() ,( tom.engine.adt.il.types.TermList )tom_get_slice_concTerm( begin.getTailconcTerm() ,end,tail)) ;   }    /* Generated by TOM (version 2.6alpha): Do not edit this file */   private static   tom.engine.adt.zenon.types.ZAxiomList  tom_append_list_zby( tom.engine.adt.zenon.types.ZAxiomList l1,  tom.engine.adt.zenon.types.ZAxiomList  l2) {     if( l1.isEmptyzby() ) {       return l2;     } else if( l2.isEmptyzby() ) {       return l1;     } else if(  l1.getTailzby() .isEmptyzby() ) {       return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( l1.getHeadzby() ,l2) ;     } else {       return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( l1.getHeadzby() ,tom_append_list_zby( l1.getTailzby() ,l2)) ;     }   }   private static   tom.engine.adt.zenon.types.ZAxiomList  tom_get_slice_zby( tom.engine.adt.zenon.types.ZAxiomList  begin,  tom.engine.adt.zenon.types.ZAxiomList  end, tom.engine.adt.zenon.types.ZAxiomList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyzby()  ||  (end== tom.engine.adt.zenon.types.zaxiomlist.Emptyzby.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( begin.getHeadzby() ,( tom.engine.adt.zenon.types.ZAxiomList )tom_get_slice_zby( begin.getTailzby() ,end,tail)) ;   }    






  // ------------------------------------------------------------

  private Verifier verifier;
  private TomIlTools tomiltools;

  public ZenonOutput(Verifier verifier) {
    this.verifier = verifier;
    this.tomiltools = new TomIlTools(verifier);
  }

  public Collection zspecSetFromConstraintMap(Map constraintMap) {
    Collection resset = new HashSet();
    Iterator it = constraintMap.entrySet().iterator();
    while(it.hasNext()) {
      Map.Entry entry = (Map.Entry) it.next();
      ZSpec spec = zspecFromMapEntry(entry);
      resset.add(spec);
    }
    return resset;
  }

  public ZSpec zspecFromMapEntry(Map.Entry entry) {
    Instr accept = (Instr) entry.getKey();
    Expr constraint = (Expr) entry.getValue();

    List subjectList = new LinkedList();
    ZExpr pattern = null;
    ZExpr negpattern = null;

    // theorem to prove
    {if ( (accept instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch328NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Instr )accept);{  tom.engine.adt.il.types.Instr  tomMatch328NameNumber_freshVar_2=tomMatch328NameNumberfreshSubject_1;if ( (tomMatch328NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.instr.accept) ) {{  aterm.ATerm  tomMatch328NameNumber_freshVar_0= tomMatch328NameNumber_freshVar_2.getPositive() ;{  aterm.ATerm  tomMatch328NameNumber_freshVar_1= tomMatch328NameNumber_freshVar_2.getNegative() ;if ( true ) {

        Constraint positivePattern = Constraint.fromTerm(tomMatch328NameNumber_freshVar_0);
        ConstraintList negativePatternList = ConstraintList.fromTerm(tomMatch328NameNumber_freshVar_1);
        // we need the substitution to generate the pattern part of the theorem
        SubstitutionList subsList = verifier.collectSubstitutionInConstraint(constraint);
        Map variableMap = ztermVariableMapFromSubstitutionList(subsList,
                                                               new HashMap());
        tomiltools.getZTermSubjectListFromConstraint(positivePattern,
                                                  subjectList,
                                                  variableMap);
        pattern = tomiltools.constraintToZExpr(positivePattern,variableMap);
        if (verifier.isCamlSemantics()) {
          negpattern = tomiltools.constraintToZExpr(negativePatternList,variableMap);
        }
      }}}}}}}}


    ZExpr zenonConstraint = zexprFromExpr(constraint);

    ZExpr theorem = null;
    if (pattern != null && zenonConstraint != null) {
      if(verifier.isCamlSemantics() && negpattern != null) {
        theorem =  tom.engine.adt.zenon.types.zexpr.zequiv.make( tom.engine.adt.zenon.types.zexpr.zand.make(pattern,  tom.engine.adt.zenon.types.zexpr.znot.make(negpattern) ) , zenonConstraint) ;
      } else {
        theorem =  tom.engine.adt.zenon.types.zexpr.zequiv.make(pattern, zenonConstraint) ;
      }
    }

    // now we have to to build the axiom list, starting from the
    // signature. Again, the TomIlTools will be useful, it has access
    // to TomSignature and Zenon signature

    // collects symbols in pattern
    Collection symbols = tomiltools.collectSymbols(pattern);
    // generates the axioms for this set of symbols
    ZAxiomList symbolsAxioms = tomiltools.symbolsDefinition(symbols);
    // generates axioms for all subterm operations
    ZAxiomList subtermAxioms = tomiltools.subtermsDefinition(symbols);

    Iterator iter = subjectList.iterator();
    while(iter.hasNext()) {
      ZTerm input = (ZTerm)iter.next();
      theorem =  tom.engine.adt.zenon.types.zexpr.zforall.make(input,  tom.engine.adt.zenon.types.ztype.ztype.make("T") , theorem) ;
    }
    ZSpec spec =  tom.engine.adt.zenon.types.zspec.zthm.make(theorem, tom_append_list_zby(symbolsAxioms,tom_append_list_zby(subtermAxioms, tom.engine.adt.zenon.types.zaxiomlist.Emptyzby.make() ))) ;

    return spec;
  }

  ZTerm ztermFromTerm(Term term) {
    {if ( (term instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch329NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Term )term);{  tom.engine.adt.il.types.Term  tomMatch329NameNumber_freshVar_1=tomMatch329NameNumberfreshSubject_1;if ( (tomMatch329NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch329NameNumber_freshVar_0= tomMatch329NameNumber_freshVar_1.getAbst() ;if ( true ) {

        return ztermFromAbsTerm(tomMatch329NameNumber_freshVar_0);
      }}}}}}if ( (term instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch329NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Term )term);{  tom.engine.adt.il.types.Term  tomMatch329NameNumber_freshVar_2=tomMatch329NameNumberfreshSubject_1;if ( (tomMatch329NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.term.repr) ) {if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm repr") ;
      }}}}}if ( (term instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch329NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Term )term);{  tom.engine.adt.il.types.Term  tomMatch329NameNumber_freshVar_3=tomMatch329NameNumberfreshSubject_1;if ( (tomMatch329NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.term.subterm) ) {if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm subterm") ;
      }}}}}if ( (term instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch329NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Term )term);{  tom.engine.adt.il.types.Term  tomMatch329NameNumber_freshVar_4=tomMatch329NameNumberfreshSubject_1;if ( (tomMatch329NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.term.slot) ) {if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm "+ term+" slot") ;
      }}}}}if ( (term instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch329NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Term )term);{  tom.engine.adt.il.types.Term  tomMatch329NameNumber_freshVar_5=tomMatch329NameNumberfreshSubject_1;if ( (tomMatch329NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.term.appSubsT) ) {if ( true ) {

        // probleme: la substitution devrait etre appliquee
        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm appsubsT ") ;
      }}}}}}

    return  tom.engine.adt.zenon.types.zterm.zvar.make("match vide dans ztermFromTerm") ;
  }

  ZExpr zexprFromExpr(Expr expr) {
    {if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_0=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.expr.iltrue) ) {if ( true ) {
 return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_1=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {if ( true ) {
 return  tom.engine.adt.zenon.types.zexpr.zfalse.make() ;}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_4=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.expr.tisfsym) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch330NameNumber_freshVar_2= tomMatch330NameNumber_freshVar_4.getAbst() ;{  tom.engine.adt.il.types.Symbol  tomMatch330NameNumber_freshVar_3= tomMatch330NameNumber_freshVar_4.getSymbol() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.zisfsym.make(ztermFromAbsTerm(tomMatch330NameNumber_freshVar_2), zsymbolFromSymbol(tomMatch330NameNumber_freshVar_3)) ;
      }}}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_7=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.expr.teq) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch330NameNumber_freshVar_5= tomMatch330NameNumber_freshVar_7.getLabst() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch330NameNumber_freshVar_6= tomMatch330NameNumber_freshVar_7.getRabst() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.zeq.make(ztermFromAbsTerm(tomMatch330NameNumber_freshVar_5), ztermFromAbsTerm(tomMatch330NameNumber_freshVar_6)) ;
      }}}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_8=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.expr.isfsym) ) {if ( true ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zisfsym.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zsymbol.zsymbol.make("isfsym") ) ;
      }}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_9=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_9 instanceof tom.engine.adt.il.types.expr.eq) ) {if ( true ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("eq") ) ;
      }}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_10=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.expr.appSubsE) ) {if ( true ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("appSubsE") ) ;
      }}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_13=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.expr.iland) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_11= tomMatch330NameNumber_freshVar_13.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_12= tomMatch330NameNumber_freshVar_13.getRight() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.zand.make(zexprFromExpr(tomMatch330NameNumber_freshVar_11), zexprFromExpr(tomMatch330NameNumber_freshVar_12)) ;
      }}}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_16=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_16 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_14= tomMatch330NameNumber_freshVar_16.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_15= tomMatch330NameNumber_freshVar_16.getRight() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.zor.make(zexprFromExpr(tomMatch330NameNumber_freshVar_14), zexprFromExpr(tomMatch330NameNumber_freshVar_15)) ;
      }}}}}}}if ( (expr instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Expr )expr);{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_18=tomMatch330NameNumberfreshSubject_1;if ( (tomMatch330NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch330NameNumber_freshVar_17= tomMatch330NameNumber_freshVar_18.getExp() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.znot.make(zexprFromExpr(tomMatch330NameNumber_freshVar_17)) ;
      }}}}}}}

    return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("end " + expr.toString()) ) ;
  }

  ZSymbol zsymbolFromSymbol(Symbol symb) {
    {if ( (symb instanceof tom.engine.adt.il.types.Symbol) ) {{  tom.engine.adt.il.types.Symbol  tomMatch331NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Symbol )symb);{  tom.engine.adt.il.types.Symbol  tomMatch331NameNumber_freshVar_1=tomMatch331NameNumberfreshSubject_1;if ( (tomMatch331NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.symbol.fsymbol) ) {{  String  tomMatch331NameNumber_freshVar_0= tomMatch331NameNumber_freshVar_1.getName() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zsymbol.zsymbol.make(tomMatch331NameNumber_freshVar_0) ;
      }}}}}}}

    return  tom.engine.adt.zenon.types.zsymbol.zsymbol.make("random") ;
  }

  ZExpr zexprFromSeq(Seq seq) {
    {if ( (seq instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch332NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Seq )seq);{  tom.engine.adt.il.types.Seq  tomMatch332NameNumber_freshVar_0=tomMatch332NameNumberfreshSubject_1;if ( (tomMatch332NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.seq.seq) ) {if ( true ) {

        return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;
      }}}}}if ( (seq instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch332NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Seq )seq);{  tom.engine.adt.il.types.Seq  tomMatch332NameNumber_freshVar_2=tomMatch332NameNumberfreshSubject_1;if ( (tomMatch332NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.seq.dedterm) ) {{  tom.engine.adt.il.types.TermList  tomMatch332NameNumber_freshVar_1= tomMatch332NameNumber_freshVar_2.getTerms() ;{  tom.engine.adt.il.types.TermList  tom_termlist=tomMatch332NameNumber_freshVar_1;if ( true ) {{if ( (tom_termlist instanceof tom.engine.adt.il.types.TermList) ) {{  tom.engine.adt.il.types.TermList  tomMatch333NameNumberfreshSubject_1=(( tom.engine.adt.il.types.TermList )tom_termlist);{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_freshVar_0=tomMatch333NameNumberfreshSubject_1;if ( ((tomMatch333NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.termlist.ConsconcTerm) || (tomMatch333NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.termlist.EmptyconcTerm)) ) {{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_begin_2=tomMatch333NameNumber_freshVar_0;{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_end_3=tomMatch333NameNumber_freshVar_0;do {{{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_freshVar_1=tomMatch333NameNumber_end_3;if (!( tomMatch333NameNumber_freshVar_1.isEmptyconcTerm() )) {{  tom.engine.adt.il.types.Term  tom_tl= tomMatch333NameNumber_freshVar_1.getHeadconcTerm() ;{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_freshVar_4= tomMatch333NameNumber_freshVar_1.getTailconcTerm() ;if (!( tomMatch333NameNumber_freshVar_4.isEmptyconcTerm() )) {{  tom.engine.adt.il.types.Term  tom_tr= tomMatch333NameNumber_freshVar_4.getHeadconcTerm() ;{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_freshVar_5= tomMatch333NameNumber_freshVar_4.getTailconcTerm() ;if ( tomMatch333NameNumber_freshVar_5.isEmptyconcTerm() ) {if ( true ) {



            return  tom.engine.adt.zenon.types.zexpr.zeq.make(ztermFromTerm(tom_tl), ztermFromTerm(tom_tr)) ;
          }}}}}}}}}if ( tomMatch333NameNumber_end_3.isEmptyconcTerm() ) {tomMatch333NameNumber_end_3=tomMatch333NameNumber_begin_2;} else {tomMatch333NameNumber_end_3= tomMatch333NameNumber_end_3.getTailconcTerm() ;}}} while(!( (tomMatch333NameNumber_end_3==tomMatch333NameNumber_begin_2) ));}}}}}}}

      }}}}}}}if ( (seq instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch332NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Seq )seq);{  tom.engine.adt.il.types.Seq  tomMatch332NameNumber_freshVar_4=tomMatch332NameNumberfreshSubject_1;if ( (tomMatch332NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.seq.dedexpr) ) {{  tom.engine.adt.il.types.ExprList  tomMatch332NameNumber_freshVar_3= tomMatch332NameNumber_freshVar_4.getExprs() ;{  tom.engine.adt.il.types.ExprList  tom_exprlist=tomMatch332NameNumber_freshVar_3;if ( true ) {{if ( (tom_exprlist instanceof tom.engine.adt.il.types.ExprList) ) {{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumberfreshSubject_1=(( tom.engine.adt.il.types.ExprList )tom_exprlist);{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_freshVar_0=tomMatch334NameNumberfreshSubject_1;if ( ((tomMatch334NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.exprlist.ConsconcExpr) || (tomMatch334NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.exprlist.EmptyconcExpr)) ) {{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_begin_2=tomMatch334NameNumber_freshVar_0;{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_end_3=tomMatch334NameNumber_freshVar_0;do {{{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_freshVar_1=tomMatch334NameNumber_end_3;if (!( tomMatch334NameNumber_freshVar_1.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tom_t= tomMatch334NameNumber_freshVar_1.getHeadconcExpr() ;{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_freshVar_4= tomMatch334NameNumber_freshVar_1.getTailconcExpr() ;if (!( tomMatch334NameNumber_freshVar_4.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tomMatch334NameNumber_freshVar_6= tomMatch334NameNumber_freshVar_4.getHeadconcExpr() ;if ( (tomMatch334NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.expr.iltrue) ) {{  tom.engine.adt.il.types.ExprList  tomMatch334NameNumber_freshVar_5= tomMatch334NameNumber_freshVar_4.getTailconcExpr() ;if ( tomMatch334NameNumber_freshVar_5.isEmptyconcExpr() ) {if ( true ) {



            return zexprFromExpr(tom_t);
          }}}}}}}}}}if ( tomMatch334NameNumber_end_3.isEmptyconcExpr() ) {tomMatch334NameNumber_end_3=tomMatch334NameNumber_begin_2;} else {tomMatch334NameNumber_end_3= tomMatch334NameNumber_end_3.getTailconcExpr() ;}}} while(!( (tomMatch334NameNumber_end_3==tomMatch334NameNumber_begin_2) ));}}}}}}}

      }}}}}}}if ( (seq instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch332NameNumberfreshSubject_1=(( tom.engine.adt.il.types.Seq )seq);{  tom.engine.adt.il.types.Seq  tomMatch332NameNumber_freshVar_6=tomMatch332NameNumberfreshSubject_1;if ( (tomMatch332NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.seq.dedexpr) ) {{  tom.engine.adt.il.types.ExprList  tomMatch332NameNumber_freshVar_5= tomMatch332NameNumber_freshVar_6.getExprs() ;{  tom.engine.adt.il.types.ExprList  tom_exprlist=tomMatch332NameNumber_freshVar_5;if ( true ) {{if ( (tom_exprlist instanceof tom.engine.adt.il.types.ExprList) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumberfreshSubject_1=(( tom.engine.adt.il.types.ExprList )tom_exprlist);{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_0=tomMatch335NameNumberfreshSubject_1;if ( ((tomMatch335NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.exprlist.ConsconcExpr) || (tomMatch335NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.exprlist.EmptyconcExpr)) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_begin_2=tomMatch335NameNumber_freshVar_0;{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_end_3=tomMatch335NameNumber_freshVar_0;do {{{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_1=tomMatch335NameNumber_end_3;if (!( tomMatch335NameNumber_freshVar_1.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tom_t= tomMatch335NameNumber_freshVar_1.getHeadconcExpr() ;{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_4= tomMatch335NameNumber_freshVar_1.getTailconcExpr() ;if (!( tomMatch335NameNumber_freshVar_4.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tomMatch335NameNumber_freshVar_6= tomMatch335NameNumber_freshVar_4.getHeadconcExpr() ;if ( (tomMatch335NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_5= tomMatch335NameNumber_freshVar_4.getTailconcExpr() ;if ( tomMatch335NameNumber_freshVar_5.isEmptyconcExpr() ) {if ( true ) {



            return  tom.engine.adt.zenon.types.zexpr.znot.make(zexprFromExpr(tom_t)) ;
          }}}}}}}}}}if ( tomMatch335NameNumber_end_3.isEmptyconcExpr() ) {tomMatch335NameNumber_end_3=tomMatch335NameNumber_begin_2;} else {tomMatch335NameNumber_end_3= tomMatch335NameNumber_end_3.getTailconcExpr() ;}}} while(!( (tomMatch335NameNumber_end_3==tomMatch335NameNumber_begin_2) ));}}}}}}}

      }}}}}}}}

    return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;
  }

  ZTerm ztermFromAbsTerm(AbsTerm absterm) {
    {if ( (absterm instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumberfreshSubject_1=(( tom.engine.adt.il.types.AbsTerm )absterm);{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumber_freshVar_1=tomMatch336NameNumberfreshSubject_1;if ( (tomMatch336NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.absterm.absvar) ) {{  tom.engine.adt.il.types.Variable  tomMatch336NameNumber_freshVar_0= tomMatch336NameNumber_freshVar_1.getVarname() ;{  tom.engine.adt.il.types.Variable  tomMatch336NameNumber_freshVar_3=tomMatch336NameNumber_freshVar_0;if ( (tomMatch336NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.variable.var) ) {{  String  tomMatch336NameNumber_freshVar_2= tomMatch336NameNumber_freshVar_3.getName() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make(tomMatch336NameNumber_freshVar_2) ;
      }}}}}}}}}if ( (absterm instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumberfreshSubject_1=(( tom.engine.adt.il.types.AbsTerm )absterm);{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumber_freshVar_7=tomMatch336NameNumberfreshSubject_1;if ( (tomMatch336NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.absterm.st) ) {{  tom.engine.adt.il.types.Symbol  tomMatch336NameNumber_freshVar_4= tomMatch336NameNumber_freshVar_7.getSymbol() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumber_freshVar_5= tomMatch336NameNumber_freshVar_7.getAbst() ;{  int  tomMatch336NameNumber_freshVar_6= tomMatch336NameNumber_freshVar_7.getIndex() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zst.make(ztermFromAbsTerm(tomMatch336NameNumber_freshVar_5), tomMatch336NameNumber_freshVar_6) ;
      }}}}}}}}if ( (absterm instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumberfreshSubject_1=(( tom.engine.adt.il.types.AbsTerm )absterm);{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumber_freshVar_11=tomMatch336NameNumberfreshSubject_1;if ( (tomMatch336NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.absterm.sl) ) {{  tom.engine.adt.il.types.Symbol  tomMatch336NameNumber_freshVar_8= tomMatch336NameNumber_freshVar_11.getSymbol() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch336NameNumber_freshVar_9= tomMatch336NameNumber_freshVar_11.getAbst() ;{  String  tomMatch336NameNumber_freshVar_10= tomMatch336NameNumber_freshVar_11.getName() ;if ( true ) {

        return  tom.engine.adt.zenon.types.zterm.zsl.make(ztermFromAbsTerm(tomMatch336NameNumber_freshVar_9), tomMatch336NameNumber_freshVar_10) ;
      }}}}}}}}}

    return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromAbsTerm") ;
  }

  private Map ztermVariableMapFromSubstitutionList(SubstitutionList sublist, Map map) {
    {if ( (sublist instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumberfreshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )sublist);{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumber_freshVar_0=tomMatch337NameNumberfreshSubject_1;if ( ((tomMatch337NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch337NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if ( tomMatch337NameNumber_freshVar_0.isEmptysubs() ) {if ( true ) {
 return map; }}}}}}if ( (sublist instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumberfreshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )sublist);{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumber_freshVar_1=tomMatch337NameNumberfreshSubject_1;if ( ((tomMatch337NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch337NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch337NameNumber_freshVar_1.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch337NameNumber_freshVar_4= tomMatch337NameNumber_freshVar_1.getHeadsubs() ;if ( (tomMatch337NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumber_freshVar_2= tomMatch337NameNumber_freshVar_1.getTailsubs() ;if ( true ) {

        return ztermVariableMapFromSubstitutionList(tomMatch337NameNumber_freshVar_2,map);
      }}}}}}}}}if ( (sublist instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumberfreshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )sublist);{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumber_freshVar_5=tomMatch337NameNumberfreshSubject_1;if ( ((tomMatch337NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch337NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch337NameNumber_freshVar_5.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch337NameNumber_freshVar_10= tomMatch337NameNumber_freshVar_5.getHeadsubs() ;if ( (tomMatch337NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.substitution.is) ) {{  tom.engine.adt.il.types.Variable  tomMatch337NameNumber_freshVar_8= tomMatch337NameNumber_freshVar_10.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch337NameNumber_freshVar_9= tomMatch337NameNumber_freshVar_10.getTerm() ;{  tom.engine.adt.il.types.Variable  tomMatch337NameNumber_freshVar_12=tomMatch337NameNumber_freshVar_8;if ( (tomMatch337NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.variable.var) ) {{  String  tomMatch337NameNumber_freshVar_11= tomMatch337NameNumber_freshVar_12.getName() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch337NameNumber_freshVar_6= tomMatch337NameNumber_freshVar_5.getTailsubs() ;if ( true ) {

        map.put(tomMatch337NameNumber_freshVar_11,ztermFromTerm(tomMatch337NameNumber_freshVar_9));
        return ztermVariableMapFromSubstitutionList(tomMatch337NameNumber_freshVar_6,map);
      }}}}}}}}}}}}}}}

    throw new TomRuntimeException(
        "verifier: strange substitution list: " + sublist);
  }
}

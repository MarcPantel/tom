/* Generated by TOM (version 2.6): Do not edit this file *//*
 *
 * TOM - To One Matching Compiler
 *
 * Copyright (c) 2000-2008, INRIA
 * Nancy, France.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 * Pierre-Etienne Moreau  e-mail: Pierre-Etienne.Moreau@loria.fr
 * Antoine Reilles        e-mail: Antoine.Reilles@loria.fr
 *
 **/

package tom.engine.verifier;

import tom.engine.*;
import aterm.*;
import aterm.pure.*;
import java.util.*;

import tom.engine.adt.tomconstraint.types.*;
import tom.engine.adt.tomdeclaration.types.*;
import tom.engine.adt.tomexpression.types.*;
import tom.engine.adt.tominstruction.types.*;
import tom.engine.adt.tomname.types.*;
import tom.engine.adt.tomoption.types.*;
import tom.engine.adt.tomsignature.types.*;
import tom.engine.adt.tomterm.types.*;
import tom.engine.adt.tomslot.types.*;
import tom.engine.adt.tomtype.types.*;

import tom.engine.adt.il.*;
import tom.engine.adt.il.types.*;
import tom.engine.adt.zenon.*;
import tom.engine.adt.zenon.types.*;

import tom.engine.exception.TomRuntimeException;


public class ZenonOutput {

  // ------------------------------------------------------------
  /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */  /* Generated by TOM (version 2.6): Do not edit this file */ /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */     public static   tom.engine.adt.il.types.ExprList  tom_append_list_concExpr( tom.engine.adt.il.types.ExprList l1,  tom.engine.adt.il.types.ExprList  l2) {     if( l1.isEmptyconcExpr() ) {       return l2;     } else if( l2.isEmptyconcExpr() ) {       return l1;     } else if(  l1.getTailconcExpr() .isEmptyconcExpr() ) {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,l2) ;     } else {       return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( l1.getHeadconcExpr() ,tom_append_list_concExpr( l1.getTailconcExpr() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.ExprList  tom_get_slice_concExpr( tom.engine.adt.il.types.ExprList  begin,  tom.engine.adt.il.types.ExprList  end, tom.engine.adt.il.types.ExprList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcExpr()  ||  (end== tom.engine.adt.il.types.exprlist.EmptyconcExpr.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.exprlist.ConsconcExpr.make( begin.getHeadconcExpr() ,( tom.engine.adt.il.types.ExprList )tom_get_slice_concExpr( begin.getTailconcExpr() ,end,tail)) ;   }      public static   tom.engine.adt.il.types.SubstitutionList  tom_append_list_subs( tom.engine.adt.il.types.SubstitutionList l1,  tom.engine.adt.il.types.SubstitutionList  l2) {     if( l1.isEmptysubs() ) {       return l2;     } else if( l2.isEmptysubs() ) {       return l1;     } else if(  l1.getTailsubs() .isEmptysubs() ) {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,l2) ;     } else {       return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( l1.getHeadsubs() ,tom_append_list_subs( l1.getTailsubs() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.SubstitutionList  tom_get_slice_subs( tom.engine.adt.il.types.SubstitutionList  begin,  tom.engine.adt.il.types.SubstitutionList  end, tom.engine.adt.il.types.SubstitutionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptysubs()  ||  (end== tom.engine.adt.il.types.substitutionlist.Emptysubs.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.substitutionlist.Conssubs.make( begin.getHeadsubs() ,( tom.engine.adt.il.types.SubstitutionList )tom_get_slice_subs( begin.getTailsubs() ,end,tail)) ;   }      public static   tom.engine.adt.il.types.TermList  tom_append_list_concTerm( tom.engine.adt.il.types.TermList l1,  tom.engine.adt.il.types.TermList  l2) {     if( l1.isEmptyconcTerm() ) {       return l2;     } else if( l2.isEmptyconcTerm() ) {       return l1;     } else if(  l1.getTailconcTerm() .isEmptyconcTerm() ) {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,l2) ;     } else {       return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( l1.getHeadconcTerm() ,tom_append_list_concTerm( l1.getTailconcTerm() ,l2)) ;     }   }   public static   tom.engine.adt.il.types.TermList  tom_get_slice_concTerm( tom.engine.adt.il.types.TermList  begin,  tom.engine.adt.il.types.TermList  end, tom.engine.adt.il.types.TermList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcTerm()  ||  (end== tom.engine.adt.il.types.termlist.EmptyconcTerm.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.il.types.termlist.ConsconcTerm.make( begin.getHeadconcTerm() ,( tom.engine.adt.il.types.TermList )tom_get_slice_concTerm( begin.getTailconcTerm() ,end,tail)) ;   }    /* Generated by TOM (version 2.6): Do not edit this file */   public static   tom.engine.adt.zenon.types.ZAxiomList  tom_append_list_zby( tom.engine.adt.zenon.types.ZAxiomList l1,  tom.engine.adt.zenon.types.ZAxiomList  l2) {     if( l1.isEmptyzby() ) {       return l2;     } else if( l2.isEmptyzby() ) {       return l1;     } else if(  l1.getTailzby() .isEmptyzby() ) {       return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( l1.getHeadzby() ,l2) ;     } else {       return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( l1.getHeadzby() ,tom_append_list_zby( l1.getTailzby() ,l2)) ;     }   }   public static   tom.engine.adt.zenon.types.ZAxiomList  tom_get_slice_zby( tom.engine.adt.zenon.types.ZAxiomList  begin,  tom.engine.adt.zenon.types.ZAxiomList  end, tom.engine.adt.zenon.types.ZAxiomList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyzby()  ||  (end== tom.engine.adt.zenon.types.zaxiomlist.Emptyzby.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.engine.adt.zenon.types.zaxiomlist.Conszby.make( begin.getHeadzby() ,( tom.engine.adt.zenon.types.ZAxiomList )tom_get_slice_zby( begin.getTailzby() ,end,tail)) ;   }    






  // ------------------------------------------------------------

  private Verifier verifier;
  private TomIlTools tomiltools;

  public ZenonOutput(Verifier verifier) {
    this.verifier = verifier;
    this.tomiltools = new TomIlTools(verifier);
  }

  public Collection zspecSetFromConstraintMap(Map constraintMap) {
    Collection resset = new HashSet();
    Iterator it = constraintMap.entrySet().iterator();
    while(it.hasNext()) {
      Map.Entry entry = (Map.Entry) it.next();
      ZSpec spec = zspecFromMapEntry(entry);
      resset.add(spec);
    }
    return resset;
  }

  public ZSpec zspecFromMapEntry(Map.Entry entry) {
    Instr accept = (Instr) entry.getKey();
    Expr constraint = (Expr) entry.getValue();

    List subjectList = new LinkedList();
    ZExpr pattern = null;
    ZExpr negpattern = null;

    // theorem to prove
    {{ Object tomMatch329NameNumber_freshVar_0=accept;if ( (tomMatch329NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Instr) ) {{  tom.engine.adt.il.types.Instr  tomMatch329NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Instr )tomMatch329NameNumber_freshVar_0);{  tom.engine.adt.il.types.Instr  tomMatch329NameNumber_freshVar_3=tomMatch329NameNumber_freshSubject_1;if ( (tomMatch329NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.instr.accept) ) {{  aterm.ATerm  tomMatch329NameNumber_freshVar_1= tomMatch329NameNumber_freshVar_3.getPositive() ;{  aterm.ATerm  tomMatch329NameNumber_freshVar_2= tomMatch329NameNumber_freshVar_3.getNegative() ;

        Constraint positivePattern = Constraint.fromTerm(tomMatch329NameNumber_freshVar_1);
        ConstraintList negativePatternList = ConstraintList.fromTerm(tomMatch329NameNumber_freshVar_2);
        // we need the substitution to generate the pattern part of the theorem
        SubstitutionList subsList = verifier.collectSubstitutionInConstraint(constraint);
        Map variableMap = ztermVariableMapFromSubstitutionList(subsList,
                                                               new HashMap());
        tomiltools.getZTermSubjectListFromConstraint(positivePattern,
                                                  subjectList,
                                                  variableMap);
        pattern = tomiltools.constraintToZExpr(positivePattern,variableMap);
        if (verifier.isCamlSemantics()) {
          negpattern = tomiltools.constraintToZExpr(negativePatternList,variableMap);
        }
      }}}}}}}}


    ZExpr zenonConstraint = zexprFromExpr(constraint);

    ZExpr theorem = null;
    if (pattern != null && zenonConstraint != null) {
      if(verifier.isCamlSemantics() && negpattern != null) {
        theorem =  tom.engine.adt.zenon.types.zexpr.zequiv.make( tom.engine.adt.zenon.types.zexpr.zand.make(pattern,  tom.engine.adt.zenon.types.zexpr.znot.make(negpattern) ) , zenonConstraint) ;
      } else {
        theorem =  tom.engine.adt.zenon.types.zexpr.zequiv.make(pattern, zenonConstraint) ;
      }
    }

    // now we have to to build the axiom list, starting from the
    // signature. Again, the TomIlTools will be useful, it has access
    // to TomSignature and Zenon signature

    // collects symbols in pattern
    Collection symbols = tomiltools.collectSymbols(pattern);
    // generates the axioms for this set of symbols
    ZAxiomList symbolsAxioms = tomiltools.symbolsDefinition(symbols);
    // generates axioms for all subterm operations
    ZAxiomList subtermAxioms = tomiltools.subtermsDefinition(symbols);

    Iterator iter = subjectList.iterator();
    while(iter.hasNext()) {
      ZTerm input = (ZTerm)iter.next();
      theorem =  tom.engine.adt.zenon.types.zexpr.zforall.make(input,  tom.engine.adt.zenon.types.ztype.ztype.make("T") , theorem) ;
    }
    ZSpec spec =  tom.engine.adt.zenon.types.zspec.zthm.make(theorem, tom_append_list_zby(symbolsAxioms,tom_append_list_zby(subtermAxioms, tom.engine.adt.zenon.types.zaxiomlist.Emptyzby.make() ))) ;

    return spec;
  }

  ZTerm ztermFromTerm(Term term) {
    {{ Object tomMatch330NameNumber_freshVar_0=term;if ( (tomMatch330NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch330NameNumber_freshVar_0);{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshVar_2=tomMatch330NameNumber_freshSubject_1;if ( (tomMatch330NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.term.tau) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch330NameNumber_freshVar_1= tomMatch330NameNumber_freshVar_2.getAbst() ;

        return ztermFromAbsTerm(tomMatch330NameNumber_freshVar_1);
      }}}}}}{ Object tomMatch330NameNumber_freshVar_3=term;if ( (tomMatch330NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch330NameNumber_freshVar_3);{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshVar_4=tomMatch330NameNumber_freshSubject_1;if ( (tomMatch330NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.term.repr) ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm repr") ;
      }}}}}{ Object tomMatch330NameNumber_freshVar_5=term;if ( (tomMatch330NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch330NameNumber_freshVar_5);{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshVar_6=tomMatch330NameNumber_freshSubject_1;if ( (tomMatch330NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.term.subterm) ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm subterm") ;
      }}}}}{ Object tomMatch330NameNumber_freshVar_7=term;if ( (tomMatch330NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch330NameNumber_freshVar_7);{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshVar_8=tomMatch330NameNumber_freshSubject_1;if ( (tomMatch330NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.term.slot) ) {

        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm "+ term+" slot") ;
      }}}}}{ Object tomMatch330NameNumber_freshVar_9=term;if ( (tomMatch330NameNumber_freshVar_9 instanceof tom.engine.adt.il.types.Term) ) {{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Term )tomMatch330NameNumber_freshVar_9);{  tom.engine.adt.il.types.Term  tomMatch330NameNumber_freshVar_10=tomMatch330NameNumber_freshSubject_1;if ( (tomMatch330NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.term.appSubsT) ) {

        // probleme: la substitution devrait etre appliquee
        return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromTerm appsubsT ") ;
      }}}}}}

    return  tom.engine.adt.zenon.types.zterm.zvar.make("match vide dans ztermFromTerm") ;
  }

  ZExpr zexprFromExpr(Expr expr) {
    {{ Object tomMatch331NameNumber_freshVar_0=expr;if ( (tomMatch331NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_0);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_1=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.expr.iltrue) ) {
 return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;}}}}}{ Object tomMatch331NameNumber_freshVar_2=expr;if ( (tomMatch331NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_2);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_3=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {
 return  tom.engine.adt.zenon.types.zexpr.zfalse.make() ;}}}}}{ Object tomMatch331NameNumber_freshVar_4=expr;if ( (tomMatch331NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_4);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_7=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.expr.tisfsym) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch331NameNumber_freshVar_5= tomMatch331NameNumber_freshVar_7.getAbst() ;{  tom.engine.adt.il.types.Symbol  tomMatch331NameNumber_freshVar_6= tomMatch331NameNumber_freshVar_7.getSymbol() ;

        return  tom.engine.adt.zenon.types.zexpr.zisfsym.make(ztermFromAbsTerm(tomMatch331NameNumber_freshVar_5), zsymbolFromSymbol(tomMatch331NameNumber_freshVar_6)) ;
      }}}}}}}{ Object tomMatch331NameNumber_freshVar_8=expr;if ( (tomMatch331NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_8);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_11=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_11 instanceof tom.engine.adt.il.types.expr.teq) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch331NameNumber_freshVar_9= tomMatch331NameNumber_freshVar_11.getLabst() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch331NameNumber_freshVar_10= tomMatch331NameNumber_freshVar_11.getRabst() ;

        return  tom.engine.adt.zenon.types.zexpr.zeq.make(ztermFromAbsTerm(tomMatch331NameNumber_freshVar_9), ztermFromAbsTerm(tomMatch331NameNumber_freshVar_10)) ;
      }}}}}}}{ Object tomMatch331NameNumber_freshVar_12=expr;if ( (tomMatch331NameNumber_freshVar_12 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_12);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_13=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.expr.isfsym) ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zisfsym.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zsymbol.zsymbol.make("isfsym") ) ;
      }}}}}{ Object tomMatch331NameNumber_freshVar_14=expr;if ( (tomMatch331NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_14);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_15=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.expr.eq) ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("eq") ) ;
      }}}}}{ Object tomMatch331NameNumber_freshVar_16=expr;if ( (tomMatch331NameNumber_freshVar_16 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_16);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_17=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_17 instanceof tom.engine.adt.il.types.expr.appSubsE) ) {

        // this should not occur
        return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("appSubsE") ) ;
      }}}}}{ Object tomMatch331NameNumber_freshVar_18=expr;if ( (tomMatch331NameNumber_freshVar_18 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_18);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_21=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_21 instanceof tom.engine.adt.il.types.expr.iland) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_19= tomMatch331NameNumber_freshVar_21.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_20= tomMatch331NameNumber_freshVar_21.getRight() ;

        return  tom.engine.adt.zenon.types.zexpr.zand.make(zexprFromExpr(tomMatch331NameNumber_freshVar_19), zexprFromExpr(tomMatch331NameNumber_freshVar_20)) ;
      }}}}}}}{ Object tomMatch331NameNumber_freshVar_22=expr;if ( (tomMatch331NameNumber_freshVar_22 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_22);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_25=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_25 instanceof tom.engine.adt.il.types.expr.ilor) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_23= tomMatch331NameNumber_freshVar_25.getLeft() ;{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_24= tomMatch331NameNumber_freshVar_25.getRight() ;

        return  tom.engine.adt.zenon.types.zexpr.zor.make(zexprFromExpr(tomMatch331NameNumber_freshVar_23), zexprFromExpr(tomMatch331NameNumber_freshVar_24)) ;
      }}}}}}}{ Object tomMatch331NameNumber_freshVar_26=expr;if ( (tomMatch331NameNumber_freshVar_26 instanceof tom.engine.adt.il.types.Expr) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Expr )tomMatch331NameNumber_freshVar_26);{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_28=tomMatch331NameNumber_freshSubject_1;if ( (tomMatch331NameNumber_freshVar_28 instanceof tom.engine.adt.il.types.expr.ilnot) ) {{  tom.engine.adt.il.types.Expr  tomMatch331NameNumber_freshVar_27= tomMatch331NameNumber_freshVar_28.getExp() ;

        return  tom.engine.adt.zenon.types.zexpr.znot.make(zexprFromExpr(tomMatch331NameNumber_freshVar_27)) ;
      }}}}}}}

    return  tom.engine.adt.zenon.types.zexpr.zeq.make( tom.engine.adt.zenon.types.zterm.zvar.make("Error in zexprFromExpr") ,  tom.engine.adt.zenon.types.zterm.zvar.make("end " + expr.toString()) ) ;
  }

  ZSymbol zsymbolFromSymbol(Symbol symb) {
    {{ Object tomMatch332NameNumber_freshVar_0=symb;if ( (tomMatch332NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Symbol) ) {{  tom.engine.adt.il.types.Symbol  tomMatch332NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Symbol )tomMatch332NameNumber_freshVar_0);{  tom.engine.adt.il.types.Symbol  tomMatch332NameNumber_freshVar_2=tomMatch332NameNumber_freshSubject_1;if ( (tomMatch332NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.symbol.fsymbol) ) {{  String  tomMatch332NameNumber_freshVar_1= tomMatch332NameNumber_freshVar_2.getName() ;

        return  tom.engine.adt.zenon.types.zsymbol.zsymbol.make(tomMatch332NameNumber_freshVar_1) ;
      }}}}}}}

    return  tom.engine.adt.zenon.types.zsymbol.zsymbol.make("random") ;
  }

  ZExpr zexprFromSeq(Seq seq) {
    {{ Object tomMatch333NameNumber_freshVar_0=seq;if ( (tomMatch333NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch333NameNumber_freshVar_0);{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshVar_1=tomMatch333NameNumber_freshSubject_1;if ( (tomMatch333NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.seq.seq) ) {

        return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;
      }}}}}{ Object tomMatch333NameNumber_freshVar_2=seq;if ( (tomMatch333NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch333NameNumber_freshVar_2);{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshVar_4=tomMatch333NameNumber_freshSubject_1;if ( (tomMatch333NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.seq.dedterm) ) {{  tom.engine.adt.il.types.TermList  tomMatch333NameNumber_freshVar_3= tomMatch333NameNumber_freshVar_4.getTerms() ;{{ Object tomMatch334NameNumber_freshVar_0=tomMatch333NameNumber_freshVar_3;if ( (tomMatch334NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.TermList) ) {{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_freshSubject_1=(( tom.engine.adt.il.types.TermList )tomMatch334NameNumber_freshVar_0);{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_freshVar_1=tomMatch334NameNumber_freshSubject_1;if ( ((tomMatch334NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.termlist.ConsconcTerm) || (tomMatch334NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.termlist.EmptyconcTerm)) ) {{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_begin_3=tomMatch334NameNumber_freshVar_1;{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_end_4=tomMatch334NameNumber_freshVar_1;do {{{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_freshVar_2=tomMatch334NameNumber_end_4;if (!( tomMatch334NameNumber_freshVar_2.isEmptyconcTerm() )) {{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_freshVar_5= tomMatch334NameNumber_freshVar_2.getTailconcTerm() ;if (!( tomMatch334NameNumber_freshVar_5.isEmptyconcTerm() )) {{  tom.engine.adt.il.types.TermList  tomMatch334NameNumber_freshVar_6= tomMatch334NameNumber_freshVar_5.getTailconcTerm() ;if ( tomMatch334NameNumber_freshVar_6.isEmptyconcTerm() ) {



            return  tom.engine.adt.zenon.types.zexpr.zeq.make(ztermFromTerm( tomMatch334NameNumber_freshVar_2.getHeadconcTerm() ), ztermFromTerm( tomMatch334NameNumber_freshVar_5.getHeadconcTerm() )) ;
          }}}}}}if ( tomMatch334NameNumber_end_4.isEmptyconcTerm() ) {tomMatch334NameNumber_end_4=tomMatch334NameNumber_begin_3;} else {tomMatch334NameNumber_end_4= tomMatch334NameNumber_end_4.getTailconcTerm() ;}}} while(!( (tomMatch334NameNumber_end_4==tomMatch334NameNumber_begin_3) ));}}}}}}}}

      }}}}}}{ Object tomMatch333NameNumber_freshVar_5=seq;if ( (tomMatch333NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch333NameNumber_freshVar_5);{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshVar_7=tomMatch333NameNumber_freshSubject_1;if ( (tomMatch333NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.seq.dedexpr) ) {{  tom.engine.adt.il.types.ExprList  tomMatch333NameNumber_freshVar_6= tomMatch333NameNumber_freshVar_7.getExprs() ;{{ Object tomMatch335NameNumber_freshVar_0=tomMatch333NameNumber_freshVar_6;if ( (tomMatch335NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.ExprList) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshSubject_1=(( tom.engine.adt.il.types.ExprList )tomMatch335NameNumber_freshVar_0);{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_1=tomMatch335NameNumber_freshSubject_1;if ( ((tomMatch335NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.ConsconcExpr) || (tomMatch335NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.EmptyconcExpr)) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_begin_3=tomMatch335NameNumber_freshVar_1;{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_end_4=tomMatch335NameNumber_freshVar_1;do {{{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_2=tomMatch335NameNumber_end_4;if (!( tomMatch335NameNumber_freshVar_2.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_5= tomMatch335NameNumber_freshVar_2.getTailconcExpr() ;if (!( tomMatch335NameNumber_freshVar_5.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tomMatch335NameNumber_freshVar_7= tomMatch335NameNumber_freshVar_5.getHeadconcExpr() ;if ( (tomMatch335NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.expr.iltrue) ) {{  tom.engine.adt.il.types.ExprList  tomMatch335NameNumber_freshVar_6= tomMatch335NameNumber_freshVar_5.getTailconcExpr() ;if ( tomMatch335NameNumber_freshVar_6.isEmptyconcExpr() ) {



            return zexprFromExpr( tomMatch335NameNumber_freshVar_2.getHeadconcExpr() );
          }}}}}}}}if ( tomMatch335NameNumber_end_4.isEmptyconcExpr() ) {tomMatch335NameNumber_end_4=tomMatch335NameNumber_begin_3;} else {tomMatch335NameNumber_end_4= tomMatch335NameNumber_end_4.getTailconcExpr() ;}}} while(!( (tomMatch335NameNumber_end_4==tomMatch335NameNumber_begin_3) ));}}}}}}}}

      }}}}}}{ Object tomMatch333NameNumber_freshVar_8=seq;if ( (tomMatch333NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.Seq) ) {{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshSubject_1=(( tom.engine.adt.il.types.Seq )tomMatch333NameNumber_freshVar_8);{  tom.engine.adt.il.types.Seq  tomMatch333NameNumber_freshVar_10=tomMatch333NameNumber_freshSubject_1;if ( (tomMatch333NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.seq.dedexpr) ) {{  tom.engine.adt.il.types.ExprList  tomMatch333NameNumber_freshVar_9= tomMatch333NameNumber_freshVar_10.getExprs() ;{{ Object tomMatch336NameNumber_freshVar_0=tomMatch333NameNumber_freshVar_9;if ( (tomMatch336NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.ExprList) ) {{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_freshSubject_1=(( tom.engine.adt.il.types.ExprList )tomMatch336NameNumber_freshVar_0);{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_freshVar_1=tomMatch336NameNumber_freshSubject_1;if ( ((tomMatch336NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.ConsconcExpr) || (tomMatch336NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.exprlist.EmptyconcExpr)) ) {{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_begin_3=tomMatch336NameNumber_freshVar_1;{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_end_4=tomMatch336NameNumber_freshVar_1;do {{{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_freshVar_2=tomMatch336NameNumber_end_4;if (!( tomMatch336NameNumber_freshVar_2.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_freshVar_5= tomMatch336NameNumber_freshVar_2.getTailconcExpr() ;if (!( tomMatch336NameNumber_freshVar_5.isEmptyconcExpr() )) {{  tom.engine.adt.il.types.Expr  tomMatch336NameNumber_freshVar_7= tomMatch336NameNumber_freshVar_5.getHeadconcExpr() ;if ( (tomMatch336NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.expr.ilfalse) ) {{  tom.engine.adt.il.types.ExprList  tomMatch336NameNumber_freshVar_6= tomMatch336NameNumber_freshVar_5.getTailconcExpr() ;if ( tomMatch336NameNumber_freshVar_6.isEmptyconcExpr() ) {



            return  tom.engine.adt.zenon.types.zexpr.znot.make(zexprFromExpr( tomMatch336NameNumber_freshVar_2.getHeadconcExpr() )) ;
          }}}}}}}}if ( tomMatch336NameNumber_end_4.isEmptyconcExpr() ) {tomMatch336NameNumber_end_4=tomMatch336NameNumber_begin_3;} else {tomMatch336NameNumber_end_4= tomMatch336NameNumber_end_4.getTailconcExpr() ;}}} while(!( (tomMatch336NameNumber_end_4==tomMatch336NameNumber_begin_3) ));}}}}}}}}

      }}}}}}}

    return  tom.engine.adt.zenon.types.zexpr.ztrue.make() ;
  }

  ZTerm ztermFromAbsTerm(AbsTerm absterm) {
    {{ Object tomMatch337NameNumber_freshVar_0=absterm;if ( (tomMatch337NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshSubject_1=(( tom.engine.adt.il.types.AbsTerm )tomMatch337NameNumber_freshVar_0);{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshVar_2=tomMatch337NameNumber_freshSubject_1;if ( (tomMatch337NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.absterm.absvar) ) {{  tom.engine.adt.il.types.Variable  tomMatch337NameNumber_freshVar_1= tomMatch337NameNumber_freshVar_2.getVarname() ;{  tom.engine.adt.il.types.Variable  tomMatch337NameNumber_freshVar_4=tomMatch337NameNumber_freshVar_1;if ( (tomMatch337NameNumber_freshVar_4 instanceof tom.engine.adt.il.types.variable.var) ) {{  String  tomMatch337NameNumber_freshVar_3= tomMatch337NameNumber_freshVar_4.getName() ;

        return  tom.engine.adt.zenon.types.zterm.zvar.make(tomMatch337NameNumber_freshVar_3) ;
      }}}}}}}}}{ Object tomMatch337NameNumber_freshVar_5=absterm;if ( (tomMatch337NameNumber_freshVar_5 instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshSubject_1=(( tom.engine.adt.il.types.AbsTerm )tomMatch337NameNumber_freshVar_5);{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshVar_9=tomMatch337NameNumber_freshSubject_1;if ( (tomMatch337NameNumber_freshVar_9 instanceof tom.engine.adt.il.types.absterm.st) ) {{  tom.engine.adt.il.types.Symbol  tomMatch337NameNumber_freshVar_6= tomMatch337NameNumber_freshVar_9.getSymbol() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshVar_7= tomMatch337NameNumber_freshVar_9.getAbst() ;{  int  tomMatch337NameNumber_freshVar_8= tomMatch337NameNumber_freshVar_9.getIndex() ;

        return  tom.engine.adt.zenon.types.zterm.zst.make(ztermFromAbsTerm(tomMatch337NameNumber_freshVar_7), tomMatch337NameNumber_freshVar_8) ;
      }}}}}}}}{ Object tomMatch337NameNumber_freshVar_10=absterm;if ( (tomMatch337NameNumber_freshVar_10 instanceof tom.engine.adt.il.types.AbsTerm) ) {{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshSubject_1=(( tom.engine.adt.il.types.AbsTerm )tomMatch337NameNumber_freshVar_10);{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshVar_14=tomMatch337NameNumber_freshSubject_1;if ( (tomMatch337NameNumber_freshVar_14 instanceof tom.engine.adt.il.types.absterm.sl) ) {{  tom.engine.adt.il.types.Symbol  tomMatch337NameNumber_freshVar_11= tomMatch337NameNumber_freshVar_14.getSymbol() ;{  tom.engine.adt.il.types.AbsTerm  tomMatch337NameNumber_freshVar_12= tomMatch337NameNumber_freshVar_14.getAbst() ;{  String  tomMatch337NameNumber_freshVar_13= tomMatch337NameNumber_freshVar_14.getName() ;

        return  tom.engine.adt.zenon.types.zterm.zsl.make(ztermFromAbsTerm(tomMatch337NameNumber_freshVar_12), tomMatch337NameNumber_freshVar_13) ;
      }}}}}}}}}

    return  tom.engine.adt.zenon.types.zterm.zvar.make("Error in ztermFromAbsTerm") ;
  }

  private Map ztermVariableMapFromSubstitutionList(SubstitutionList sublist, Map map) {
    {{ Object tomMatch338NameNumber_freshVar_0=sublist;if ( (tomMatch338NameNumber_freshVar_0 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch338NameNumber_freshVar_0);{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshVar_1=tomMatch338NameNumber_freshSubject_1;if ( ((tomMatch338NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch338NameNumber_freshVar_1 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if ( tomMatch338NameNumber_freshVar_1.isEmptysubs() ) {
 return map; }}}}}}{ Object tomMatch338NameNumber_freshVar_2=sublist;if ( (tomMatch338NameNumber_freshVar_2 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch338NameNumber_freshVar_2);{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshVar_3=tomMatch338NameNumber_freshSubject_1;if ( ((tomMatch338NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch338NameNumber_freshVar_3 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch338NameNumber_freshVar_3.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch338NameNumber_freshVar_6= tomMatch338NameNumber_freshVar_3.getHeadsubs() ;if ( (tomMatch338NameNumber_freshVar_6 instanceof tom.engine.adt.il.types.substitution.undefsubs) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshVar_4= tomMatch338NameNumber_freshVar_3.getTailsubs() ;

        return ztermVariableMapFromSubstitutionList(tomMatch338NameNumber_freshVar_4,map);
      }}}}}}}}}{ Object tomMatch338NameNumber_freshVar_7=sublist;if ( (tomMatch338NameNumber_freshVar_7 instanceof tom.engine.adt.il.types.SubstitutionList) ) {{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshSubject_1=(( tom.engine.adt.il.types.SubstitutionList )tomMatch338NameNumber_freshVar_7);{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshVar_8=tomMatch338NameNumber_freshSubject_1;if ( ((tomMatch338NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.substitutionlist.Conssubs) || (tomMatch338NameNumber_freshVar_8 instanceof tom.engine.adt.il.types.substitutionlist.Emptysubs)) ) {if (!( tomMatch338NameNumber_freshVar_8.isEmptysubs() )) {{  tom.engine.adt.il.types.Substitution  tomMatch338NameNumber_freshVar_13= tomMatch338NameNumber_freshVar_8.getHeadsubs() ;if ( (tomMatch338NameNumber_freshVar_13 instanceof tom.engine.adt.il.types.substitution.is) ) {{  tom.engine.adt.il.types.Variable  tomMatch338NameNumber_freshVar_11= tomMatch338NameNumber_freshVar_13.getVar() ;{  tom.engine.adt.il.types.Term  tomMatch338NameNumber_freshVar_12= tomMatch338NameNumber_freshVar_13.getTerm() ;{  tom.engine.adt.il.types.Variable  tomMatch338NameNumber_freshVar_15=tomMatch338NameNumber_freshVar_11;if ( (tomMatch338NameNumber_freshVar_15 instanceof tom.engine.adt.il.types.variable.var) ) {{  String  tomMatch338NameNumber_freshVar_14= tomMatch338NameNumber_freshVar_15.getName() ;{  tom.engine.adt.il.types.SubstitutionList  tomMatch338NameNumber_freshVar_9= tomMatch338NameNumber_freshVar_8.getTailsubs() ;

        map.put(tomMatch338NameNumber_freshVar_14,ztermFromTerm(tomMatch338NameNumber_freshVar_12));
        return ztermVariableMapFromSubstitutionList(tomMatch338NameNumber_freshVar_9,map);
      }}}}}}}}}}}}}}}

    throw new TomRuntimeException(
        "verifier: strange substitution list: " + sublist);
  }
}

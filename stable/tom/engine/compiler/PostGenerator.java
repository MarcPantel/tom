/* Generated by TOM (version 2.5rc1): Do not edit this file *//*
 *
 * TOM - To One Matching Compiler
 * 
 * Copyright (c) 2000-2007, INRIA
 * Nancy, France.
 * 
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 * 
 * Radu Kopetz e-mail: Radu.Kopetz@loria.fr
 * Pierre-Etienne Moreau  e-mail: Pierre-Etienne.Moreau@loria.fr
 *
 **/
package tom.engine.compiler;

import java.util.ArrayList;
import java.util.Iterator;

import tom.engine.TomBase;
import tom.engine.adt.tomterm.types.*;
import tom.engine.adt.tomname.types.*;
import tom.engine.adt.tomname.types.tomname.*;
import tom.engine.adt.tominstruction.types.*;
import tom.engine.adt.tomconstraint.types.*;
import tom.engine.adt.tomconstraint.types.constraint.*;
import tom.engine.adt.tomexpression.types.*;
import tom.engine.tools.SymbolTable;
import tom.engine.compiler.generator.*;
import tom.engine.exception.TomRuntimeException;
import tom.engine.adt.tomsignature.types.*;
import tom.engine.adt.tomtype.types.*;
import tom.library.sl.*;


/**
 * This class is in charge with all the post treatments needed after the generation process
 * 1. make sure that no variable is declared twice
 * 2. make sure Ref is used for deferencing variables when needed ( for CAML ) 
 * ... 
 */
public class PostGenerator {
	
//------------------------------------------------------------  
  /* Generated by TOM (version 2.5rc1): Do not edit this file *//* Generated by TOM (version 2.5rc1): Do not edit this file *//* Generated by TOM (version 2.5rc1): Do not edit this file */ private static boolean tom_equal_term_String(String t1, String t2) { return  (t1.equals(t2)) ;}private static boolean tom_is_sort_String(String t) { return  t instanceof String ;}  /* Generated by TOM (version 2.5rc1): Do not edit this file */ private static boolean tom_equal_term_Instruction(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_Instruction(Object t) { return  t instanceof tom.engine.adt.tominstruction.types.Instruction ;}private static boolean tom_equal_term_TomType(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_TomType(Object t) { return  t instanceof tom.engine.adt.tomtype.types.TomType ;}private static boolean tom_equal_term_TomNumberList(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_TomNumberList(Object t) { return  t instanceof tom.engine.adt.tomname.types.TomNumberList ;}private static boolean tom_equal_term_TomName(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_TomName(Object t) { return  t instanceof tom.engine.adt.tomname.types.TomName ;}private static boolean tom_equal_term_Expression(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_Expression(Object t) { return  t instanceof tom.engine.adt.tomexpression.types.Expression ;}private static boolean tom_equal_term_TomTerm(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_TomTerm(Object t) { return  t instanceof tom.engine.adt.tomterm.types.TomTerm ;}private static boolean tom_equal_term_OptionList(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_OptionList(Object t) { return  t instanceof tom.engine.adt.tomoption.types.OptionList ;}private static boolean tom_equal_term_ConstraintList(Object t1, Object t2) { return  t1.equals(t2) ;}private static boolean tom_is_sort_ConstraintList(Object t) { return  t instanceof tom.engine.adt.tomconstraint.types.ConstraintList ;}private static boolean tom_is_fun_sym_If( tom.engine.adt.tominstruction.types.Instruction  t) { return  t instanceof tom.engine.adt.tominstruction.types.instruction.If ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_make_If( tom.engine.adt.tomexpression.types.Expression  t0,  tom.engine.adt.tominstruction.types.Instruction  t1,  tom.engine.adt.tominstruction.types.Instruction  t2) { return  tom.engine.adt.tominstruction.types.instruction.If.make(t0, t1, t2) ; }private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_If_Condition( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getCondition() ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_get_slot_If_SuccesInst( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getSuccesInst() ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_get_slot_If_FailureInst( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getFailureInst() ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_make_Let( tom.engine.adt.tomterm.types.TomTerm  t0,  tom.engine.adt.tomexpression.types.Expression  t1,  tom.engine.adt.tominstruction.types.Instruction  t2) { return  tom.engine.adt.tominstruction.types.instruction.Let.make(t0, t1, t2) ; }private static boolean tom_is_fun_sym_LetRef( tom.engine.adt.tominstruction.types.Instruction  t) { return  t instanceof tom.engine.adt.tominstruction.types.instruction.LetRef ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_make_LetRef( tom.engine.adt.tomterm.types.TomTerm  t0,  tom.engine.adt.tomexpression.types.Expression  t1,  tom.engine.adt.tominstruction.types.Instruction  t2) { return  tom.engine.adt.tominstruction.types.instruction.LetRef.make(t0, t1, t2) ; }private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_LetRef_Variable( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getVariable() ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_LetRef_Source( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getSource() ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_get_slot_LetRef_AstInstruction( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getAstInstruction() ;}private static boolean tom_is_fun_sym_LetAssign( tom.engine.adt.tominstruction.types.Instruction  t) { return  t instanceof tom.engine.adt.tominstruction.types.instruction.LetAssign ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_make_LetAssign( tom.engine.adt.tomterm.types.TomTerm  t0,  tom.engine.adt.tomexpression.types.Expression  t1,  tom.engine.adt.tominstruction.types.Instruction  t2) { return  tom.engine.adt.tominstruction.types.instruction.LetAssign.make(t0, t1, t2) ; }private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_LetAssign_Variable( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getVariable() ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_LetAssign_Source( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getSource() ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_get_slot_LetAssign_AstInstruction( tom.engine.adt.tominstruction.types.Instruction  t) { return  t.getAstInstruction() ;}private static boolean tom_is_fun_sym_Nop( tom.engine.adt.tominstruction.types.Instruction  t) { return  t instanceof tom.engine.adt.tominstruction.types.instruction.Nop ;}private static  tom.engine.adt.tominstruction.types.Instruction  tom_make_Nop() { return  tom.engine.adt.tominstruction.types.instruction.Nop.make() ; }private static boolean tom_is_fun_sym_PositionName( tom.engine.adt.tomname.types.TomName  t) { return  t instanceof tom.engine.adt.tomname.types.tomname.PositionName ;}private static  tom.engine.adt.tomname.types.TomNumberList  tom_get_slot_PositionName_NumberList( tom.engine.adt.tomname.types.TomName  t) { return  t.getNumberList() ;}private static boolean tom_is_fun_sym_TomTermToExpression( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.TomTermToExpression ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_TomTermToExpression( tom.engine.adt.tomterm.types.TomTerm  t0) { return  tom.engine.adt.tomexpression.types.expression.TomTermToExpression.make(t0) ; }private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_TomTermToExpression_AstTerm( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getAstTerm() ;}private static boolean tom_is_fun_sym_Conditional( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.Conditional ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_Conditional( tom.engine.adt.tomexpression.types.Expression  t0,  tom.engine.adt.tomexpression.types.Expression  t1,  tom.engine.adt.tomexpression.types.Expression  t2) { return  tom.engine.adt.tomexpression.types.expression.Conditional.make(t0, t1, t2) ; }private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_Conditional_Cond( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getCond() ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_Conditional_Then( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getThen() ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_Conditional_Else( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getElse() ;}private static boolean tom_is_fun_sym_TrueTL( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.TrueTL ;}private static boolean tom_is_fun_sym_FalseTL( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.FalseTL ;}private static boolean tom_is_fun_sym_EqualTerm( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.EqualTerm ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_EqualTerm( tom.engine.adt.tomtype.types.TomType  t0,  tom.engine.adt.tomterm.types.TomTerm  t1,  tom.engine.adt.tomterm.types.TomTerm  t2) { return  tom.engine.adt.tomexpression.types.expression.EqualTerm.make(t0, t1, t2) ; }private static  tom.engine.adt.tomtype.types.TomType  tom_get_slot_EqualTerm_TomType( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getTomType() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_EqualTerm_Kid1( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getKid1() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_EqualTerm_Kid2( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getKid2() ;}private static boolean tom_is_fun_sym_GetSlot( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.GetSlot ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_GetSlot( tom.engine.adt.tomtype.types.TomType  t0,  tom.engine.adt.tomname.types.TomName  t1,  String  t2,  tom.engine.adt.tomterm.types.TomTerm  t3) { return  tom.engine.adt.tomexpression.types.expression.GetSlot.make(t0, t1, t2, t3) ; }private static  tom.engine.adt.tomtype.types.TomType  tom_get_slot_GetSlot_Codomain( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getCodomain() ;}private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_GetSlot_AstName( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getAstName() ;}private static  String  tom_get_slot_GetSlot_SlotNameString( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getSlotNameString() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSlot_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static boolean tom_is_fun_sym_IsFsym( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.IsFsym ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_IsFsym( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1) { return  tom.engine.adt.tomexpression.types.expression.IsFsym.make(t0, t1) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_IsFsym_AstName( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getAstName() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_IsFsym_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static boolean tom_is_fun_sym_GetHead( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.GetHead ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_GetHead( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomtype.types.TomType  t1,  tom.engine.adt.tomterm.types.TomTerm  t2) { return  tom.engine.adt.tomexpression.types.expression.GetHead.make(t0, t1, t2) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_GetHead_Opname( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getOpname() ;}private static  tom.engine.adt.tomtype.types.TomType  tom_get_slot_GetHead_Codomain( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getCodomain() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetHead_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static boolean tom_is_fun_sym_GetTail( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.GetTail ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_GetTail( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1) { return  tom.engine.adt.tomexpression.types.expression.GetTail.make(t0, t1) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_GetTail_Opname( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getOpname() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetTail_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static boolean tom_is_fun_sym_IsEmptyList( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.IsEmptyList ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_IsEmptyList( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1) { return  tom.engine.adt.tomexpression.types.expression.IsEmptyList.make(t0, t1) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_IsEmptyList_Opname( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getOpname() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_IsEmptyList_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static boolean tom_is_fun_sym_IsEmptyArray( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.IsEmptyArray ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_IsEmptyArray( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1,  tom.engine.adt.tomterm.types.TomTerm  t2) { return  tom.engine.adt.tomexpression.types.expression.IsEmptyArray.make(t0, t1, t2) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_IsEmptyArray_Opname( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getOpname() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_IsEmptyArray_Variable( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariable() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_IsEmptyArray_Index( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getIndex() ;}private static boolean tom_is_fun_sym_GetSliceList( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.GetSliceList ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_GetSliceList( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1,  tom.engine.adt.tomterm.types.TomTerm  t2,  tom.engine.adt.tomterm.types.TomTerm  t3) { return  tom.engine.adt.tomexpression.types.expression.GetSliceList.make(t0, t1, t2, t3) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_GetSliceList_AstName( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getAstName() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceList_VariableBeginAST( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariableBeginAST() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceList_VariableEndAST( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariableEndAST() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceList_Tail( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getTail() ;}private static boolean tom_is_fun_sym_GetSliceArray( tom.engine.adt.tomexpression.types.Expression  t) { return  t instanceof tom.engine.adt.tomexpression.types.expression.GetSliceArray ;}private static  tom.engine.adt.tomexpression.types.Expression  tom_make_GetSliceArray( tom.engine.adt.tomname.types.TomName  t0,  tom.engine.adt.tomterm.types.TomTerm  t1,  tom.engine.adt.tomterm.types.TomTerm  t2,  tom.engine.adt.tomterm.types.TomTerm  t3) { return  tom.engine.adt.tomexpression.types.expression.GetSliceArray.make(t0, t1, t2, t3) ; }private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_GetSliceArray_AstName( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getAstName() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceArray_SubjectListName( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getSubjectListName() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceArray_VariableBeginAST( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariableBeginAST() ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_GetSliceArray_VariableEndAST( tom.engine.adt.tomexpression.types.Expression  t) { return  t.getVariableEndAST() ;}private static boolean tom_is_fun_sym_Variable( tom.engine.adt.tomterm.types.TomTerm  t) { return  t instanceof tom.engine.adt.tomterm.types.tomterm.Variable ;}private static  tom.engine.adt.tomoption.types.OptionList  tom_get_slot_Variable_Option( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getOption() ;}private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_Variable_AstName( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getAstName() ;}private static  tom.engine.adt.tomtype.types.TomType  tom_get_slot_Variable_AstType( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getAstType() ;}private static  tom.engine.adt.tomconstraint.types.ConstraintList  tom_get_slot_Variable_Constraints( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getConstraints() ;}private static boolean tom_is_fun_sym_VariableStar( tom.engine.adt.tomterm.types.TomTerm  t) { return  t instanceof tom.engine.adt.tomterm.types.tomterm.VariableStar ;}private static  tom.engine.adt.tomoption.types.OptionList  tom_get_slot_VariableStar_Option( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getOption() ;}private static  tom.engine.adt.tomname.types.TomName  tom_get_slot_VariableStar_AstName( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getAstName() ;}private static  tom.engine.adt.tomtype.types.TomType  tom_get_slot_VariableStar_AstType( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getAstType() ;}private static  tom.engine.adt.tomconstraint.types.ConstraintList  tom_get_slot_VariableStar_Constraints( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getConstraints() ;}private static boolean tom_is_fun_sym_ExpressionToTomTerm( tom.engine.adt.tomterm.types.TomTerm  t) { return  t instanceof tom.engine.adt.tomterm.types.tomterm.ExpressionToTomTerm ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_make_ExpressionToTomTerm( tom.engine.adt.tomexpression.types.Expression  t0) { return  tom.engine.adt.tomterm.types.tomterm.ExpressionToTomTerm.make(t0) ; }private static  tom.engine.adt.tomexpression.types.Expression  tom_get_slot_ExpressionToTomTerm_AstExpression( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getAstExpression() ;}private static boolean tom_is_fun_sym_Ref( tom.engine.adt.tomterm.types.TomTerm  t) { return  t instanceof tom.engine.adt.tomterm.types.tomterm.Ref ;}private static  tom.engine.adt.tomterm.types.TomTerm  tom_make_Ref( tom.engine.adt.tomterm.types.TomTerm  t0) { return  tom.engine.adt.tomterm.types.tomterm.Ref.make(t0) ; }private static  tom.engine.adt.tomterm.types.TomTerm  tom_get_slot_Ref_TomTerm( tom.engine.adt.tomterm.types.TomTerm  t) { return  t.getTomTerm() ;} /* Generated by TOM (version 2.5rc1): Do not edit this file */private static boolean tom_equal_term_Strategy(Object t1, Object t2) { return t1.equals(t2);}private static boolean tom_is_sort_Strategy(Object t) { return  t instanceof tom.library.sl.Strategy ;}/* Generated by TOM (version 2.5rc1): Do not edit this file */private static  tom.library.sl.Strategy  tom_make_mu( tom.library.sl.Strategy  var,  tom.library.sl.Strategy  v) { return  new tom.library.sl.Mu(var,v) ; }private static  tom.library.sl.Strategy  tom_make_MuVar( String  name) { return  new tom.library.sl.MuVar(name) ; }private static  tom.library.sl.Strategy  tom_make_Identity() { return  new tom.library.sl.Identity() ; }private static  tom.library.sl.Strategy  tom_make_All( tom.library.sl.Strategy  v) { return  new tom.library.sl.All(v) ; }private static boolean tom_is_fun_sym_Sequence( tom.library.sl.Strategy  t) { return  (t instanceof tom.library.sl.Sequence) ;}private static  tom.library.sl.Strategy  tom_empty_list_Sequence() { return  new tom.library.sl.Identity() ; }private static  tom.library.sl.Strategy  tom_cons_list_Sequence( tom.library.sl.Strategy  head,  tom.library.sl.Strategy  tail) { return  new tom.library.sl.Sequence(head,tail) ; }private static  tom.library.sl.Strategy  tom_get_head_Sequence_Strategy( tom.library.sl.Strategy  t) { return  (tom.library.sl.Strategy)t.getChildAt(tom.library.sl.Sequence.FIRST) ;}private static  tom.library.sl.Strategy  tom_get_tail_Sequence_Strategy( tom.library.sl.Strategy  t) { return  (tom.library.sl.Strategy)t.getChildAt(tom.library.sl.Sequence.THEN) ;}private static boolean tom_is_empty_Sequence_Strategy( tom.library.sl.Strategy  t) { return  t instanceof tom.library.sl.Identity ;}   private static   tom.library.sl.Strategy  tom_append_list_Sequence( tom.library.sl.Strategy l1,  tom.library.sl.Strategy  l2) {     if(tom_is_empty_Sequence_Strategy(l1)) {       return l2;     } else if(tom_is_empty_Sequence_Strategy(l2)) {       return l1;     } else if(tom_is_fun_sym_Sequence(l1)) {       if(tom_is_empty_Sequence_Strategy(((tom_is_fun_sym_Sequence(l1))?tom_get_tail_Sequence_Strategy(l1):tom_empty_list_Sequence()))) {         return ( tom.library.sl.Strategy )tom_cons_list_Sequence(((tom_is_fun_sym_Sequence(l1))?tom_get_head_Sequence_Strategy(l1):l1),l2);       } else {         return ( tom.library.sl.Strategy )tom_cons_list_Sequence(((tom_is_fun_sym_Sequence(l1))?tom_get_head_Sequence_Strategy(l1):l1),tom_append_list_Sequence(((tom_is_fun_sym_Sequence(l1))?tom_get_tail_Sequence_Strategy(l1):tom_empty_list_Sequence()),l2));       }     } else {       return ( tom.library.sl.Strategy )tom_cons_list_Sequence(l1, l2);     }   }   private static   tom.library.sl.Strategy  tom_get_slice_Sequence( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if(tom_equal_term_Strategy(begin,end)) {       return tail;     } else {       return ( tom.library.sl.Strategy )tom_cons_list_Sequence(((tom_is_fun_sym_Sequence(begin))?tom_get_head_Sequence_Strategy(begin):begin),( tom.library.sl.Strategy )tom_get_slice_Sequence(((tom_is_fun_sym_Sequence(begin))?tom_get_tail_Sequence_Strategy(begin):tom_empty_list_Sequence()),end,tail));     }   }   private static boolean tom_is_fun_sym_SequenceId( tom.library.sl.Strategy  t) { return  (t instanceof tom.library.sl.SequenceId) ;}private static  tom.library.sl.Strategy  tom_empty_list_SequenceId() { return  new tom.library.sl.Identity() ; }private static  tom.library.sl.Strategy  tom_cons_list_SequenceId( tom.library.sl.Strategy  head,  tom.library.sl.Strategy  tail) { return  new tom.library.sl.SequenceId(head,tail) ; }private static  tom.library.sl.Strategy  tom_get_head_SequenceId_Strategy( tom.library.sl.Strategy  t) { return  (tom.library.sl.Strategy)t.getChildAt(tom.library.sl.SequenceId.FIRST) ;}private static  tom.library.sl.Strategy  tom_get_tail_SequenceId_Strategy( tom.library.sl.Strategy  t) { return  (tom.library.sl.Strategy)t.getChildAt(tom.library.sl.SequenceId.THEN) ;}private static boolean tom_is_empty_SequenceId_Strategy( tom.library.sl.Strategy  t) { return  t instanceof tom.library.sl.Identity ;}   private static   tom.library.sl.Strategy  tom_append_list_SequenceId( tom.library.sl.Strategy l1,  tom.library.sl.Strategy  l2) {     if(tom_is_empty_SequenceId_Strategy(l1)) {       return l2;     } else if(tom_is_empty_SequenceId_Strategy(l2)) {       return l1;     } else if(tom_is_fun_sym_SequenceId(l1)) {       if(tom_is_empty_SequenceId_Strategy(((tom_is_fun_sym_SequenceId(l1))?tom_get_tail_SequenceId_Strategy(l1):tom_empty_list_SequenceId()))) {         return ( tom.library.sl.Strategy )tom_cons_list_SequenceId(((tom_is_fun_sym_SequenceId(l1))?tom_get_head_SequenceId_Strategy(l1):l1),l2);       } else {         return ( tom.library.sl.Strategy )tom_cons_list_SequenceId(((tom_is_fun_sym_SequenceId(l1))?tom_get_head_SequenceId_Strategy(l1):l1),tom_append_list_SequenceId(((tom_is_fun_sym_SequenceId(l1))?tom_get_tail_SequenceId_Strategy(l1):tom_empty_list_SequenceId()),l2));       }     } else {       return ( tom.library.sl.Strategy )tom_cons_list_SequenceId(l1, l2);     }   }   private static   tom.library.sl.Strategy  tom_get_slice_SequenceId( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if(tom_equal_term_Strategy(begin,end)) {       return tail;     } else {       return ( tom.library.sl.Strategy )tom_cons_list_SequenceId(((tom_is_fun_sym_SequenceId(begin))?tom_get_head_SequenceId_Strategy(begin):begin),( tom.library.sl.Strategy )tom_get_slice_SequenceId(((tom_is_fun_sym_SequenceId(begin))?tom_get_tail_SequenceId_Strategy(begin):tom_empty_list_SequenceId()),end,tail));     }   }    /* Generated by TOM (version 2.5rc1): Do not edit this file */ /* Generated by TOM (version 2.5rc1): Do not edit this file */private static  tom.library.sl.Strategy  tom_make_TopDown( tom.library.sl.Strategy  v) { return tom_make_mu(tom_make_MuVar("_x"),tom_cons_list_Sequence(v,tom_cons_list_Sequence(tom_make_All(tom_make_MuVar("_x")),tom_empty_list_Sequence()))) ; }private static  tom.library.sl.Strategy  tom_make_InnermostId( tom.library.sl.Strategy  v) { return tom_make_mu(tom_make_MuVar("_x"),tom_cons_list_Sequence(tom_make_All(tom_make_MuVar("_x")),tom_cons_list_Sequence(tom_cons_list_SequenceId(v,tom_cons_list_SequenceId(tom_make_MuVar("_x"),tom_empty_list_SequenceId())),tom_empty_list_Sequence()))) ; }   

//------------------------------------------------------------  
 
  public static Instruction performPostGenerationTreatment(Instruction instruction) 
       throws VisitFailure{
    instruction = (Instruction)tom_make_TopDown(tom_make_ChangeVarDeclarations()).visit(instruction);
    return (Instruction)tom_make_InnermostId(tom_make_AddRef()).visit(instruction);
    //return term;
  }

  
  private static class AddRef extends  tom.engine.adt.tomsignature.TomSignatureBasicStrategy  {public AddRef() { super(tom_make_Identity());}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];for (int i = 0; i < getChildCount(); i++) {stratChilds[i]=getChildAt(i);}return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {for (int i = 0; i < getChildCount(); i++) {setChildAt(i,children[i]);}return this;}public int getChildCount() { return 1; }public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.tomexpression.types.Expression  visit_Expression( tom.engine.adt.tomexpression.types.Expression  tom__arg) throws tom.library.sl.VisitFailure {if (tom_is_sort_Expression(tom__arg)) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch181NameNumberfreshSubject_1=(( tom.engine.adt.tomexpression.types.Expression )tom__arg);if (tom_is_fun_sym_EqualTerm(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomtype.types.TomType  tomMatch181NameNumber_freshVar_1=tom_get_slot_EqualTerm_TomType(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_2=tom_get_slot_EqualTerm_Kid1(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_3=tom_get_slot_EqualTerm_Kid2(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_0=tomMatch181NameNumber_freshVar_2;{ boolean tomMatch181NameNumber_freshVar_4= false ;if (tom_is_fun_sym_Variable(tomMatch181NameNumber_freshVar_0)) {tomMatch181NameNumber_freshVar_4= true ;} else {if (tom_is_fun_sym_VariableStar(tomMatch181NameNumber_freshVar_0)) {tomMatch181NameNumber_freshVar_4= true ;}}if ((tomMatch181NameNumber_freshVar_4 ==  true )) {if ( true ) {

        
        return tom_make_EqualTerm(tomMatch181NameNumber_freshVar_1,tom_make_Ref(tomMatch181NameNumber_freshVar_0),tomMatch181NameNumber_freshVar_3);
      }}}}}}}}if (tom_is_fun_sym_EqualTerm(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomtype.types.TomType  tomMatch181NameNumber_freshVar_6=tom_get_slot_EqualTerm_TomType(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_7=tom_get_slot_EqualTerm_Kid1(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_8=tom_get_slot_EqualTerm_Kid2(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_5=tomMatch181NameNumber_freshVar_8;{ boolean tomMatch181NameNumber_freshVar_9= false ;if (tom_is_fun_sym_Variable(tomMatch181NameNumber_freshVar_5)) {tomMatch181NameNumber_freshVar_9= true ;} else {if (tom_is_fun_sym_VariableStar(tomMatch181NameNumber_freshVar_5)) {tomMatch181NameNumber_freshVar_9= true ;}}if ((tomMatch181NameNumber_freshVar_9 ==  true )) {if ( true ) {

        
        return tom_make_EqualTerm(tomMatch181NameNumber_freshVar_6,tomMatch181NameNumber_freshVar_7,tom_make_Ref(tomMatch181NameNumber_freshVar_5));
      }}}}}}}}if (tom_is_fun_sym_IsEmptyList(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_11=tom_get_slot_IsEmptyList_Opname(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_12=tom_get_slot_IsEmptyList_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_10=tomMatch181NameNumber_freshVar_12;{ boolean tomMatch181NameNumber_freshVar_13= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_10)) {tomMatch181NameNumber_freshVar_13= true ;}if ((tomMatch181NameNumber_freshVar_13 ==  false )) {if ( true ) {


        return tom_make_IsEmptyList(tomMatch181NameNumber_freshVar_11,tom_make_Ref(tomMatch181NameNumber_freshVar_10));
      }}}}}}}if (tom_is_fun_sym_IsEmptyArray(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_16=tom_get_slot_IsEmptyArray_Opname(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_17=tom_get_slot_IsEmptyArray_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_18=tom_get_slot_IsEmptyArray_Index(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_14=tomMatch181NameNumber_freshVar_17;{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_15=tomMatch181NameNumber_freshVar_18;{ boolean tomMatch181NameNumber_freshVar_20= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_14)) {tomMatch181NameNumber_freshVar_20= true ;}if ((tomMatch181NameNumber_freshVar_20 ==  false )) {{ boolean tomMatch181NameNumber_freshVar_19= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_15)) {tomMatch181NameNumber_freshVar_19= true ;}if ((tomMatch181NameNumber_freshVar_19 ==  false )) {if ( true ) {


        return tom_make_IsEmptyArray(tomMatch181NameNumber_freshVar_16,tom_make_Ref(tomMatch181NameNumber_freshVar_14),tom_make_Ref(tomMatch181NameNumber_freshVar_15));
      }}}}}}}}}}}if (tom_is_fun_sym_Conditional(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch181NameNumber_freshVar_22=tom_get_slot_Conditional_Cond(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomexpression.types.Expression  tomMatch181NameNumber_freshVar_23=tom_get_slot_Conditional_Then(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomexpression.types.Expression  tomMatch181NameNumber_freshVar_24=tom_get_slot_Conditional_Else(tomMatch181NameNumberfreshSubject_1);if (tom_is_fun_sym_TomTermToExpression(tomMatch181NameNumber_freshVar_24)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_25=tom_get_slot_TomTermToExpression_AstTerm(tomMatch181NameNumber_freshVar_24);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_21=tomMatch181NameNumber_freshVar_25;{ boolean tomMatch181NameNumber_freshVar_26= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_21)) {tomMatch181NameNumber_freshVar_26= true ;}if ((tomMatch181NameNumber_freshVar_26 ==  false )) {if ( true ) {

        
        return tom_make_Conditional(tomMatch181NameNumber_freshVar_22,tomMatch181NameNumber_freshVar_23,tom_make_TomTermToExpression(tom_make_Ref(tomMatch181NameNumber_freshVar_21)));
      }}}}}}}}}}if (tom_is_fun_sym_GetHead(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_28=tom_get_slot_GetHead_Opname(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomtype.types.TomType  tomMatch181NameNumber_freshVar_29=tom_get_slot_GetHead_Codomain(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_30=tom_get_slot_GetHead_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_27=tomMatch181NameNumber_freshVar_30;{ boolean tomMatch181NameNumber_freshVar_31= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_27)) {tomMatch181NameNumber_freshVar_31= true ;}if ((tomMatch181NameNumber_freshVar_31 ==  false )) {if ( true ) {

        
        return tom_make_GetHead(tomMatch181NameNumber_freshVar_28,tomMatch181NameNumber_freshVar_29,tom_make_Ref(tomMatch181NameNumber_freshVar_27));
      }}}}}}}}if (tom_is_fun_sym_GetTail(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_33=tom_get_slot_GetTail_Opname(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_34=tom_get_slot_GetTail_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_32=tomMatch181NameNumber_freshVar_34;{ boolean tomMatch181NameNumber_freshVar_35= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_32)) {tomMatch181NameNumber_freshVar_35= true ;}if ((tomMatch181NameNumber_freshVar_35 ==  false )) {if ( true ) {

        
        return tom_make_GetTail(tomMatch181NameNumber_freshVar_33,tom_make_Ref(tomMatch181NameNumber_freshVar_32));
      }}}}}}}if (tom_is_fun_sym_IsFsym(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_37=tom_get_slot_IsFsym_AstName(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_38=tom_get_slot_IsFsym_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_36=tomMatch181NameNumber_freshVar_38;{ boolean tomMatch181NameNumber_freshVar_39= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_36)) {tomMatch181NameNumber_freshVar_39= true ;}if ((tomMatch181NameNumber_freshVar_39 ==  false )) {if ( true ) {


        return tom_make_IsFsym(tomMatch181NameNumber_freshVar_37,tom_make_Ref(tomMatch181NameNumber_freshVar_36));
      }}}}}}}if (tom_is_fun_sym_GetSlot(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomtype.types.TomType  tomMatch181NameNumber_freshVar_41=tom_get_slot_GetSlot_Codomain(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_42=tom_get_slot_GetSlot_AstName(tomMatch181NameNumberfreshSubject_1);{  String  tomMatch181NameNumber_freshVar_43=tom_get_slot_GetSlot_SlotNameString(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_44=tom_get_slot_GetSlot_Variable(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_40=tomMatch181NameNumber_freshVar_44;{ boolean tomMatch181NameNumber_freshVar_45= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_40)) {tomMatch181NameNumber_freshVar_45= true ;}if ((tomMatch181NameNumber_freshVar_45 ==  false )) {if ( true ) {


        return tom_make_GetSlot(tomMatch181NameNumber_freshVar_41,tomMatch181NameNumber_freshVar_42,tomMatch181NameNumber_freshVar_43,tom_make_Ref(tomMatch181NameNumber_freshVar_40));
      }}}}}}}}}if (tom_is_fun_sym_GetSliceList(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_47=tom_get_slot_GetSliceList_AstName(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_48=tom_get_slot_GetSliceList_VariableBeginAST(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_49=tom_get_slot_GetSliceList_VariableEndAST(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_50=tom_get_slot_GetSliceList_Tail(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_46=tomMatch181NameNumber_freshVar_48;{ boolean tomMatch181NameNumber_freshVar_51= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_46)) {tomMatch181NameNumber_freshVar_51= true ;}if ((tomMatch181NameNumber_freshVar_51 ==  false )) {if ( true ) {


        return tom_make_GetSliceList(tomMatch181NameNumber_freshVar_47,tom_make_Ref(tomMatch181NameNumber_freshVar_46),tom_make_Ref(tomMatch181NameNumber_freshVar_49),tomMatch181NameNumber_freshVar_50);
      }}}}}}}}}if (tom_is_fun_sym_GetSliceArray(tomMatch181NameNumberfreshSubject_1)) {{  tom.engine.adt.tomname.types.TomName  tomMatch181NameNumber_freshVar_53=tom_get_slot_GetSliceArray_AstName(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_54=tom_get_slot_GetSliceArray_SubjectListName(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_55=tom_get_slot_GetSliceArray_VariableBeginAST(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_56=tom_get_slot_GetSliceArray_VariableEndAST(tomMatch181NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch181NameNumber_freshVar_52=tomMatch181NameNumber_freshVar_55;{ boolean tomMatch181NameNumber_freshVar_57= false ;if (tom_is_fun_sym_Ref(tomMatch181NameNumber_freshVar_52)) {tomMatch181NameNumber_freshVar_57= true ;}if ((tomMatch181NameNumber_freshVar_57 ==  false )) {if ( true ) {


        return tom_make_GetSliceArray(tomMatch181NameNumber_freshVar_53,tomMatch181NameNumber_freshVar_54,tom_make_Ref(tomMatch181NameNumber_freshVar_52),tom_make_Ref(tomMatch181NameNumber_freshVar_56));
      }}}}}}}}}}}return super.visit_Expression(tom__arg); }public  tom.engine.adt.tominstruction.types.Instruction  visit_Instruction( tom.engine.adt.tominstruction.types.Instruction  tom__arg) throws tom.library.sl.VisitFailure {if (tom_is_sort_Instruction(tom__arg)) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch184NameNumberfreshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tom__arg);if (tom_is_fun_sym_If(tomMatch184NameNumberfreshSubject_1)) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_2=tom_get_slot_If_Condition(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch184NameNumber_freshVar_3=tom_get_slot_If_SuccesInst(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch184NameNumber_freshVar_4=tom_get_slot_If_FailureInst(tomMatch184NameNumberfreshSubject_1);if (tom_is_fun_sym_EqualTerm(tomMatch184NameNumber_freshVar_2)) {{  tom.engine.adt.tomtype.types.TomType  tomMatch184NameNumber_freshVar_5=tom_get_slot_EqualTerm_TomType(tomMatch184NameNumber_freshVar_2);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_6=tom_get_slot_EqualTerm_Kid1(tomMatch184NameNumber_freshVar_2);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_7=tom_get_slot_EqualTerm_Kid2(tomMatch184NameNumber_freshVar_2);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_0=tomMatch184NameNumber_freshVar_6;if (tom_is_fun_sym_ExpressionToTomTerm(tomMatch184NameNumber_freshVar_7)) {{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_8=tom_get_slot_ExpressionToTomTerm_AstExpression(tomMatch184NameNumber_freshVar_7);{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_1=tomMatch184NameNumber_freshVar_8;if (tom_is_fun_sym_Nop(tomMatch184NameNumber_freshVar_4)) {{ boolean tomMatch184NameNumber_freshVar_10= false ;if (tom_is_fun_sym_TrueTL(tomMatch184NameNumber_freshVar_1)) {tomMatch184NameNumber_freshVar_10= true ;} else {if (tom_is_fun_sym_FalseTL(tomMatch184NameNumber_freshVar_1)) {tomMatch184NameNumber_freshVar_10= true ;}}if ((tomMatch184NameNumber_freshVar_10 ==  true )) {{ boolean tomMatch184NameNumber_freshVar_9= false ;if (tom_is_fun_sym_Ref(tomMatch184NameNumber_freshVar_0)) {tomMatch184NameNumber_freshVar_9= true ;}if ((tomMatch184NameNumber_freshVar_9 ==  false )) {if ( true ) {




        
        return tom_make_If(tom_make_EqualTerm(tomMatch184NameNumber_freshVar_5,tom_make_Ref(tomMatch184NameNumber_freshVar_0),tom_make_ExpressionToTomTerm(tomMatch184NameNumber_freshVar_1)),tomMatch184NameNumber_freshVar_3,tom_make_Nop());
      }}}}}}}}}}}}}}}}}}if (tom_is_fun_sym_LetRef(tomMatch184NameNumberfreshSubject_1)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_14=tom_get_slot_LetRef_Variable(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_15=tom_get_slot_LetRef_Source(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch184NameNumber_freshVar_16=tom_get_slot_LetRef_AstInstruction(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_11=tomMatch184NameNumber_freshVar_14;{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_12=tomMatch184NameNumber_freshVar_15;{  tom.engine.adt.tominstruction.types.Instruction  tom_instruction=tomMatch184NameNumber_freshVar_16;{ boolean tomMatch184NameNumber_freshVar_19= false ;if (tom_is_fun_sym_Variable(tomMatch184NameNumber_freshVar_11)) {tomMatch184NameNumber_freshVar_19= true ;} else {if (tom_is_fun_sym_VariableStar(tomMatch184NameNumber_freshVar_11)) {tomMatch184NameNumber_freshVar_19= true ;}}if ((tomMatch184NameNumber_freshVar_19 ==  true )) {{  tom.engine.adt.tomterm.types.TomTerm  tom_var=tomMatch184NameNumber_freshVar_11;if (tom_is_fun_sym_TomTermToExpression(tomMatch184NameNumber_freshVar_12)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_17=tom_get_slot_TomTermToExpression_AstTerm(tomMatch184NameNumber_freshVar_12);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_13=tomMatch184NameNumber_freshVar_17;{  tom.engine.adt.tomterm.types.TomTerm  tom_source=tomMatch184NameNumber_freshVar_13;{ boolean tomMatch184NameNumber_freshVar_18= false ;if (tom_is_fun_sym_Ref(tomMatch184NameNumber_freshVar_13)) {tomMatch184NameNumber_freshVar_18= true ;}if ((tomMatch184NameNumber_freshVar_18 ==  false )) {if ( true ) {



        TomName name = tom_var.getAstName(); 
        if (tom_is_sort_TomName(name)) {{  tom.engine.adt.tomname.types.TomName  tomMatch182NameNumberfreshSubject_1=(( tom.engine.adt.tomname.types.TomName )name);if (tom_is_fun_sym_PositionName(tomMatch182NameNumberfreshSubject_1)) {if ( true ) {

            return tom_make_LetRef(tom_var,tom_make_TomTermToExpression(tom_make_Ref(tom_source)),tom_instruction);    
          }}}}if (tom_is_sort_TomTerm(tom_source)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch183NameNumberfreshSubject_1=(( tom.engine.adt.tomterm.types.TomTerm )tom_source);{ boolean tomMatch183NameNumber_freshVar_0= false ;if (tom_is_fun_sym_Variable(tomMatch183NameNumberfreshSubject_1)) {tomMatch183NameNumber_freshVar_0= true ;} else {if (tom_is_fun_sym_VariableStar(tomMatch183NameNumberfreshSubject_1)) {tomMatch183NameNumber_freshVar_0= true ;}}if ((tomMatch183NameNumber_freshVar_0 ==  true )) {if ( true ) {



            return tom_make_Let(tom_var,tom_make_TomTermToExpression(tom_make_Ref(tom_source)),tom_instruction);    
          }}}if ( true ) {

            // we generate let for the variables of the initial pattern comming from lists
            return tom_make_Let(tom_var,tomMatch184NameNumber_freshVar_12,tom_instruction);    
          }}}
        
      }}}}}}}}}}}}}}}}}if (tom_is_fun_sym_LetAssign(tomMatch184NameNumberfreshSubject_1)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_21=tom_get_slot_LetAssign_Variable(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tomexpression.types.Expression  tomMatch184NameNumber_freshVar_22=tom_get_slot_LetAssign_Source(tomMatch184NameNumberfreshSubject_1);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch184NameNumber_freshVar_23=tom_get_slot_LetAssign_AstInstruction(tomMatch184NameNumberfreshSubject_1);if (tom_is_fun_sym_TomTermToExpression(tomMatch184NameNumber_freshVar_22)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_24=tom_get_slot_TomTermToExpression_AstTerm(tomMatch184NameNumber_freshVar_22);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch184NameNumber_freshVar_20=tomMatch184NameNumber_freshVar_24;{ boolean tomMatch184NameNumber_freshVar_25= false ;if (tom_is_fun_sym_Variable(tomMatch184NameNumber_freshVar_20)) {tomMatch184NameNumber_freshVar_25= true ;} else {if (tom_is_fun_sym_VariableStar(tomMatch184NameNumber_freshVar_20)) {tomMatch184NameNumber_freshVar_25= true ;}}if ((tomMatch184NameNumber_freshVar_25 ==  true )) {if ( true ) {

        
        return tom_make_LetAssign(tomMatch184NameNumber_freshVar_21,tom_make_TomTermToExpression(tom_make_Ref(tomMatch184NameNumber_freshVar_20)),tomMatch184NameNumber_freshVar_23);
      }}}}}}}}}}}}return super.visit_Instruction(tom__arg); }}private static  tom.library.sl.Strategy  tom_make_AddRef() { return new AddRef(); }



  
  /**
   * Makes sure that no variable is declared if the same variable was declared above  
   */
  private static class ChangeVarDeclarations extends  tom.engine.adt.tomsignature.TomSignatureBasicStrategy  {public ChangeVarDeclarations() { super(tom_make_Identity());}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];for (int i = 0; i < getChildCount(); i++) {stratChilds[i]=getChildAt(i);}return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {for (int i = 0; i < getChildCount(); i++) {setChildAt(i,children[i]);}return this;}public int getChildCount() { return 1; }public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.tominstruction.types.Instruction  visit_Instruction( tom.engine.adt.tominstruction.types.Instruction  tom__arg) throws tom.library.sl.VisitFailure {if (tom_is_sort_Instruction(tom__arg)) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch185NameNumberfreshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tom__arg);if (tom_is_fun_sym_LetRef(tomMatch185NameNumberfreshSubject_1)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch185NameNumber_freshVar_1=tom_get_slot_LetRef_Variable(tomMatch185NameNumberfreshSubject_1);{  tom.engine.adt.tomexpression.types.Expression  tomMatch185NameNumber_freshVar_2=tom_get_slot_LetRef_Source(tomMatch185NameNumberfreshSubject_1);{  tom.engine.adt.tominstruction.types.Instruction  tomMatch185NameNumber_freshVar_3=tom_get_slot_LetRef_AstInstruction(tomMatch185NameNumberfreshSubject_1);{  tom.engine.adt.tomterm.types.TomTerm  tomMatch185NameNumber_freshVar_0=tomMatch185NameNumber_freshVar_1;{ boolean tomMatch185NameNumber_freshVar_5= false ;{  tom.engine.adt.tomname.types.TomName  tomMatch185NameNumber_freshVar_4= null ;if (tom_is_fun_sym_Variable(tomMatch185NameNumber_freshVar_0)) {{tomMatch185NameNumber_freshVar_5= true ;tomMatch185NameNumber_freshVar_4=tom_get_slot_Variable_AstName(tomMatch185NameNumber_freshVar_0);}} else {if (tom_is_fun_sym_VariableStar(tomMatch185NameNumber_freshVar_0)) {{tomMatch185NameNumber_freshVar_5= true ;tomMatch185NameNumber_freshVar_4=tom_get_slot_VariableStar_AstName(tomMatch185NameNumber_freshVar_0);}}}if ((tomMatch185NameNumber_freshVar_5 ==  true )) {if ( true ) {


        Visitable root = getEnvironment().getRoot();
        if (root != getEnvironment().getSubject()) {
          try {
            getEnvironment().getPosition().getOmegaPath(tom_make_CheckVarExistence(tomMatch185NameNumber_freshVar_4)).visit(root); 
          } catch (VisitFailure e) {
            return tom_make_LetAssign(tomMatch185NameNumber_freshVar_0,tomMatch185NameNumber_freshVar_2,tomMatch185NameNumber_freshVar_3);
          }
        }
      }}}}}}}}}}}return super.visit_Instruction(tom__arg); }}private static  tom.library.sl.Strategy  tom_make_ChangeVarDeclarations() { return new ChangeVarDeclarations(); }

// end strategy

  private static class CheckVarExistence extends  tom.engine.adt.tomsignature.TomSignatureBasicStrategy  {private  tom.engine.adt.tomname.types.TomName  varName; public CheckVarExistence( tom.engine.adt.tomname.types.TomName  varName) { super(tom_make_Identity());this.varName=varName;}public  tom.engine.adt.tomname.types.TomName  getvarName() { return varName;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];for (int i = 0; i < getChildCount(); i++) {stratChilds[i]=getChildAt(i);}return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {for (int i = 0; i < getChildCount(); i++) {setChildAt(i,children[i]);}return this;}public int getChildCount() { return 1; }public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.engine.adt.tominstruction.types.Instruction  visit_Instruction( tom.engine.adt.tominstruction.types.Instruction  tom__arg) throws tom.library.sl.VisitFailure {if (tom_is_sort_Instruction(tom__arg)) {{  tom.engine.adt.tominstruction.types.Instruction  tomMatch186NameNumberfreshSubject_1=(( tom.engine.adt.tominstruction.types.Instruction )tom__arg);if (tom_is_fun_sym_LetRef(tomMatch186NameNumberfreshSubject_1)) {{  tom.engine.adt.tomterm.types.TomTerm  tomMatch186NameNumber_freshVar_0=tom_get_slot_LetRef_Variable(tomMatch186NameNumberfreshSubject_1);{ boolean tomMatch186NameNumber_freshVar_2= false ;{  tom.engine.adt.tomname.types.TomName  tomMatch186NameNumber_freshVar_1= null ;if (tom_is_fun_sym_Variable(tomMatch186NameNumber_freshVar_0)) {{tomMatch186NameNumber_freshVar_2= true ;tomMatch186NameNumber_freshVar_1=tom_get_slot_Variable_AstName(tomMatch186NameNumber_freshVar_0);}} else {if (tom_is_fun_sym_VariableStar(tomMatch186NameNumber_freshVar_0)) {{tomMatch186NameNumber_freshVar_2= true ;tomMatch186NameNumber_freshVar_1=tom_get_slot_VariableStar_AstName(tomMatch186NameNumber_freshVar_0);}}}if ((tomMatch186NameNumber_freshVar_2 ==  true )) {if ( true ) {


        if(varName == (tomMatch186NameNumber_freshVar_1) ) {
          throw new VisitFailure();
        }
      }}}}}}}}return super.visit_Instruction(tom__arg); }}private static  tom.library.sl.Strategy  tom_make_CheckVarExistence( tom.engine.adt.tomname.types.TomName  t0) { return new CheckVarExistence(t0); }

// end strategy
  
}

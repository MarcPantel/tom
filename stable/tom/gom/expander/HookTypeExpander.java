/* Generated by TOM (version 2.6): Do not edit this file *//*
 *
 * GOM
 *
 * Copyright (c) 2006-2008, INRIA
 * Nancy, France.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 *
 * Antoine Reilles  e-mail: Antoine.Reilles@loria.fr
 *
 **/

package tom.gom.expander;

import java.util.*;
import java.util.logging.Level;
import java.util.logging.Logger;

import tom.gom.GomMessage;
import tom.gom.GomStreamManager;
import tom.gom.adt.gom.*;
import tom.gom.adt.gom.types.*;
import tom.gom.tools.error.GomRuntimeException;
import tom.gom.expander.rule.RuleExpander;
import tom.gom.expander.rule.GraphRuleExpander;

public class HookTypeExpander {

  /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */  /* Generated by TOM (version 2.6): Do not edit this file */    public static   tom.gom.adt.code.types.Code  tom_append_list_CodeList( tom.gom.adt.code.types.Code  l1,  tom.gom.adt.code.types.Code  l2) {     if( l1.isEmptyCodeList() ) {       return l2;     } else if( l2.isEmptyCodeList() ) {       return l1;     } else if( ((l1 instanceof tom.gom.adt.code.types.code.ConsCodeList) || (l1 instanceof tom.gom.adt.code.types.code.EmptyCodeList)) ) {       if( (( ((l1 instanceof tom.gom.adt.code.types.code.ConsCodeList) || (l1 instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? l1.getTailCodeList() : tom.gom.adt.code.types.code.EmptyCodeList.make() ).isEmptyCodeList() ) {         return  tom.gom.adt.code.types.code.ConsCodeList.make((( ((l1 instanceof tom.gom.adt.code.types.code.ConsCodeList) || (l1 instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? l1.getHeadCodeList() :l1),l2) ;       } else {         return  tom.gom.adt.code.types.code.ConsCodeList.make((( ((l1 instanceof tom.gom.adt.code.types.code.ConsCodeList) || (l1 instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? l1.getHeadCodeList() :l1),tom_append_list_CodeList((( ((l1 instanceof tom.gom.adt.code.types.code.ConsCodeList) || (l1 instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? l1.getTailCodeList() : tom.gom.adt.code.types.code.EmptyCodeList.make() ),l2)) ;       }     } else {       return  tom.gom.adt.code.types.code.ConsCodeList.make(l1,l2) ;     }   }   public static   tom.gom.adt.code.types.Code  tom_get_slice_CodeList( tom.gom.adt.code.types.Code  begin,  tom.gom.adt.code.types.Code  end, tom.gom.adt.code.types.Code  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyCodeList()  ||  (end== tom.gom.adt.code.types.code.EmptyCodeList.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.code.types.code.ConsCodeList.make((( ((begin instanceof tom.gom.adt.code.types.code.ConsCodeList) || (begin instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? begin.getHeadCodeList() :begin),( tom.gom.adt.code.types.Code )tom_get_slice_CodeList((( ((begin instanceof tom.gom.adt.code.types.code.ConsCodeList) || (begin instanceof tom.gom.adt.code.types.code.EmptyCodeList)) )? begin.getTailCodeList() : tom.gom.adt.code.types.code.EmptyCodeList.make() ),end,tail)) ;   }      public static   tom.gom.adt.gom.types.ArgList  tom_append_list_ConcArg( tom.gom.adt.gom.types.ArgList l1,  tom.gom.adt.gom.types.ArgList  l2) {     if( l1.isEmptyConcArg() ) {       return l2;     } else if( l2.isEmptyConcArg() ) {       return l1;     } else if(  l1.getTailConcArg() .isEmptyConcArg() ) {       return  tom.gom.adt.gom.types.arglist.ConsConcArg.make( l1.getHeadConcArg() ,l2) ;     } else {       return  tom.gom.adt.gom.types.arglist.ConsConcArg.make( l1.getHeadConcArg() ,tom_append_list_ConcArg( l1.getTailConcArg() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.ArgList  tom_get_slice_ConcArg( tom.gom.adt.gom.types.ArgList  begin,  tom.gom.adt.gom.types.ArgList  end, tom.gom.adt.gom.types.ArgList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcArg()  ||  (end== tom.gom.adt.gom.types.arglist.EmptyConcArg.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.arglist.ConsConcArg.make( begin.getHeadConcArg() ,( tom.gom.adt.gom.types.ArgList )tom_get_slice_ConcArg( begin.getTailConcArg() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.GomModuleList  tom_append_list_ConcGomModule( tom.gom.adt.gom.types.GomModuleList l1,  tom.gom.adt.gom.types.GomModuleList  l2) {     if( l1.isEmptyConcGomModule() ) {       return l2;     } else if( l2.isEmptyConcGomModule() ) {       return l1;     } else if(  l1.getTailConcGomModule() .isEmptyConcGomModule() ) {       return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( l1.getHeadConcGomModule() ,l2) ;     } else {       return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( l1.getHeadConcGomModule() ,tom_append_list_ConcGomModule( l1.getTailConcGomModule() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.GomModuleList  tom_get_slice_ConcGomModule( tom.gom.adt.gom.types.GomModuleList  begin,  tom.gom.adt.gom.types.GomModuleList  end, tom.gom.adt.gom.types.GomModuleList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcGomModule()  ||  (end== tom.gom.adt.gom.types.gommodulelist.EmptyConcGomModule.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( begin.getHeadConcGomModule() ,( tom.gom.adt.gom.types.GomModuleList )tom_get_slice_ConcGomModule( begin.getTailConcGomModule() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.GrammarList  tom_append_list_ConcGrammar( tom.gom.adt.gom.types.GrammarList l1,  tom.gom.adt.gom.types.GrammarList  l2) {     if( l1.isEmptyConcGrammar() ) {       return l2;     } else if( l2.isEmptyConcGrammar() ) {       return l1;     } else if(  l1.getTailConcGrammar() .isEmptyConcGrammar() ) {       return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( l1.getHeadConcGrammar() ,l2) ;     } else {       return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( l1.getHeadConcGrammar() ,tom_append_list_ConcGrammar( l1.getTailConcGrammar() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.GrammarList  tom_get_slice_ConcGrammar( tom.gom.adt.gom.types.GrammarList  begin,  tom.gom.adt.gom.types.GrammarList  end, tom.gom.adt.gom.types.GrammarList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcGrammar()  ||  (end== tom.gom.adt.gom.types.grammarlist.EmptyConcGrammar.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( begin.getHeadConcGrammar() ,( tom.gom.adt.gom.types.GrammarList )tom_get_slice_ConcGrammar( begin.getTailConcGrammar() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.SectionList  tom_append_list_ConcSection( tom.gom.adt.gom.types.SectionList l1,  tom.gom.adt.gom.types.SectionList  l2) {     if( l1.isEmptyConcSection() ) {       return l2;     } else if( l2.isEmptyConcSection() ) {       return l1;     } else if(  l1.getTailConcSection() .isEmptyConcSection() ) {       return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( l1.getHeadConcSection() ,l2) ;     } else {       return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( l1.getHeadConcSection() ,tom_append_list_ConcSection( l1.getTailConcSection() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.SectionList  tom_get_slice_ConcSection( tom.gom.adt.gom.types.SectionList  begin,  tom.gom.adt.gom.types.SectionList  end, tom.gom.adt.gom.types.SectionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcSection()  ||  (end== tom.gom.adt.gom.types.sectionlist.EmptyConcSection.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( begin.getHeadConcSection() ,( tom.gom.adt.gom.types.SectionList )tom_get_slice_ConcSection( begin.getTailConcSection() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.OperatorDeclList  tom_append_list_ConcOperator( tom.gom.adt.gom.types.OperatorDeclList l1,  tom.gom.adt.gom.types.OperatorDeclList  l2) {     if( l1.isEmptyConcOperator() ) {       return l2;     } else if( l2.isEmptyConcOperator() ) {       return l1;     } else if(  l1.getTailConcOperator() .isEmptyConcOperator() ) {       return  tom.gom.adt.gom.types.operatordecllist.ConsConcOperator.make( l1.getHeadConcOperator() ,l2) ;     } else {       return  tom.gom.adt.gom.types.operatordecllist.ConsConcOperator.make( l1.getHeadConcOperator() ,tom_append_list_ConcOperator( l1.getTailConcOperator() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.OperatorDeclList  tom_get_slice_ConcOperator( tom.gom.adt.gom.types.OperatorDeclList  begin,  tom.gom.adt.gom.types.OperatorDeclList  end, tom.gom.adt.gom.types.OperatorDeclList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcOperator()  ||  (end== tom.gom.adt.gom.types.operatordecllist.EmptyConcOperator.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.operatordecllist.ConsConcOperator.make( begin.getHeadConcOperator() ,( tom.gom.adt.gom.types.OperatorDeclList )tom_get_slice_ConcOperator( begin.getTailConcOperator() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.HookDeclList  tom_append_list_ConcHookDecl( tom.gom.adt.gom.types.HookDeclList l1,  tom.gom.adt.gom.types.HookDeclList  l2) {     if( l1.isEmptyConcHookDecl() ) {       return l2;     } else if( l2.isEmptyConcHookDecl() ) {       return l1;     } else if(  l1.getTailConcHookDecl() .isEmptyConcHookDecl() ) {       return  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( l1.getHeadConcHookDecl() ,l2) ;     } else {       return  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( l1.getHeadConcHookDecl() ,tom_append_list_ConcHookDecl( l1.getTailConcHookDecl() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.HookDeclList  tom_get_slice_ConcHookDecl( tom.gom.adt.gom.types.HookDeclList  begin,  tom.gom.adt.gom.types.HookDeclList  end, tom.gom.adt.gom.types.HookDeclList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcHookDecl()  ||  (end== tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( begin.getHeadConcHookDecl() ,( tom.gom.adt.gom.types.HookDeclList )tom_get_slice_ConcHookDecl( begin.getTailConcHookDecl() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.ProductionList  tom_append_list_ConcProduction( tom.gom.adt.gom.types.ProductionList l1,  tom.gom.adt.gom.types.ProductionList  l2) {     if( l1.isEmptyConcProduction() ) {       return l2;     } else if( l2.isEmptyConcProduction() ) {       return l1;     } else if(  l1.getTailConcProduction() .isEmptyConcProduction() ) {       return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( l1.getHeadConcProduction() ,l2) ;     } else {       return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( l1.getHeadConcProduction() ,tom_append_list_ConcProduction( l1.getTailConcProduction() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.ProductionList  tom_get_slice_ConcProduction( tom.gom.adt.gom.types.ProductionList  begin,  tom.gom.adt.gom.types.ProductionList  end, tom.gom.adt.gom.types.ProductionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcProduction()  ||  (end== tom.gom.adt.gom.types.productionlist.EmptyConcProduction.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( begin.getHeadConcProduction() ,( tom.gom.adt.gom.types.ProductionList )tom_get_slice_ConcProduction( begin.getTailConcProduction() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.FieldList  tom_append_list_ConcField( tom.gom.adt.gom.types.FieldList l1,  tom.gom.adt.gom.types.FieldList  l2) {     if( l1.isEmptyConcField() ) {       return l2;     } else if( l2.isEmptyConcField() ) {       return l1;     } else if(  l1.getTailConcField() .isEmptyConcField() ) {       return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( l1.getHeadConcField() ,l2) ;     } else {       return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( l1.getHeadConcField() ,tom_append_list_ConcField( l1.getTailConcField() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.FieldList  tom_get_slice_ConcField( tom.gom.adt.gom.types.FieldList  begin,  tom.gom.adt.gom.types.FieldList  end, tom.gom.adt.gom.types.FieldList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcField()  ||  (end== tom.gom.adt.gom.types.fieldlist.EmptyConcField.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( begin.getHeadConcField() ,( tom.gom.adt.gom.types.FieldList )tom_get_slice_ConcField( begin.getTailConcField() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.SlotList  tom_append_list_ConcSlot( tom.gom.adt.gom.types.SlotList l1,  tom.gom.adt.gom.types.SlotList  l2) {     if( l1.isEmptyConcSlot() ) {       return l2;     } else if( l2.isEmptyConcSlot() ) {       return l1;     } else if(  l1.getTailConcSlot() .isEmptyConcSlot() ) {       return  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( l1.getHeadConcSlot() ,l2) ;     } else {       return  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( l1.getHeadConcSlot() ,tom_append_list_ConcSlot( l1.getTailConcSlot() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.SlotList  tom_get_slice_ConcSlot( tom.gom.adt.gom.types.SlotList  begin,  tom.gom.adt.gom.types.SlotList  end, tom.gom.adt.gom.types.SlotList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcSlot()  ||  (end== tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( begin.getHeadConcSlot() ,( tom.gom.adt.gom.types.SlotList )tom_get_slice_ConcSlot( begin.getTailConcSlot() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.SortList  tom_append_list_ConcSort( tom.gom.adt.gom.types.SortList l1,  tom.gom.adt.gom.types.SortList  l2) {     if( l1.isEmptyConcSort() ) {       return l2;     } else if( l2.isEmptyConcSort() ) {       return l1;     } else if(  l1.getTailConcSort() .isEmptyConcSort() ) {       return  tom.gom.adt.gom.types.sortlist.ConsConcSort.make( l1.getHeadConcSort() ,l2) ;     } else {       return  tom.gom.adt.gom.types.sortlist.ConsConcSort.make( l1.getHeadConcSort() ,tom_append_list_ConcSort( l1.getTailConcSort() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.SortList  tom_get_slice_ConcSort( tom.gom.adt.gom.types.SortList  begin,  tom.gom.adt.gom.types.SortList  end, tom.gom.adt.gom.types.SortList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcSort()  ||  (end== tom.gom.adt.gom.types.sortlist.EmptyConcSort.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.sortlist.ConsConcSort.make( begin.getHeadConcSort() ,( tom.gom.adt.gom.types.SortList )tom_get_slice_ConcSort( begin.getTailConcSort() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.ModuleList  tom_append_list_ConcModule( tom.gom.adt.gom.types.ModuleList l1,  tom.gom.adt.gom.types.ModuleList  l2) {     if( l1.isEmptyConcModule() ) {       return l2;     } else if( l2.isEmptyConcModule() ) {       return l1;     } else if(  l1.getTailConcModule() .isEmptyConcModule() ) {       return  tom.gom.adt.gom.types.modulelist.ConsConcModule.make( l1.getHeadConcModule() ,l2) ;     } else {       return  tom.gom.adt.gom.types.modulelist.ConsConcModule.make( l1.getHeadConcModule() ,tom_append_list_ConcModule( l1.getTailConcModule() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.ModuleList  tom_get_slice_ConcModule( tom.gom.adt.gom.types.ModuleList  begin,  tom.gom.adt.gom.types.ModuleList  end, tom.gom.adt.gom.types.ModuleList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcModule()  ||  (end== tom.gom.adt.gom.types.modulelist.EmptyConcModule.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.modulelist.ConsConcModule.make( begin.getHeadConcModule() ,( tom.gom.adt.gom.types.ModuleList )tom_get_slice_ConcModule( begin.getTailConcModule() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.Option  tom_append_list_OptionList( tom.gom.adt.gom.types.Option  l1,  tom.gom.adt.gom.types.Option  l2) {     if( l1.isEmptyOptionList() ) {       return l2;     } else if( l2.isEmptyOptionList() ) {       return l1;     } else if( ((l1 instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (l1 instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) ) {       if( (( ((l1 instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (l1 instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? l1.getTailOptionList() : tom.gom.adt.gom.types.option.EmptyOptionList.make() ).isEmptyOptionList() ) {         return  tom.gom.adt.gom.types.option.ConsOptionList.make((( ((l1 instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (l1 instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? l1.getHeadOptionList() :l1),l2) ;       } else {         return  tom.gom.adt.gom.types.option.ConsOptionList.make((( ((l1 instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (l1 instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? l1.getHeadOptionList() :l1),tom_append_list_OptionList((( ((l1 instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (l1 instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? l1.getTailOptionList() : tom.gom.adt.gom.types.option.EmptyOptionList.make() ),l2)) ;       }     } else {       return  tom.gom.adt.gom.types.option.ConsOptionList.make(l1,l2) ;     }   }   public static   tom.gom.adt.gom.types.Option  tom_get_slice_OptionList( tom.gom.adt.gom.types.Option  begin,  tom.gom.adt.gom.types.Option  end, tom.gom.adt.gom.types.Option  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyOptionList()  ||  (end== tom.gom.adt.gom.types.option.EmptyOptionList.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.option.ConsOptionList.make((( ((begin instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (begin instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? begin.getHeadOptionList() :begin),( tom.gom.adt.gom.types.Option )tom_get_slice_OptionList((( ((begin instanceof tom.gom.adt.gom.types.option.ConsOptionList) || (begin instanceof tom.gom.adt.gom.types.option.EmptyOptionList)) )? begin.getTailOptionList() : tom.gom.adt.gom.types.option.EmptyOptionList.make() ),end,tail)) ;   }    

  private ModuleList moduleList;
  private ArrayList sortsWithGraphrules;

  public HookTypeExpander(ModuleList moduleList) {
    this.moduleList = moduleList;
    sortsWithGraphrules = new ArrayList();
  }

  /**
    * Get the correct types for hooks, and attach them the correct Decl
    */
  public HookDeclList expand(GomModuleList gomModuleList) {
    HookDeclList hookList =  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
    /* For each hook in the GomModuleList */
    {{ Object tomMatch510NameNumber_freshVar_0=gomModuleList;if ( (tomMatch510NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.GomModuleList) ) {{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.GomModuleList )tomMatch510NameNumber_freshVar_0);{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_freshVar_1=tomMatch510NameNumber_freshSubject_1;if ( ((tomMatch510NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule) || (tomMatch510NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.gommodulelist.EmptyConcGomModule)) ) {{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_begin_3=tomMatch510NameNumber_freshVar_1;{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_end_4=tomMatch510NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_freshVar_2=tomMatch510NameNumber_end_4;if (!( tomMatch510NameNumber_freshVar_2.isEmptyConcGomModule() )) {{  tom.gom.adt.gom.types.GomModule  tomMatch510NameNumber_freshVar_9= tomMatch510NameNumber_freshVar_2.getHeadConcGomModule() ;if ( (tomMatch510NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.gommodule.GomModule) ) {{  tom.gom.adt.gom.types.GomModuleName  tomMatch510NameNumber_freshVar_7= tomMatch510NameNumber_freshVar_9.getModuleName() ;{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_freshVar_8= tomMatch510NameNumber_freshVar_9.getSectionList() ;{  tom.gom.adt.gom.types.GomModuleName  tomMatch510NameNumber_freshVar_11=tomMatch510NameNumber_freshVar_7;if ( (tomMatch510NameNumber_freshVar_11 instanceof tom.gom.adt.gom.types.gommodulename.GomModuleName) ) {{  String  tomMatch510NameNumber_freshVar_10= tomMatch510NameNumber_freshVar_11.getName() ;{  String  tom_moduleName=tomMatch510NameNumber_freshVar_10;{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_freshVar_12=tomMatch510NameNumber_freshVar_8;if ( ((tomMatch510NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.sectionlist.ConsConcSection) || (tomMatch510NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.sectionlist.EmptyConcSection)) ) {{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_begin_14=tomMatch510NameNumber_freshVar_12;{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_end_15=tomMatch510NameNumber_freshVar_12;do {{{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_freshVar_13=tomMatch510NameNumber_end_15;if (!( tomMatch510NameNumber_freshVar_13.isEmptyConcSection() )) {{  tom.gom.adt.gom.types.Section  tomMatch510NameNumber_freshVar_19= tomMatch510NameNumber_freshVar_13.getHeadConcSection() ;if ( (tomMatch510NameNumber_freshVar_19 instanceof tom.gom.adt.gom.types.section.Public) ) {{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_freshVar_18= tomMatch510NameNumber_freshVar_19.getGrammarList() ;{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_freshVar_20=tomMatch510NameNumber_freshVar_18;if ( ((tomMatch510NameNumber_freshVar_20 instanceof tom.gom.adt.gom.types.grammarlist.ConsConcGrammar) || (tomMatch510NameNumber_freshVar_20 instanceof tom.gom.adt.gom.types.grammarlist.EmptyConcGrammar)) ) {{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_begin_22=tomMatch510NameNumber_freshVar_20;{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_end_23=tomMatch510NameNumber_freshVar_20;do {{{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_freshVar_21=tomMatch510NameNumber_end_23;if (!( tomMatch510NameNumber_freshVar_21.isEmptyConcGrammar() )) {{  tom.gom.adt.gom.types.Grammar  tomMatch510NameNumber_freshVar_27= tomMatch510NameNumber_freshVar_21.getHeadConcGrammar() ;if ( (tomMatch510NameNumber_freshVar_27 instanceof tom.gom.adt.gom.types.grammar.Grammar) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch510NameNumber_freshVar_26= tomMatch510NameNumber_freshVar_27.getProductionList() ;{  tom.gom.adt.gom.types.ProductionList  tom_prodList=tomMatch510NameNumber_freshVar_26;{  tom.gom.adt.gom.types.GrammarList  tomMatch510NameNumber_freshVar_24= tomMatch510NameNumber_freshVar_21.getTailConcGrammar() ;{  tom.gom.adt.gom.types.SectionList  tomMatch510NameNumber_freshVar_16= tomMatch510NameNumber_freshVar_13.getTailConcSection() ;{  tom.gom.adt.gom.types.GomModuleList  tomMatch510NameNumber_freshVar_5= tomMatch510NameNumber_freshVar_2.getTailConcGomModule() ;{{ Object tomMatch511NameNumber_freshVar_0=tom_prodList;if ( (tomMatch511NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ProductionList) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ProductionList )tomMatch511NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_freshVar_1=tomMatch511NameNumber_freshSubject_1;if ( ((tomMatch511NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch511NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_begin_3=tomMatch511NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_end_4=tomMatch511NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_freshVar_2=tomMatch511NameNumber_end_4;if (!( tomMatch511NameNumber_freshVar_2.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.Production  tom_prod= tomMatch511NameNumber_freshVar_2.getHeadConcProduction() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch511NameNumber_freshVar_5= tomMatch511NameNumber_freshVar_2.getTailConcProduction() ;











            /* Process hooks attached to a module */
            {{ Object tomMatch512NameNumber_freshVar_0=tom_prod;if ( (tomMatch512NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch512NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshVar_4=tomMatch512NameNumber_freshSubject_1;if ( (tomMatch512NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.production.Hook) ) {{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_1= tomMatch512NameNumber_freshVar_4.getNameType() ;{  tom.gom.adt.gom.types.HookKind  tomMatch512NameNumber_freshVar_2= tomMatch512NameNumber_freshVar_4.getHookType() ;{  String  tomMatch512NameNumber_freshVar_3= tomMatch512NameNumber_freshVar_4.getName() ;{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_5=tomMatch512NameNumber_freshVar_1;if ( (tomMatch512NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.idkind.KindModule) ) {{  String  tom_mname=tomMatch512NameNumber_freshVar_3;

                //Graph-rewrite rules hooks are only allowed for sorts
                if(tomMatch512NameNumber_freshVar_2.getkind().equals("graphrules")) {
                  getLogger().log(Level.SEVERE,
                      "Grapphrules hooks are authorised only on sorts");

                }
                if(tom_mname.equals(tom_moduleName)) {
                  ModuleDecl mdecl = getModuleDecl(tom_mname,moduleList);
                  HookDeclList newDeclList =
                    makeHookDeclList(tomMatch512NameNumber_freshSubject_1, tom.gom.adt.gom.types.decl.CutModule.make(mdecl) );
                  hookList = tom_append_list_ConcHookDecl(newDeclList,tom_append_list_ConcHookDecl(hookList, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ));
                } else {
                  getLogger().log(Level.SEVERE,
                      "Hooks on module are authorised only on the current module");
                }
              }}}}}}}}}}}{ Object tomMatch512NameNumber_freshVar_6=tom_prod;if ( (tomMatch512NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch512NameNumber_freshVar_6);{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshVar_9=tomMatch512NameNumber_freshSubject_1;if ( (tomMatch512NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.production.Hook) ) {{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_7= tomMatch512NameNumber_freshVar_9.getNameType() ;{  String  tomMatch512NameNumber_freshVar_8= tomMatch512NameNumber_freshVar_9.getName() ;{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_10=tomMatch512NameNumber_freshVar_7;if ( (tomMatch512NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.idkind.KindSort) ) {

                SortDecl sdecl = getSortDecl(tomMatch512NameNumber_freshVar_8,tom_moduleName,moduleList);
                HookDeclList newDeclList = makeHookDeclList(tomMatch512NameNumber_freshSubject_1, tom.gom.adt.gom.types.decl.CutSort.make(sdecl) );
                hookList = tom_append_list_ConcHookDecl(newDeclList,tom_append_list_ConcHookDecl(hookList, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ));
              }}}}}}}}}{ Object tomMatch512NameNumber_freshVar_11=tom_prod;if ( (tomMatch512NameNumber_freshVar_11 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch512NameNumber_freshVar_11);{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshVar_15=tomMatch512NameNumber_freshSubject_1;if ( (tomMatch512NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.production.Hook) ) {{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_12= tomMatch512NameNumber_freshVar_15.getNameType() ;{  tom.gom.adt.gom.types.HookKind  tomMatch512NameNumber_freshVar_13= tomMatch512NameNumber_freshVar_15.getHookType() ;{  String  tomMatch512NameNumber_freshVar_14= tomMatch512NameNumber_freshVar_15.getName() ;{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_16=tomMatch512NameNumber_freshVar_12;if ( (tomMatch512NameNumber_freshVar_16 instanceof tom.gom.adt.gom.types.idkind.KindOperator) ) {

                //Graph-rewrite rules hooks are only allowed for sorts
                if(tomMatch512NameNumber_freshVar_13.getkind().equals("graphrules")) {
                  getLogger().log(Level.SEVERE,
                      "Grapphrules hooks are authorised only on sorts");

                }
                OperatorDecl odecl = getOperatorDecl(tomMatch512NameNumber_freshVar_14,tom_moduleName,moduleList);
                if(odecl!=null) {
                  HookDeclList newDeclList = makeHookDeclList(tomMatch512NameNumber_freshSubject_1, tom.gom.adt.gom.types.decl.CutOperator.make(odecl) );
                  hookList = tom_append_list_ConcHookDecl(newDeclList,tom_append_list_ConcHookDecl(hookList, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ));
                }
              }}}}}}}}}}{ Object tomMatch512NameNumber_freshVar_17=tom_prod;if ( (tomMatch512NameNumber_freshVar_17 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch512NameNumber_freshVar_17);{  tom.gom.adt.gom.types.Production  tomMatch512NameNumber_freshVar_21=tomMatch512NameNumber_freshSubject_1;if ( (tomMatch512NameNumber_freshVar_21 instanceof tom.gom.adt.gom.types.production.Hook) ) {{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_18= tomMatch512NameNumber_freshVar_21.getNameType() ;{  tom.gom.adt.gom.types.HookKind  tomMatch512NameNumber_freshVar_19= tomMatch512NameNumber_freshVar_21.getHookType() ;{  String  tomMatch512NameNumber_freshVar_20= tomMatch512NameNumber_freshVar_21.getName() ;{  tom.gom.adt.gom.types.IdKind  tomMatch512NameNumber_freshVar_23=tomMatch512NameNumber_freshVar_18;if ( (tomMatch512NameNumber_freshVar_23 instanceof tom.gom.adt.gom.types.idkind.KindFutureOperator) ) {{  tom.gom.adt.gom.types.Future  tomMatch512NameNumber_freshVar_22= tomMatch512NameNumber_freshVar_23.getConsOrNil() ;

                OperatorDecl odecl = getOperatorDecl(tomMatch512NameNumber_freshVar_20,tom_moduleName,moduleList);
                if(odecl!=null) {
                  HookDeclList newDeclList = 
                    makeHookDeclList(tomMatch512NameNumber_freshSubject_1, tom.gom.adt.gom.types.decl.CutFutureOperator.make(odecl, tomMatch512NameNumber_freshVar_22) );
                  hookList = tom_append_list_ConcHookDecl(newDeclList,tom_append_list_ConcHookDecl(hookList, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ));
                }
              }}}}}}}}}}}}

          }}}}if ( tomMatch511NameNumber_end_4.isEmptyConcProduction() ) {tomMatch511NameNumber_end_4=tomMatch511NameNumber_begin_3;} else {tomMatch511NameNumber_end_4= tomMatch511NameNumber_end_4.getTailConcProduction() ;}}} while(!( (tomMatch511NameNumber_end_4==tomMatch511NameNumber_begin_3) ));}}}}}}}}

        ArrayList examinedOps = new ArrayList();
        {{ Object tomMatch513NameNumber_freshVar_0=tom_prodList;if ( (tomMatch513NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ProductionList) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ProductionList )tomMatch513NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_freshVar_1=tomMatch513NameNumber_freshSubject_1;if ( ((tomMatch513NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch513NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_begin_3=tomMatch513NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_end_4=tomMatch513NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_freshVar_2=tomMatch513NameNumber_end_4;if (!( tomMatch513NameNumber_freshVar_2.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.ProductionList  tomMatch513NameNumber_freshVar_5= tomMatch513NameNumber_freshVar_2.getTailConcProduction() ;

            hookList = addDefaultTheoryHooks( tomMatch513NameNumber_freshVar_2.getHeadConcProduction() ,hookList,examinedOps,tom_moduleName);
          }}}if ( tomMatch513NameNumber_end_4.isEmptyConcProduction() ) {tomMatch513NameNumber_end_4=tomMatch513NameNumber_begin_3;} else {tomMatch513NameNumber_end_4= tomMatch513NameNumber_end_4.getTailConcProduction() ;}}} while(!( (tomMatch513NameNumber_end_4==tomMatch513NameNumber_begin_3) ));}}}}}}}}{{ Object tomMatch514NameNumber_freshVar_0=tom_prodList;if ( (tomMatch514NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ProductionList) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ProductionList )tomMatch514NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_1=tomMatch514NameNumber_freshSubject_1;if ( ((tomMatch514NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch514NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_begin_3=tomMatch514NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_end_4=tomMatch514NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_2=tomMatch514NameNumber_end_4;if (!( tomMatch514NameNumber_freshVar_2.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.Production  tomMatch514NameNumber_freshVar_8= tomMatch514NameNumber_freshVar_2.getHeadConcProduction() ;if ( (tomMatch514NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.production.SortType) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_7= tomMatch514NameNumber_freshVar_8.getProductionList() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_9=tomMatch514NameNumber_freshVar_7;if ( ((tomMatch514NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch514NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_begin_11=tomMatch514NameNumber_freshVar_9;{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_end_12=tomMatch514NameNumber_freshVar_9;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_10=tomMatch514NameNumber_end_12;if (!( tomMatch514NameNumber_freshVar_10.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_13= tomMatch514NameNumber_freshVar_10.getTailConcProduction() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch514NameNumber_freshVar_5= tomMatch514NameNumber_freshVar_2.getTailConcProduction() ;



            hookList = addDefaultTheoryHooks( tomMatch514NameNumber_freshVar_10.getHeadConcProduction() ,hookList,examinedOps,tom_moduleName);
          }}}}if ( tomMatch514NameNumber_end_12.isEmptyConcProduction() ) {tomMatch514NameNumber_end_12=tomMatch514NameNumber_begin_11;} else {tomMatch514NameNumber_end_12= tomMatch514NameNumber_end_12.getTailConcProduction() ;}}} while(!( (tomMatch514NameNumber_end_12==tomMatch514NameNumber_begin_11) ));}}}}}}}}}if ( tomMatch514NameNumber_end_4.isEmptyConcProduction() ) {tomMatch514NameNumber_end_4=tomMatch514NameNumber_begin_3;} else {tomMatch514NameNumber_end_4= tomMatch514NameNumber_end_4.getTailConcProduction() ;}}} while(!( (tomMatch514NameNumber_end_4==tomMatch514NameNumber_begin_3) ));}}}}}}}}

      }}}}}}}}}if ( tomMatch510NameNumber_end_23.isEmptyConcGrammar() ) {tomMatch510NameNumber_end_23=tomMatch510NameNumber_begin_22;} else {tomMatch510NameNumber_end_23= tomMatch510NameNumber_end_23.getTailConcGrammar() ;}}} while(!( (tomMatch510NameNumber_end_23==tomMatch510NameNumber_begin_22) ));}}}}}}}}}if ( tomMatch510NameNumber_end_15.isEmptyConcSection() ) {tomMatch510NameNumber_end_15=tomMatch510NameNumber_begin_14;} else {tomMatch510NameNumber_end_15= tomMatch510NameNumber_end_15.getTailConcSection() ;}}} while(!( (tomMatch510NameNumber_end_15==tomMatch510NameNumber_begin_14) ));}}}}}}}}}}}}}}if ( tomMatch510NameNumber_end_4.isEmptyConcGomModule() ) {tomMatch510NameNumber_end_4=tomMatch510NameNumber_begin_3;} else {tomMatch510NameNumber_end_4= tomMatch510NameNumber_end_4.getTailConcGomModule() ;}}} while(!( (tomMatch510NameNumber_end_4==tomMatch510NameNumber_begin_3) ));}}}}}}}}

    return hookList;
  }

  private HookDeclList addDefaultTheoryHooks(Production prod,
                                             HookDeclList hookList,
                                             ArrayList examinedOps,
                                             String moduleName) {
    {{ Object tomMatch515NameNumber_freshVar_0=prod;if ( (tomMatch515NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch515NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch515NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Production  tomMatch515NameNumber_freshVar_6=tomMatch515NameNumber_freshSubject_1;if ( (tomMatch515NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.production.Production) ) {{  String  tomMatch515NameNumber_freshVar_2= tomMatch515NameNumber_freshVar_6.getName() ;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_3= tomMatch515NameNumber_freshVar_6.getDomainList() ;{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_4= tomMatch515NameNumber_freshVar_6.getCodomain() ;{  tom.gom.adt.gom.types.Option  tomMatch515NameNumber_freshVar_5= tomMatch515NameNumber_freshVar_6.getOption() ;{  String  tom_opName=tomMatch515NameNumber_freshVar_2;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_7=tomMatch515NameNumber_freshVar_3;if ( ((tomMatch515NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.fieldlist.ConsConcField) || (tomMatch515NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.fieldlist.EmptyConcField)) ) {if (!( tomMatch515NameNumber_freshVar_7.isEmptyConcField() )) {{  tom.gom.adt.gom.types.Field  tomMatch515NameNumber_freshVar_11= tomMatch515NameNumber_freshVar_7.getHeadConcField() ;if ( (tomMatch515NameNumber_freshVar_11 instanceof tom.gom.adt.gom.types.field.StarredField) ) {{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_9= tomMatch515NameNumber_freshVar_11.getFieldType() ;{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch515NameNumber_freshVar_10= tomMatch515NameNumber_freshVar_11.getSpecifier() ;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_8= tomMatch515NameNumber_freshVar_7.getTailConcField() ;if ( tomMatch515NameNumber_freshVar_8.isEmptyConcField() ) {{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_18=tomMatch515NameNumber_freshVar_4;if ( (tomMatch515NameNumber_freshVar_18==tomMatch515NameNumber_freshVar_9) ) {{ Object tomMatch515NameNumber_freshVar_1=hookList;if ( (tomMatch515NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.HookDeclList) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.HookDeclList )tomMatch515NameNumber_freshVar_1);{ boolean tomMatch515NameNumber_freshVar_26= false ;{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_12=tomMatch515NameNumber_freshSubject_2;if ( ((tomMatch515NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl) || (tomMatch515NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl)) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_begin_14=tomMatch515NameNumber_freshVar_12;{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_end_15=tomMatch515NameNumber_freshVar_12;do {{{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_13=tomMatch515NameNumber_end_15;if (!( tomMatch515NameNumber_freshVar_13.isEmptyConcHookDecl() )) {{  tom.gom.adt.gom.types.HookDecl  tomMatch515NameNumber_freshVar_20= tomMatch515NameNumber_freshVar_13.getHeadConcHookDecl() ;if ( (tomMatch515NameNumber_freshVar_20 instanceof tom.gom.adt.gom.types.hookdecl.MakeHookDecl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch515NameNumber_freshVar_19= tomMatch515NameNumber_freshVar_20.getPointcut() ;{  tom.gom.adt.gom.types.Decl  tomMatch515NameNumber_freshVar_22=tomMatch515NameNumber_freshVar_19;if ( (tomMatch515NameNumber_freshVar_22 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch515NameNumber_freshVar_21= tomMatch515NameNumber_freshVar_22.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch515NameNumber_freshVar_24=tomMatch515NameNumber_freshVar_21;if ( (tomMatch515NameNumber_freshVar_24 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  String  tomMatch515NameNumber_freshVar_23= tomMatch515NameNumber_freshVar_24.getName() ;{  String  tomMatch515NameNumber_freshVar_25=tomMatch515NameNumber_freshVar_23;if ( tomMatch515NameNumber_freshVar_25.equals(tom_opName) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_16= tomMatch515NameNumber_freshVar_13.getTailConcHookDecl() ;tomMatch515NameNumber_freshVar_26= true ;}}}}}}}}}}}}}}if ( tomMatch515NameNumber_end_15.isEmptyConcHookDecl() ) {tomMatch515NameNumber_end_15=tomMatch515NameNumber_begin_14;} else {tomMatch515NameNumber_end_15= tomMatch515NameNumber_end_15.getTailConcHookDecl() ;}}} while(!( (tomMatch515NameNumber_end_15==tomMatch515NameNumber_begin_14) ));}}}}if ((tomMatch515NameNumber_freshVar_26 ==  false )) {




        /* generate a FL hook for list-operators without other hook */
        String emptyCode = "{}";
        Production hook =  tom.gom.adt.gom.types.production.Hook.make( tom.gom.adt.gom.types.idkind.KindOperator.make() , tom_opName,  tom.gom.adt.gom.types.hookkind.HookKind.make("FL") ,  tom.gom.adt.gom.types.arglist.EmptyConcArg.make() , emptyCode,  tom.gom.adt.gom.types.option.EmptyOptionList.make() ) ;
        OperatorDecl odecl = getOperatorDecl(tom_opName,moduleName,moduleList);
        if(odecl!=null) {
          HookDeclList newDeclList = makeHookDeclList(hook, tom.gom.adt.gom.types.decl.CutOperator.make(odecl) );
          hookList = tom_append_list_ConcHookDecl(newDeclList,tom_append_list_ConcHookDecl(hookList, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ));
        }
      }}}}}}}}}}}}}}}}}}}}}}}}}}{ Object tomMatch515NameNumber_freshVar_27=prod;if ( (tomMatch515NameNumber_freshVar_27 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch515NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch515NameNumber_freshVar_27);{  tom.gom.adt.gom.types.Production  tomMatch515NameNumber_freshVar_33=tomMatch515NameNumber_freshSubject_1;if ( (tomMatch515NameNumber_freshVar_33 instanceof tom.gom.adt.gom.types.production.Production) ) {{  String  tomMatch515NameNumber_freshVar_29= tomMatch515NameNumber_freshVar_33.getName() ;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_30= tomMatch515NameNumber_freshVar_33.getDomainList() ;{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_31= tomMatch515NameNumber_freshVar_33.getCodomain() ;{  tom.gom.adt.gom.types.Option  tomMatch515NameNumber_freshVar_32= tomMatch515NameNumber_freshVar_33.getOption() ;{  String  tom_opName=tomMatch515NameNumber_freshVar_29;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_34=tomMatch515NameNumber_freshVar_30;if ( ((tomMatch515NameNumber_freshVar_34 instanceof tom.gom.adt.gom.types.fieldlist.ConsConcField) || (tomMatch515NameNumber_freshVar_34 instanceof tom.gom.adt.gom.types.fieldlist.EmptyConcField)) ) {if (!( tomMatch515NameNumber_freshVar_34.isEmptyConcField() )) {{  tom.gom.adt.gom.types.Field  tomMatch515NameNumber_freshVar_44= tomMatch515NameNumber_freshVar_34.getHeadConcField() ;if ( (tomMatch515NameNumber_freshVar_44 instanceof tom.gom.adt.gom.types.field.StarredField) ) {{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_42= tomMatch515NameNumber_freshVar_44.getFieldType() ;{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch515NameNumber_freshVar_43= tomMatch515NameNumber_freshVar_44.getSpecifier() ;{  tom.gom.adt.gom.types.FieldList  tomMatch515NameNumber_freshVar_35= tomMatch515NameNumber_freshVar_34.getTailConcField() ;if ( tomMatch515NameNumber_freshVar_35.isEmptyConcField() ) {{  tom.gom.adt.gom.types.GomType  tomMatch515NameNumber_freshVar_50=tomMatch515NameNumber_freshVar_31;if ( (tomMatch515NameNumber_freshVar_50==tomMatch515NameNumber_freshVar_42) ) {{ Object tomMatch515NameNumber_freshVar_28=hookList;if ( (tomMatch515NameNumber_freshVar_28 instanceof tom.gom.adt.gom.types.HookDeclList) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.HookDeclList )tomMatch515NameNumber_freshVar_28);{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_36=tomMatch515NameNumber_freshSubject_2;if ( ((tomMatch515NameNumber_freshVar_36 instanceof tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl) || (tomMatch515NameNumber_freshVar_36 instanceof tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl)) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_begin_38=tomMatch515NameNumber_freshVar_36;{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_end_39=tomMatch515NameNumber_freshVar_36;do {{{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_37=tomMatch515NameNumber_end_39;if (!( tomMatch515NameNumber_freshVar_37.isEmptyConcHookDecl() )) {{  tom.gom.adt.gom.types.HookDecl  tomMatch515NameNumber_freshVar_46= tomMatch515NameNumber_freshVar_37.getHeadConcHookDecl() ;if ( (tomMatch515NameNumber_freshVar_46 instanceof tom.gom.adt.gom.types.hookdecl.MakeHookDecl) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch515NameNumber_freshVar_45= tomMatch515NameNumber_freshVar_46.getHookType() ;{  tom.gom.adt.gom.types.HookKind  tomMatch515NameNumber_freshVar_48=tomMatch515NameNumber_freshVar_45;if ( (tomMatch515NameNumber_freshVar_48 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch515NameNumber_freshVar_47= tomMatch515NameNumber_freshVar_48.getkind() ;{  String  tomMatch515NameNumber_freshVar_49=tomMatch515NameNumber_freshVar_47;{ boolean tomMatch515NameNumber_freshVar_51= false ;if ( "make_insert".equals(tomMatch515NameNumber_freshVar_49) ) {tomMatch515NameNumber_freshVar_51= true ;} else {if ( "make_empty".equals(tomMatch515NameNumber_freshVar_49) ) {tomMatch515NameNumber_freshVar_51= true ;} else {if ( "rules".equals(tomMatch515NameNumber_freshVar_49) ) {tomMatch515NameNumber_freshVar_51= true ;}}}if ((tomMatch515NameNumber_freshVar_51 ==  true )) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch515NameNumber_freshVar_40= tomMatch515NameNumber_freshVar_37.getTailConcHookDecl() ;




        if(! examinedOps.contains(tom_opName)) {
          examinedOps.add(tom_opName);
          {{ Object tomMatch516NameNumber_freshVar_0=hookList;if ( (tomMatch516NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.HookDeclList) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookDeclList )tomMatch516NameNumber_freshVar_0);{ boolean tomMatch516NameNumber_freshVar_17= false ;{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_freshVar_1=tomMatch516NameNumber_freshSubject_1;if ( ((tomMatch516NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl) || (tomMatch516NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl)) ) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_begin_3=tomMatch516NameNumber_freshVar_1;{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_end_4=tomMatch516NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_freshVar_2=tomMatch516NameNumber_end_4;if (!( tomMatch516NameNumber_freshVar_2.isEmptyConcHookDecl() )) {{  tom.gom.adt.gom.types.HookDecl  tomMatch516NameNumber_freshVar_9= tomMatch516NameNumber_freshVar_2.getHeadConcHookDecl() ;if ( (tomMatch516NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.hookdecl.MakeHookDecl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch516NameNumber_freshVar_7= tomMatch516NameNumber_freshVar_9.getPointcut() ;{  tom.gom.adt.gom.types.HookKind  tomMatch516NameNumber_freshVar_8= tomMatch516NameNumber_freshVar_9.getHookType() ;{  tom.gom.adt.gom.types.Decl  tomMatch516NameNumber_freshVar_11=tomMatch516NameNumber_freshVar_7;if ( (tomMatch516NameNumber_freshVar_11 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch516NameNumber_freshVar_10= tomMatch516NameNumber_freshVar_11.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch516NameNumber_freshVar_13=tomMatch516NameNumber_freshVar_10;if ( (tomMatch516NameNumber_freshVar_13 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  String  tomMatch516NameNumber_freshVar_12= tomMatch516NameNumber_freshVar_13.getName() ;{  tom.gom.adt.gom.types.HookKind  tomMatch516NameNumber_freshVar_15=tomMatch516NameNumber_freshVar_8;if ( (tomMatch516NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch516NameNumber_freshVar_14= tomMatch516NameNumber_freshVar_15.getkind() ;{  String  tomMatch516NameNumber_freshVar_16=tomMatch516NameNumber_freshVar_14;{ boolean tomMatch516NameNumber_freshVar_18= false ;if ( "Free".equals(tomMatch516NameNumber_freshVar_16) ) {tomMatch516NameNumber_freshVar_18= true ;} else {if ( "FL".equals(tomMatch516NameNumber_freshVar_16) ) {tomMatch516NameNumber_freshVar_18= true ;} else {if ( "AU".equals(tomMatch516NameNumber_freshVar_16) ) {tomMatch516NameNumber_freshVar_18= true ;} else {if ( "ACU".equals(tomMatch516NameNumber_freshVar_16) ) {tomMatch516NameNumber_freshVar_18= true ;}}}}if ((tomMatch516NameNumber_freshVar_18 ==  true )) {{  tom.gom.adt.gom.types.HookDeclList  tomMatch516NameNumber_freshVar_5= tomMatch516NameNumber_freshVar_2.getTailConcHookDecl() ;tomMatch516NameNumber_freshVar_17= true ;}}}}}}}}}}}}}}}}}}}if ( tomMatch516NameNumber_end_4.isEmptyConcHookDecl() ) {tomMatch516NameNumber_end_4=tomMatch516NameNumber_begin_3;} else {tomMatch516NameNumber_end_4= tomMatch516NameNumber_end_4.getTailConcHookDecl() ;}}} while(!( (tomMatch516NameNumber_end_4==tomMatch516NameNumber_begin_3) ));}}}}if ((tomMatch516NameNumber_freshVar_17 ==  false )) {


              /* generate an error to make users specify the theory */
              getLogger().log(Level.SEVERE,
                "As you use make_insert, make_empty or rules, specify the associated theory for the variadic operator "+tom_opName);
            }}}}}}

        }
      }}}}}}}}}}}}if ( tomMatch515NameNumber_end_39.isEmptyConcHookDecl() ) {tomMatch515NameNumber_end_39=tomMatch515NameNumber_begin_38;} else {tomMatch515NameNumber_end_39= tomMatch515NameNumber_end_39.getTailConcHookDecl() ;}}} while(!( (tomMatch515NameNumber_end_39==tomMatch515NameNumber_begin_38) ));}}}}}}}}}}}}}}}}}}}}}}}}}}}}}

    return hookList;
  }

  private HookDeclList makeHookDeclList(Production hook, Decl mdecl) {
    {{ Object tomMatch517NameNumber_freshVar_0=hook;if ( (tomMatch517NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch517NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch517NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Production  tomMatch517NameNumber_freshVar_5=tomMatch517NameNumber_freshSubject_1;if ( (tomMatch517NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.production.Hook) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch517NameNumber_freshVar_1= tomMatch517NameNumber_freshVar_5.getHookType() ;{  String  tomMatch517NameNumber_freshVar_2= tomMatch517NameNumber_freshVar_5.getName() ;{  tom.gom.adt.gom.types.ArgList  tomMatch517NameNumber_freshVar_3= tomMatch517NameNumber_freshVar_5.getArgs() ;{  String  tomMatch517NameNumber_freshVar_4= tomMatch517NameNumber_freshVar_5.getStringCode() ;{  tom.gom.adt.gom.types.HookKind  tom_hkind=tomMatch517NameNumber_freshVar_1;{  String  tom_hName=tomMatch517NameNumber_freshVar_2;{  tom.gom.adt.gom.types.ArgList  tom_hookArgs=tomMatch517NameNumber_freshVar_3;{  String  tom_scode=tomMatch517NameNumber_freshVar_4;




          HookDeclList newHookList =  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
          {{ Object tomMatch518NameNumber_freshVar_0=tom_hkind;if ( (tomMatch518NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_0);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_2=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_1= tomMatch518NameNumber_freshVar_2.getkind() ;{  String  tomMatch518NameNumber_freshVar_3=tomMatch518NameNumber_freshVar_1;if ( "block".equals(tomMatch518NameNumber_freshVar_3) ) {

              newHookList =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.BlockHookDecl.make(mdecl,  tom.gom.adt.code.types.code.Code.make(trimBracket(tom_scode)) ) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_4=tom_hkind;if ( (tomMatch518NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_4);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_6=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_5= tomMatch518NameNumber_freshVar_6.getkind() ;{  String  tomMatch518NameNumber_freshVar_7=tomMatch518NameNumber_freshVar_5;if ( "interface".equals(tomMatch518NameNumber_freshVar_7) ) {

              newHookList =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.InterfaceHookDecl.make(mdecl,  tom.gom.adt.code.types.code.Code.make(trimBracket(tom_scode)) ) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_8=tom_hkind;if ( (tomMatch518NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_8);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_10=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_9= tomMatch518NameNumber_freshVar_10.getkind() ;{  String  tomMatch518NameNumber_freshVar_11=tomMatch518NameNumber_freshVar_9;if ( "import".equals(tomMatch518NameNumber_freshVar_11) ) {

              newHookList =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.ImportHookDecl.make(mdecl,  tom.gom.adt.code.types.code.Code.make(trimBracket(tom_scode)) ) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_12=tom_hkind;if ( (tomMatch518NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_12);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_14=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_14 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_13= tomMatch518NameNumber_freshVar_14.getkind() ;{  String  tomMatch518NameNumber_freshVar_15=tomMatch518NameNumber_freshVar_13;if ( "mapping".equals(tomMatch518NameNumber_freshVar_15) ) {

              newHookList =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MappingHookDecl.make(mdecl,  tom.gom.adt.code.types.code.Code.make(trimBracket(tom_scode)) ) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_16=tom_hkind;if ( (tomMatch518NameNumber_freshVar_16 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_16);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_18=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_18 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_17= tomMatch518NameNumber_freshVar_18.getkind() ;{  String  tomMatch518NameNumber_freshVar_19=tomMatch518NameNumber_freshVar_17;{ boolean tomMatch518NameNumber_freshVar_20= false ;if ( "make".equals(tomMatch518NameNumber_freshVar_19) ) {tomMatch518NameNumber_freshVar_20= true ;} else {if ( "make_insert".equals(tomMatch518NameNumber_freshVar_19) ) {tomMatch518NameNumber_freshVar_20= true ;} else {if ( "make_empty".equals(tomMatch518NameNumber_freshVar_19) ) {tomMatch518NameNumber_freshVar_20= true ;}}}if ((tomMatch518NameNumber_freshVar_20 ==  true )) {

              SlotList typedArgs = typeArguments(tom_hookArgs,tom_hkind,mdecl);
              if (typedArgs == null) {
                getLogger().log(Level.SEVERE,
                    GomMessage.discardedHook.getMessage(),
                    new Object[]{ (tom_hName) });
                return  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
              }
              newHookList =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl, typedArgs,  tom.gom.adt.code.types.code.Code.make(tom_scode) , tomMatch518NameNumber_freshSubject_1) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}}{ Object tomMatch518NameNumber_freshVar_21=tom_hkind;if ( (tomMatch518NameNumber_freshVar_21 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_21);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_23=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_23 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_22= tomMatch518NameNumber_freshVar_23.getkind() ;{  String  tomMatch518NameNumber_freshVar_24=tomMatch518NameNumber_freshVar_22;if ( "Free".equals(tomMatch518NameNumber_freshVar_24) ) {

              /* Even there is no code associated, we generate a MakeHook to prevent FL hooks to be automatically generated */
              return  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ,  tom.gom.adt.code.types.code.Code.make("") ,  tom.gom.adt.gom.types.hookkind.HookKind.make("Free") ) , tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) 
;
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_25=tom_hkind;if ( (tomMatch518NameNumber_freshVar_25 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_25);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_27=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_27 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_26= tomMatch518NameNumber_freshVar_27.getkind() ;{  String  tomMatch518NameNumber_freshVar_28=tomMatch518NameNumber_freshVar_26;if ( "FL".equals(tomMatch518NameNumber_freshVar_28) ) {

              /* FL: flattened list */
              return makeFLHookList(tom_hName,mdecl,tom_scode);
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_29=tom_hkind;if ( (tomMatch518NameNumber_freshVar_29 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_29);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_31=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_31 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_30= tomMatch518NameNumber_freshVar_31.getkind() ;{  String  tomMatch518NameNumber_freshVar_32=tomMatch518NameNumber_freshVar_30;if ( "AU".equals(tomMatch518NameNumber_freshVar_32) ) {

              return makeAUHookList(tom_hName,mdecl,tom_scode);
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_33=tom_hkind;if ( (tomMatch518NameNumber_freshVar_33 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_33);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_35=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_35 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_34= tomMatch518NameNumber_freshVar_35.getkind() ;{  String  tomMatch518NameNumber_freshVar_36=tomMatch518NameNumber_freshVar_34;if ( "ACU".equals(tomMatch518NameNumber_freshVar_36) ) {

              return makeACUHookList(tom_hName,mdecl,tom_scode);
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_37=tom_hkind;if ( (tomMatch518NameNumber_freshVar_37 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_37);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_39=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_39 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_38= tomMatch518NameNumber_freshVar_39.getkind() ;{  String  tomMatch518NameNumber_freshVar_40=tomMatch518NameNumber_freshVar_38;if ( "rules".equals(tomMatch518NameNumber_freshVar_40) ) {

              return makeRulesHookList(tom_hName,mdecl,tom_scode);
            }}}}}}}}{ Object tomMatch518NameNumber_freshVar_41=tom_hkind;if ( (tomMatch518NameNumber_freshVar_41 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch518NameNumber_freshVar_41);{  tom.gom.adt.gom.types.HookKind  tomMatch518NameNumber_freshVar_43=tomMatch518NameNumber_freshSubject_1;if ( (tomMatch518NameNumber_freshVar_43 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch518NameNumber_freshVar_42= tomMatch518NameNumber_freshVar_43.getkind() ;{  String  tomMatch518NameNumber_freshVar_44=tomMatch518NameNumber_freshVar_42;if ( "graphrules".equals(tomMatch518NameNumber_freshVar_44) ) {

              //TODO: verify if the option termgraph is on
              if(tom_hookArgs.length()!=2) {
                throw new GomRuntimeException(
                    "GomTypeExpander:graphrules hooks need two parameters: the name of the generated strategy and its default behaviour");
              }
              return makeGraphRulesHookList(tom_hName,tom_hookArgs,mdecl,tom_scode);
            }}}}}}}}}

          if (newHookList ==  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ) {
            getLogger().log(Level.SEVERE, GomMessage.unknownHookKind.getMessage(), new Object[]{ (tom_hkind) });
          }
          return newHookList;
        }}}}}}}}}}}}}}

    throw new GomRuntimeException("HookTypeExpander: this hook is not a hook: "+ hook);
  }

  /**
   * Finds the ModuleDecl corresponding to a module name.
   *
   * @param mname the module name
   * @param moduleList the queried ModuleList
   * @return the ModuleDecl for mname
   */
  private ModuleDecl getModuleDecl(String mname, ModuleList moduleList) {
    {{ Object tomMatch519NameNumber_freshVar_0=moduleList;if ( (tomMatch519NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ModuleList) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ModuleList )tomMatch519NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_freshVar_1=tomMatch519NameNumber_freshSubject_1;if ( ((tomMatch519NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.modulelist.ConsConcModule) || (tomMatch519NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.modulelist.EmptyConcModule)) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_begin_3=tomMatch519NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_end_4=tomMatch519NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_freshVar_2=tomMatch519NameNumber_end_4;if (!( tomMatch519NameNumber_freshVar_2.isEmptyConcModule() )) {{  tom.gom.adt.gom.types.Module  tomMatch519NameNumber_freshVar_8= tomMatch519NameNumber_freshVar_2.getHeadConcModule() ;if ( (tomMatch519NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.module.Module) ) {{  tom.gom.adt.gom.types.ModuleDecl  tomMatch519NameNumber_freshVar_7= tomMatch519NameNumber_freshVar_8.getMDecl() ;{  tom.gom.adt.gom.types.ModuleDecl  tomMatch519NameNumber_freshVar_10=tomMatch519NameNumber_freshVar_7;if ( (tomMatch519NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.moduledecl.ModuleDecl) ) {{  tom.gom.adt.gom.types.GomModuleName  tomMatch519NameNumber_freshVar_9= tomMatch519NameNumber_freshVar_10.getModuleName() ;{  tom.gom.adt.gom.types.GomModuleName  tomMatch519NameNumber_freshVar_12=tomMatch519NameNumber_freshVar_9;if ( (tomMatch519NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.gommodulename.GomModuleName) ) {{  String  tomMatch519NameNumber_freshVar_11= tomMatch519NameNumber_freshVar_12.getName() ;{  tom.gom.adt.gom.types.ModuleList  tomMatch519NameNumber_freshVar_5= tomMatch519NameNumber_freshVar_2.getTailConcModule() ;




        if (tomMatch519NameNumber_freshVar_11.equals(mname)) {
          return tomMatch519NameNumber_freshVar_7;
        }
      }}}}}}}}}}}}if ( tomMatch519NameNumber_end_4.isEmptyConcModule() ) {tomMatch519NameNumber_end_4=tomMatch519NameNumber_begin_3;} else {tomMatch519NameNumber_end_4= tomMatch519NameNumber_end_4.getTailConcModule() ;}}} while(!( (tomMatch519NameNumber_end_4==tomMatch519NameNumber_begin_3) ));}}}}}}}}

    throw new GomRuntimeException(
        "HookTypeExpander: Module not found: "+mname);
  }

  /**
   * Finds the SortDecl corresponding to a sort name.
   *
   * @param sname the sort name
   * @param modName the module name that should contain the sort
   * @param moduleList the queried ModuleList
   * @return the SortDecl for sname
   */
  private SortDecl getSortDecl(String sname, String modName, ModuleList moduleList) {
    {{  String  tomMatch520NameNumber_freshVar_0=modName;if ( true ) {{  String  tomMatch520NameNumber_freshSubject_1=(( String )tomMatch520NameNumber_freshVar_0);{ Object tomMatch520NameNumber_freshVar_1=moduleList;if ( (tomMatch520NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.ModuleList) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.ModuleList )tomMatch520NameNumber_freshVar_1);{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_freshVar_2=tomMatch520NameNumber_freshSubject_2;if ( ((tomMatch520NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.modulelist.ConsConcModule) || (tomMatch520NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.modulelist.EmptyConcModule)) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_begin_4=tomMatch520NameNumber_freshVar_2;{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_end_5=tomMatch520NameNumber_freshVar_2;do {{{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_freshVar_3=tomMatch520NameNumber_end_5;if (!( tomMatch520NameNumber_freshVar_3.isEmptyConcModule() )) {{  tom.gom.adt.gom.types.Module  tomMatch520NameNumber_freshVar_10= tomMatch520NameNumber_freshVar_3.getHeadConcModule() ;if ( (tomMatch520NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.module.Module) ) {{  tom.gom.adt.gom.types.ModuleDecl  tomMatch520NameNumber_freshVar_8= tomMatch520NameNumber_freshVar_10.getMDecl() ;{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_freshVar_9= tomMatch520NameNumber_freshVar_10.getSorts() ;{  tom.gom.adt.gom.types.ModuleDecl  tomMatch520NameNumber_freshVar_12=tomMatch520NameNumber_freshVar_8;if ( (tomMatch520NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.moduledecl.ModuleDecl) ) {{  tom.gom.adt.gom.types.GomModuleName  tomMatch520NameNumber_freshVar_11= tomMatch520NameNumber_freshVar_12.getModuleName() ;{  tom.gom.adt.gom.types.GomModuleName  tomMatch520NameNumber_freshVar_14=tomMatch520NameNumber_freshVar_11;if ( (tomMatch520NameNumber_freshVar_14 instanceof tom.gom.adt.gom.types.gommodulename.GomModuleName) ) {{  String  tomMatch520NameNumber_freshVar_13= tomMatch520NameNumber_freshVar_14.getName() ;{  String  tomMatch520NameNumber_freshVar_21=tomMatch520NameNumber_freshVar_13;if ( tomMatch520NameNumber_freshVar_21.equals(tomMatch520NameNumber_freshSubject_1) ) {{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_freshVar_15=tomMatch520NameNumber_freshVar_9;if ( ((tomMatch520NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.sortlist.ConsConcSort) || (tomMatch520NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.sortlist.EmptyConcSort)) ) {{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_begin_17=tomMatch520NameNumber_freshVar_15;{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_end_18=tomMatch520NameNumber_freshVar_15;do {{{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_freshVar_16=tomMatch520NameNumber_end_18;if (!( tomMatch520NameNumber_freshVar_16.isEmptyConcSort() )) {{  tom.gom.adt.gom.types.Sort  tomMatch520NameNumber_freshVar_23= tomMatch520NameNumber_freshVar_16.getHeadConcSort() ;if ( (tomMatch520NameNumber_freshVar_23 instanceof tom.gom.adt.gom.types.sort.Sort) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch520NameNumber_freshVar_22= tomMatch520NameNumber_freshVar_23.getDecl() ;{  tom.gom.adt.gom.types.SortDecl  tomMatch520NameNumber_freshVar_25=tomMatch520NameNumber_freshVar_22;if ( (tomMatch520NameNumber_freshVar_25 instanceof tom.gom.adt.gom.types.sortdecl.SortDecl) ) {{  String  tomMatch520NameNumber_freshVar_24= tomMatch520NameNumber_freshVar_25.getName() ;{  tom.gom.adt.gom.types.SortList  tomMatch520NameNumber_freshVar_19= tomMatch520NameNumber_freshVar_16.getTailConcSort() ;{  tom.gom.adt.gom.types.ModuleList  tomMatch520NameNumber_freshVar_6= tomMatch520NameNumber_freshVar_3.getTailConcModule() ;






          if (tomMatch520NameNumber_freshVar_24.equals(sname)) {
            return tomMatch520NameNumber_freshVar_22;
          }
        }}}}}}}}}}if ( tomMatch520NameNumber_end_18.isEmptyConcSort() ) {tomMatch520NameNumber_end_18=tomMatch520NameNumber_begin_17;} else {tomMatch520NameNumber_end_18= tomMatch520NameNumber_end_18.getTailConcSort() ;}}} while(!( (tomMatch520NameNumber_end_18==tomMatch520NameNumber_begin_17) ));}}}}}}}}}}}}}}}}}}if ( tomMatch520NameNumber_end_5.isEmptyConcModule() ) {tomMatch520NameNumber_end_5=tomMatch520NameNumber_begin_4;} else {tomMatch520NameNumber_end_5= tomMatch520NameNumber_end_5.getTailConcModule() ;}}} while(!( (tomMatch520NameNumber_end_5==tomMatch520NameNumber_begin_4) ));}}}}}}}}}}}

    throw new GomRuntimeException(
        "HookTypeExpander: Sort not found: "+sname);
  }

  /**
   * Finds the OperatorDecl corresponding to an operator name.
   *
   * @param oname the sort name
   * @param modName the module name that should contain the operator
   * @param moduleList the queried ModuleList
   * @return the OperatorDecl for sname
   */
  private OperatorDecl getOperatorDecl(
      String oname,
      String modName,
      ModuleList moduleList) {
    {{  String  tomMatch521NameNumber_freshVar_0=modName;if ( true ) {{  String  tomMatch521NameNumber_freshSubject_1=(( String )tomMatch521NameNumber_freshVar_0);{ Object tomMatch521NameNumber_freshVar_1=moduleList;if ( (tomMatch521NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.ModuleList) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.ModuleList )tomMatch521NameNumber_freshVar_1);{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_freshVar_2=tomMatch521NameNumber_freshSubject_2;if ( ((tomMatch521NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.modulelist.ConsConcModule) || (tomMatch521NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.modulelist.EmptyConcModule)) ) {{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_begin_4=tomMatch521NameNumber_freshVar_2;{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_end_5=tomMatch521NameNumber_freshVar_2;do {{{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_freshVar_3=tomMatch521NameNumber_end_5;if (!( tomMatch521NameNumber_freshVar_3.isEmptyConcModule() )) {{  tom.gom.adt.gom.types.Module  tomMatch521NameNumber_freshVar_10= tomMatch521NameNumber_freshVar_3.getHeadConcModule() ;if ( (tomMatch521NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.module.Module) ) {{  tom.gom.adt.gom.types.ModuleDecl  tomMatch521NameNumber_freshVar_8= tomMatch521NameNumber_freshVar_10.getMDecl() ;{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_freshVar_9= tomMatch521NameNumber_freshVar_10.getSorts() ;{  tom.gom.adt.gom.types.ModuleDecl  tomMatch521NameNumber_freshVar_12=tomMatch521NameNumber_freshVar_8;if ( (tomMatch521NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.moduledecl.ModuleDecl) ) {{  tom.gom.adt.gom.types.GomModuleName  tomMatch521NameNumber_freshVar_11= tomMatch521NameNumber_freshVar_12.getModuleName() ;{  tom.gom.adt.gom.types.GomModuleName  tomMatch521NameNumber_freshVar_14=tomMatch521NameNumber_freshVar_11;if ( (tomMatch521NameNumber_freshVar_14 instanceof tom.gom.adt.gom.types.gommodulename.GomModuleName) ) {{  String  tomMatch521NameNumber_freshVar_13= tomMatch521NameNumber_freshVar_14.getName() ;{  String  tomMatch521NameNumber_freshVar_21=tomMatch521NameNumber_freshVar_13;if ( tomMatch521NameNumber_freshVar_21.equals(tomMatch521NameNumber_freshSubject_1) ) {{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_freshVar_15=tomMatch521NameNumber_freshVar_9;if ( ((tomMatch521NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.sortlist.ConsConcSort) || (tomMatch521NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.sortlist.EmptyConcSort)) ) {{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_begin_17=tomMatch521NameNumber_freshVar_15;{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_end_18=tomMatch521NameNumber_freshVar_15;do {{{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_freshVar_16=tomMatch521NameNumber_end_18;if (!( tomMatch521NameNumber_freshVar_16.isEmptyConcSort() )) {{  tom.gom.adt.gom.types.Sort  tomMatch521NameNumber_freshVar_23= tomMatch521NameNumber_freshVar_16.getHeadConcSort() ;if ( (tomMatch521NameNumber_freshVar_23 instanceof tom.gom.adt.gom.types.sort.Sort) ) {{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_freshVar_22= tomMatch521NameNumber_freshVar_23.getOperatorDecls() ;{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_freshVar_24=tomMatch521NameNumber_freshVar_22;if ( ((tomMatch521NameNumber_freshVar_24 instanceof tom.gom.adt.gom.types.operatordecllist.ConsConcOperator) || (tomMatch521NameNumber_freshVar_24 instanceof tom.gom.adt.gom.types.operatordecllist.EmptyConcOperator)) ) {{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_begin_26=tomMatch521NameNumber_freshVar_24;{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_end_27=tomMatch521NameNumber_freshVar_24;do {{{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_freshVar_25=tomMatch521NameNumber_end_27;if (!( tomMatch521NameNumber_freshVar_25.isEmptyConcOperator() )) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch521NameNumber_freshVar_31= tomMatch521NameNumber_freshVar_25.getHeadConcOperator() ;if ( (tomMatch521NameNumber_freshVar_31 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  String  tomMatch521NameNumber_freshVar_30= tomMatch521NameNumber_freshVar_31.getName() ;{  tom.gom.adt.gom.types.OperatorDeclList  tomMatch521NameNumber_freshVar_28= tomMatch521NameNumber_freshVar_25.getTailConcOperator() ;{  tom.gom.adt.gom.types.SortList  tomMatch521NameNumber_freshVar_19= tomMatch521NameNumber_freshVar_16.getTailConcSort() ;{  tom.gom.adt.gom.types.ModuleList  tomMatch521NameNumber_freshVar_6= tomMatch521NameNumber_freshVar_3.getTailConcModule() ;








        if (tomMatch521NameNumber_freshVar_30.equals(oname)) {
          return  tomMatch521NameNumber_freshVar_25.getHeadConcOperator() ;
        }
      }}}}}}}}if ( tomMatch521NameNumber_end_27.isEmptyConcOperator() ) {tomMatch521NameNumber_end_27=tomMatch521NameNumber_begin_26;} else {tomMatch521NameNumber_end_27= tomMatch521NameNumber_end_27.getTailConcOperator() ;}}} while(!( (tomMatch521NameNumber_end_27==tomMatch521NameNumber_begin_26) ));}}}}}}}}}if ( tomMatch521NameNumber_end_18.isEmptyConcSort() ) {tomMatch521NameNumber_end_18=tomMatch521NameNumber_begin_17;} else {tomMatch521NameNumber_end_18= tomMatch521NameNumber_end_18.getTailConcSort() ;}}} while(!( (tomMatch521NameNumber_end_18==tomMatch521NameNumber_begin_17) ));}}}}}}}}}}}}}}}}}}if ( tomMatch521NameNumber_end_5.isEmptyConcModule() ) {tomMatch521NameNumber_end_5=tomMatch521NameNumber_begin_4;} else {tomMatch521NameNumber_end_5= tomMatch521NameNumber_end_5.getTailConcModule() ;}}} while(!( (tomMatch521NameNumber_end_5==tomMatch521NameNumber_begin_4) ));}}}}}}}}}}}

    getLogger().log(Level.SEVERE,
        GomMessage.orphanedHook.getMessage(),
        new Object[]{oname});
    return null;
  }

  private SlotList typeArguments(
      ArgList args,
      HookKind kind,
      Decl decl) {
    {{ Object tomMatch522NameNumber_freshVar_0=kind;if ( (tomMatch522NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch522NameNumber_freshVar_0);{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshVar_2=tomMatch522NameNumber_freshSubject_1;if ( (tomMatch522NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch522NameNumber_freshVar_1= tomMatch522NameNumber_freshVar_2.getkind() ;{  String  tomMatch522NameNumber_freshVar_3=tomMatch522NameNumber_freshVar_1;if ( "make".equals(tomMatch522NameNumber_freshVar_3) ) {

        /*
         * The TypedProduction has to be Slots
         * A KindMakeHook is attached to an operator
         */
        {{ Object tomMatch523NameNumber_freshVar_0=decl;if ( (tomMatch523NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch523NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch523NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Decl  tomMatch523NameNumber_freshVar_2=tomMatch523NameNumber_freshSubject_1;if ( (tomMatch523NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch523NameNumber_freshVar_1= tomMatch523NameNumber_freshVar_2.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch523NameNumber_freshVar_4=tomMatch523NameNumber_freshVar_1;if ( (tomMatch523NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  tom.gom.adt.gom.types.TypedProduction  tomMatch523NameNumber_freshVar_3= tomMatch523NameNumber_freshVar_4.getProd() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch523NameNumber_freshVar_6=tomMatch523NameNumber_freshVar_3;if ( (tomMatch523NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.typedproduction.Slots) ) {{  tom.gom.adt.gom.types.SlotList  tomMatch523NameNumber_freshVar_5= tomMatch523NameNumber_freshVar_6.getSlots() ;{  tom.gom.adt.gom.types.SlotList  tom_slotList=tomMatch523NameNumber_freshVar_5;

            /* tests the arguments number */
            if (args.length() != tom_slotList.length()) {
              SlotList slist = tom_slotList;
              getLogger().log(Level.SEVERE,
                  GomMessage.mismatchedMakeArguments.getMessage(),
                  new Object[]{args,slist });
              return null;
            }
            /* Then check the types */
            return recArgSlots(args,tom_slotList);
          }}}}}}}}}}}}}{ Object tomMatch523NameNumber_freshVar_7=decl;if ( (tomMatch523NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch523NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch523NameNumber_freshVar_7);

            getLogger().log(Level.SEVERE,
                GomMessage.unsupportedHookAlgebraic.getMessage(),
                new Object[]{ kind });
            return null;
          }}}}

      }}}}}}}}{ Object tomMatch522NameNumber_freshVar_4=kind;if ( (tomMatch522NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch522NameNumber_freshVar_4);{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshVar_6=tomMatch522NameNumber_freshSubject_1;if ( (tomMatch522NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch522NameNumber_freshVar_5= tomMatch522NameNumber_freshVar_6.getkind() ;{  String  tomMatch522NameNumber_freshVar_7=tomMatch522NameNumber_freshVar_5;if ( "make_insert".equals(tomMatch522NameNumber_freshVar_7) ) {

        /*
         * The TypedProduction has to be Variadic
         * Then we get the codomain from the operatordecl
         */
        {{ Object tomMatch524NameNumber_freshVar_0=decl;if ( (tomMatch524NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch524NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch524NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Decl  tomMatch524NameNumber_freshVar_2=tomMatch524NameNumber_freshSubject_1;if ( (tomMatch524NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch524NameNumber_freshVar_1= tomMatch524NameNumber_freshVar_2.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch524NameNumber_freshVar_5=tomMatch524NameNumber_freshVar_1;if ( (tomMatch524NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch524NameNumber_freshVar_3= tomMatch524NameNumber_freshVar_5.getSort() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch524NameNumber_freshVar_4= tomMatch524NameNumber_freshVar_5.getProd() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch524NameNumber_freshVar_7=tomMatch524NameNumber_freshVar_4;if ( (tomMatch524NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.typedproduction.Variadic) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch524NameNumber_freshVar_6= tomMatch524NameNumber_freshVar_7.getSort() ;


              // for a make_insert hook, there are two arguments: head, tail
              {{ Object tomMatch525NameNumber_freshVar_0=args;if ( (tomMatch525NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch525NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch525NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ArgList  tomMatch525NameNumber_freshVar_1=tomMatch525NameNumber_freshSubject_1;if ( ((tomMatch525NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.ConsConcArg) || (tomMatch525NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.EmptyConcArg)) ) {if (!( tomMatch525NameNumber_freshVar_1.isEmptyConcArg() )) {{  tom.gom.adt.gom.types.Arg  tomMatch525NameNumber_freshVar_5= tomMatch525NameNumber_freshVar_1.getHeadConcArg() ;if ( (tomMatch525NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.arg.Arg) ) {{  String  tomMatch525NameNumber_freshVar_4= tomMatch525NameNumber_freshVar_5.getName() ;{  tom.gom.adt.gom.types.ArgList  tomMatch525NameNumber_freshVar_2= tomMatch525NameNumber_freshVar_1.getTailConcArg() ;if (!( tomMatch525NameNumber_freshVar_2.isEmptyConcArg() )) {{  tom.gom.adt.gom.types.Arg  tomMatch525NameNumber_freshVar_7= tomMatch525NameNumber_freshVar_2.getHeadConcArg() ;if ( (tomMatch525NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.arg.Arg) ) {{  String  tomMatch525NameNumber_freshVar_6= tomMatch525NameNumber_freshVar_7.getName() ;{  tom.gom.adt.gom.types.ArgList  tomMatch525NameNumber_freshVar_3= tomMatch525NameNumber_freshVar_2.getTailConcArg() ;if ( tomMatch525NameNumber_freshVar_3.isEmptyConcArg() ) {

                  return  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make(tomMatch525NameNumber_freshVar_4, tomMatch524NameNumber_freshVar_6) , tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make(tomMatch525NameNumber_freshVar_6, tomMatch524NameNumber_freshVar_3) , tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) ) ;
                }}}}}}}}}}}}}}}}{ Object tomMatch525NameNumber_freshVar_8=args;if ( (tomMatch525NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch525NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch525NameNumber_freshVar_8);

                  getLogger().log(Level.SEVERE,
                      GomMessage.badHookArguments.getMessage(),
                      new Object[]{ (tomMatch522NameNumber_freshVar_5), new Integer(args.length())});
                  return null;
                }}}}

            }}}}}}}}}}}}}{ Object tomMatch524NameNumber_freshVar_8=decl;if ( (tomMatch524NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch524NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch524NameNumber_freshVar_8);

            getLogger().log(Level.SEVERE,
                GomMessage.unsupportedHookVariadic.getMessage(),
                new Object[]{ kind });
            return null;
          }}}}

      }}}}}}}}{ Object tomMatch522NameNumber_freshVar_8=kind;if ( (tomMatch522NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.HookKind) ) {{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.HookKind )tomMatch522NameNumber_freshVar_8);{  tom.gom.adt.gom.types.HookKind  tomMatch522NameNumber_freshVar_10=tomMatch522NameNumber_freshSubject_1;if ( (tomMatch522NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.hookkind.HookKind) ) {{  String  tomMatch522NameNumber_freshVar_9= tomMatch522NameNumber_freshVar_10.getkind() ;{  String  tomMatch522NameNumber_freshVar_11=tomMatch522NameNumber_freshVar_9;if ( "make_empty".equals(tomMatch522NameNumber_freshVar_11) ) {

        /*
         * The TypedProduction has to be Variadic
         * Then we get the codomain from the operatordecl
         */
        {{ Object tomMatch526NameNumber_freshVar_0=decl;if ( (tomMatch526NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch526NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch526NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Decl  tomMatch526NameNumber_freshVar_2=tomMatch526NameNumber_freshSubject_1;if ( (tomMatch526NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch526NameNumber_freshVar_1= tomMatch526NameNumber_freshVar_2.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch526NameNumber_freshVar_4=tomMatch526NameNumber_freshVar_1;if ( (tomMatch526NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  tom.gom.adt.gom.types.TypedProduction  tomMatch526NameNumber_freshVar_3= tomMatch526NameNumber_freshVar_4.getProd() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch526NameNumber_freshVar_5=tomMatch526NameNumber_freshVar_3;if ( (tomMatch526NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.typedproduction.Variadic) ) {


              // for a make_empty hook, there is no argument
              {{ Object tomMatch527NameNumber_freshVar_0=args;if ( (tomMatch527NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch527NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch527NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ArgList  tomMatch527NameNumber_freshVar_1=tomMatch527NameNumber_freshSubject_1;if ( ((tomMatch527NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.ConsConcArg) || (tomMatch527NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.EmptyConcArg)) ) {if ( tomMatch527NameNumber_freshVar_1.isEmptyConcArg() ) {
 return  tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ; }}}}}}{ Object tomMatch527NameNumber_freshVar_2=args;if ( (tomMatch527NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch527NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch527NameNumber_freshVar_2);

                  getLogger().log(Level.SEVERE,
                      GomMessage.badHookArguments.getMessage(),
                      new Object[]{ (tomMatch522NameNumber_freshVar_9), new Integer(args.length())});
                  return null;
                }}}}

            }}}}}}}}}}}{ Object tomMatch526NameNumber_freshVar_6=decl;if ( (tomMatch526NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch526NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch526NameNumber_freshVar_6);

            getLogger().log(Level.SEVERE,
                GomMessage.unsupportedHookVariadic.getMessage(),
                new Object[]{ kind });
            return null;
          }}}}

      }}}}}}}}}

    throw new GomRuntimeException("Hook kind \""+kind+"\" not supported");
  }

  private SlotList recArgSlots(ArgList args, SlotList slots) {
    {{ Object tomMatch528NameNumber_freshVar_0=args;if ( (tomMatch528NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch528NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch528NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ArgList  tomMatch528NameNumber_freshVar_2=tomMatch528NameNumber_freshSubject_1;if ( ((tomMatch528NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.arglist.ConsConcArg) || (tomMatch528NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.arglist.EmptyConcArg)) ) {if ( tomMatch528NameNumber_freshVar_2.isEmptyConcArg() ) {{ Object tomMatch528NameNumber_freshVar_1=slots;if ( (tomMatch528NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.SlotList) ) {{  tom.gom.adt.gom.types.SlotList  tomMatch528NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.SlotList )tomMatch528NameNumber_freshVar_1);{  tom.gom.adt.gom.types.SlotList  tomMatch528NameNumber_freshVar_3=tomMatch528NameNumber_freshSubject_2;if ( ((tomMatch528NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.slotlist.ConsConcSlot) || (tomMatch528NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.slotlist.EmptyConcSlot)) ) {if ( tomMatch528NameNumber_freshVar_3.isEmptyConcSlot() ) {

        return  tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ;
      }}}}}}}}}}}}{ Object tomMatch528NameNumber_freshVar_4=args;if ( (tomMatch528NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch528NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch528NameNumber_freshVar_4);{  tom.gom.adt.gom.types.ArgList  tomMatch528NameNumber_freshVar_6=tomMatch528NameNumber_freshSubject_1;if ( ((tomMatch528NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.arglist.ConsConcArg) || (tomMatch528NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.arglist.EmptyConcArg)) ) {if (!( tomMatch528NameNumber_freshVar_6.isEmptyConcArg() )) {{  tom.gom.adt.gom.types.Arg  tomMatch528NameNumber_freshVar_13= tomMatch528NameNumber_freshVar_6.getHeadConcArg() ;if ( (tomMatch528NameNumber_freshVar_13 instanceof tom.gom.adt.gom.types.arg.Arg) ) {{  String  tomMatch528NameNumber_freshVar_12= tomMatch528NameNumber_freshVar_13.getName() ;{  tom.gom.adt.gom.types.ArgList  tomMatch528NameNumber_freshVar_7= tomMatch528NameNumber_freshVar_6.getTailConcArg() ;{ Object tomMatch528NameNumber_freshVar_5=slots;if ( (tomMatch528NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.SlotList) ) {{  tom.gom.adt.gom.types.SlotList  tomMatch528NameNumber_freshSubject_2=(( tom.gom.adt.gom.types.SlotList )tomMatch528NameNumber_freshVar_5);{  tom.gom.adt.gom.types.SlotList  tomMatch528NameNumber_freshVar_9=tomMatch528NameNumber_freshSubject_2;if ( ((tomMatch528NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.slotlist.ConsConcSlot) || (tomMatch528NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.slotlist.EmptyConcSlot)) ) {if (!( tomMatch528NameNumber_freshVar_9.isEmptyConcSlot() )) {{  tom.gom.adt.gom.types.Slot  tomMatch528NameNumber_freshVar_15= tomMatch528NameNumber_freshVar_9.getHeadConcSlot() ;if ( (tomMatch528NameNumber_freshVar_15 instanceof tom.gom.adt.gom.types.slot.Slot) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch528NameNumber_freshVar_14= tomMatch528NameNumber_freshVar_15.getSort() ;{  tom.gom.adt.gom.types.SlotList  tomMatch528NameNumber_freshVar_10= tomMatch528NameNumber_freshVar_9.getTailConcSlot() ;

        SlotList tail = recArgSlots(tomMatch528NameNumber_freshVar_7,tomMatch528NameNumber_freshVar_10);
        return  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make(tomMatch528NameNumber_freshVar_12, tomMatch528NameNumber_freshVar_14) ,tom_append_list_ConcSlot(tail, tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() )) ;
      }}}}}}}}}}}}}}}}}}}}}

    throw new GomRuntimeException("GomTypeExpander:recArgSlots failed "+args+" "+slots);
  }

  private String trimBracket(String stringCode) {
    int start = stringCode.indexOf('{')+1;
    int end = stringCode.lastIndexOf('}');
    return stringCode.substring(start,end).trim();
  }

  private SortDecl getSortAndCheck(Decl mdecl) {
    {{ Object tomMatch529NameNumber_freshVar_0=mdecl;if ( (tomMatch529NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch529NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch529NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Decl  tomMatch529NameNumber_freshVar_2=tomMatch529NameNumber_freshSubject_1;if ( (tomMatch529NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.decl.CutOperator) ) {{  tom.gom.adt.gom.types.OperatorDecl  tomMatch529NameNumber_freshVar_1= tomMatch529NameNumber_freshVar_2.getODecl() ;{  tom.gom.adt.gom.types.OperatorDecl  tomMatch529NameNumber_freshVar_5=tomMatch529NameNumber_freshVar_1;if ( (tomMatch529NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.operatordecl.OperatorDecl) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch529NameNumber_freshVar_3= tomMatch529NameNumber_freshVar_5.getSort() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch529NameNumber_freshVar_4= tomMatch529NameNumber_freshVar_5.getProd() ;{  tom.gom.adt.gom.types.TypedProduction  tomMatch529NameNumber_freshVar_7=tomMatch529NameNumber_freshVar_4;if ( (tomMatch529NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.typedproduction.Variadic) ) {{  tom.gom.adt.gom.types.SortDecl  tomMatch529NameNumber_freshVar_6= tomMatch529NameNumber_freshVar_7.getSort() ;{  tom.gom.adt.gom.types.SortDecl  tom_sdecl=tomMatch529NameNumber_freshVar_6;

        if (tomMatch529NameNumber_freshVar_3== tom_sdecl) {
          return tom_sdecl;
        } else {
          getLogger().log(Level.SEVERE,
              "Different domain and codomain");
        }
      }}}}}}}}}}}}}}{ Object tomMatch529NameNumber_freshVar_8=mdecl;if ( (tomMatch529NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.Decl) ) {{  tom.gom.adt.gom.types.Decl  tomMatch529NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Decl )tomMatch529NameNumber_freshVar_8);

        getLogger().log(Level.SEVERE,
            "FL/AU/ACU hook can only be used on a variadic operator");
      }}}}

    return null;
  }

  /*
   * generate hooks for normalizing rules 
   */
  private HookDeclList makeRulesHookList(String opName, Decl mdecl, String scode) {
    RuleExpander rexpander = new RuleExpander(moduleList);
    return rexpander.expandRules(trimBracket(scode));
  }

  /*
   * generate hooks for term-graph rules 
   */
  private HookDeclList makeGraphRulesHookList(String sortname, ArgList args, Decl sdecl, String scode) {
    {{ Object tomMatch530NameNumber_freshVar_0=args;if ( (tomMatch530NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ArgList) ) {{  tom.gom.adt.gom.types.ArgList  tomMatch530NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ArgList )tomMatch530NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ArgList  tomMatch530NameNumber_freshVar_1=tomMatch530NameNumber_freshSubject_1;if ( ((tomMatch530NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.ConsConcArg) || (tomMatch530NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.arglist.EmptyConcArg)) ) {if (!( tomMatch530NameNumber_freshVar_1.isEmptyConcArg() )) {{  tom.gom.adt.gom.types.Arg  tomMatch530NameNumber_freshVar_5= tomMatch530NameNumber_freshVar_1.getHeadConcArg() ;if ( (tomMatch530NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.arg.Arg) ) {{  String  tomMatch530NameNumber_freshVar_4= tomMatch530NameNumber_freshVar_5.getName() ;{  String  tom_stratname=tomMatch530NameNumber_freshVar_4;{  tom.gom.adt.gom.types.ArgList  tomMatch530NameNumber_freshVar_2= tomMatch530NameNumber_freshVar_1.getTailConcArg() ;if (!( tomMatch530NameNumber_freshVar_2.isEmptyConcArg() )) {{  tom.gom.adt.gom.types.Arg  tomMatch530NameNumber_freshVar_7= tomMatch530NameNumber_freshVar_2.getHeadConcArg() ;if ( (tomMatch530NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.arg.Arg) ) {{  String  tomMatch530NameNumber_freshVar_6= tomMatch530NameNumber_freshVar_7.getName() ;{  String  tom_defaultstrat=tomMatch530NameNumber_freshVar_6;{  tom.gom.adt.gom.types.ArgList  tomMatch530NameNumber_freshVar_3= tomMatch530NameNumber_freshVar_2.getTailConcArg() ;if ( tomMatch530NameNumber_freshVar_3.isEmptyConcArg() ) {

        if (!tom_defaultstrat.equals("Fail") && !tom_defaultstrat.equals("Identity")) {
          getLogger().log(Level.SEVERE,
              "In graphrules hooks, the default strategies authorized are only Fail and Identity");
        }
        GraphRuleExpander rexpander = new GraphRuleExpander(moduleList);
        if (sortsWithGraphrules.contains(sdecl)) {
          return rexpander.expandGraphRules(sortname,tom_stratname,tom_defaultstrat,trimBracket(scode),sdecl);
        } else {
          sortsWithGraphrules.add(sdecl);
          return rexpander.expandFirstGraphRules(sortname,tom_stratname,tom_defaultstrat,trimBracket(scode),sdecl);
        }
      }}}}}}}}}}}}}}}}}}}

    return null;
  }

  /*
   * generate hooks for associative-commutative with neutral element
   */
  private HookDeclList makeACUHookList(String opName, Decl mdecl, String scode) {
    /* Can only be applied to a variadic operator, whose domain and codomain
     * are equals */
    SortDecl domain = getSortAndCheck(mdecl);
    if (null == domain)
      return  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;

    /* start with AU normalization */
    HookDeclList acHooks = makeAUHookList(opName, mdecl, scode);
    /*
     * add the following hooks:
     * if(tail.isConc) {
     *   if(head < tail.head) {
     *     tmp = head
     *     head = tail.head
     *     tail = cons(tmp,tail.tail)
     *   }
     * } else if(head < tail) {
     *   tmp = head
     *   head = tail
     *   tail = tmp
     * }
     * // in all cases:
     * return makeReal(head,tail)
     */
    acHooks =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("head", domain) , tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("tail", domain) , tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) ) ,  tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsCons.make("tail", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") {\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("  if (0 < ") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Compare.make( tom.gom.adt.code.types.code.Code.make("head") ,  tom.gom.adt.code.types.code.Code.make("tail.getHead" + opName+ "()") ) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") {\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    ") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.FullSortClass.make(domain) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(" tmpHd = head;\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    head = tail.getHead" + opName+ "();\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    tail = `" + opName+ "(tmpHd,tail.getTail" + opName+ "());\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("  }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("} else {\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("  if (0 < ") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Compare.make( tom.gom.adt.code.types.code.Code.make("head") ,  tom.gom.adt.code.types.code.Code.make("tail") ) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") {\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    ") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.FullSortClass.make(domain) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(" tmpHd = head;\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    head = tail;\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("    tail = tmpHd;\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("  }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("}\n") 
            , tom.gom.adt.code.types.code.EmptyCodeList.make() ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ,  tom.gom.adt.gom.types.hookkind.HookKind.make("ACU") ) ,tom_append_list_ConcHookDecl(acHooks, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() )) 
























;
    return acHooks;
  }

  /*
   * generate hooks for associative with neutral element
   */
  private HookDeclList makeAUHookList(String opName, Decl mdecl, String scode) {
    /* Can only be applied to a variadic operator, whose domain and codomain
     * are equals */
    SortDecl domain = getSortAndCheck(mdecl);
    if (null == domain)
      return  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;

    HookDeclList auHooks =  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
    String userNeutral = trimBracket(scode);
    if(userNeutral.length() > 0) {
      /* The hook body is the name of the neutral element */
      auHooks =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ,  tom.gom.adt.code.types.code.Code.make("return "+userNeutral+";") ,  tom.gom.adt.gom.types.hookkind.HookKind.make("AU") ) ,tom_append_list_ConcHookDecl(auHooks, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() )) 

;
      /* 
       * Remove neutral:
       * if(<head> == makeNeutral) { return <tail>; }
       * if(<tail> == makeNeutral) { return <head>; }
       */
      auHooks =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("head", domain) , tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("tail", domain) , tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) ) ,  tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (head == "+userNeutral+") { return tail; }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (tail ==  "+userNeutral+") { return head; }\n") 
              , tom.gom.adt.code.types.code.EmptyCodeList.make() ) ) ,  tom.gom.adt.gom.types.hookkind.HookKind.make("AU") ) ,tom_append_list_ConcHookDecl(auHooks, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() )) 







;
    }
    /* getODecl call is safe here, since mdecl was checked by getSortAndCheck */
    /*
     * Remove neutral and flatten:
     * if(<head>.isEmpty<conc>()) { return <tail>; }
     * if(<tail>.isEmpty<conc>()) { return <head>; }
     * if(<head>.isCons<conc>()) { return make(head.head,make(head.tail,tail)); }
     */
    auHooks =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("head", domain) , tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("tail", domain) , tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) ) ,  tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsEmpty.make("head", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return tail; }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsEmpty.make("tail", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return head; }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsCons.make("head", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return make(head.getHead" + opName+ "(),make(head.getTail" + opName+ "(),tail)); }\n") 
            , tom.gom.adt.code.types.code.EmptyCodeList.make() ) ) ) ) ) ) ) ) ) ,  tom.gom.adt.gom.types.hookkind.HookKind.make("AU") ) ,tom_append_list_ConcHookDecl(auHooks, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() )) 














;

    return auHooks;
  }

  /*
   * generate hooks for flattened lists (with empty list as last element)
   */
  private HookDeclList makeFLHookList(String opName, Decl mdecl, String scode) {
    /* Can only be applied to a variadic operator, whose domain and codomain
     * are equals */
    SortDecl domain = getSortAndCheck(mdecl);
    if(null == domain) {
      return  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
    }

    String userNeutral = trimBracket(scode);
    if(userNeutral.length() > 0) {
      getLogger().log(Level.SEVERE,
          "FL hook does not allow the definition of a neutral element");
    }

    HookDeclList hooks =  tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() ;
    /* getODecl call is safe here, since mdecl was checked by getSortAndCheck */
    /*
     * Remove neutral and flatten:
     * if(<head>.isEmpty<Conc>()) { return <tail>; }
     * if(<head>.isCons<Conc>()) { return make(head.head,make(head.tail,tail)); }
     * if(!<tail>.isCons<Conc>() && !<tail>.isEmpty<Conc>()) { return make(<tail>,<empty>); }
     */
    hooks =  tom.gom.adt.gom.types.hookdecllist.ConsConcHookDecl.make( tom.gom.adt.gom.types.hookdecl.MakeHookDecl.make(mdecl,  tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("head", domain) , tom.gom.adt.gom.types.slotlist.ConsConcSlot.make( tom.gom.adt.gom.types.slot.Slot.make("tail", domain) , tom.gom.adt.gom.types.slotlist.EmptyConcSlot.make() ) ) ,  tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsEmpty.make("head", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return tail; }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsCons.make("head", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return make(head.getHead" + opName+ "(),make(head.getTail" + opName+ "(),tail)); }\n") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make("if (!") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsCons.make("tail", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(" && !") , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.IsEmpty.make("tail", mdecl.getODecl()) , tom.gom.adt.code.types.code.ConsCodeList.make( tom.gom.adt.code.types.code.Code.make(") { return make(head,make(tail,Empty" + opName+ ".make())); }\n") 
            , tom.gom.adt.code.types.code.EmptyCodeList.make() ) ) ) ) ) ) ) ) ) ) ) ,  tom.gom.adt.gom.types.hookkind.HookKind.make("FL") ) ,tom_append_list_ConcHookDecl(hooks, tom.gom.adt.gom.types.hookdecllist.EmptyConcHookDecl.make() )) 
















;

    return hooks;
  }

  private Logger getLogger() {
    return Logger.getLogger(getClass().getName());
  }
}

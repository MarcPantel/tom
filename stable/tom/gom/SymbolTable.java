/* Generated by TOM (version 2.6): Do not edit this file *//*
 * Gom
 * 
 * Copyright (c) 2000-2008, INRIA
 * Nancy, France.
 * 
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA
 * 
 * Antoine Reilles    e-mail: Antoine.Reilles@loria.fr
 * 
 **/

package tom.gom;

import java.util.logging.Level;
import tom.gom.GomStreamManager;
import tom.gom.adt.symboltable.types.*;
import tom.gom.adt.symboltable.*;
import tom.gom.adt.gom.types.*;
import tom.library.sl.*;
import java.util.ArrayList;
import java.util.Hashtable;
import java.util.Map;
import java.util.Set;
import java.util.Iterator;
import java.util.HashSet;
import tom.gom.tools.GomEnvironment;


public class SymbolTable {

  /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */  /* Generated by TOM (version 2.6): Do not edit this file */    public static   tom.gom.adt.gom.types.GomModuleList  tom_append_list_ConcGomModule( tom.gom.adt.gom.types.GomModuleList l1,  tom.gom.adt.gom.types.GomModuleList  l2) {     if( l1.isEmptyConcGomModule() ) {       return l2;     } else if( l2.isEmptyConcGomModule() ) {       return l1;     } else if(  l1.getTailConcGomModule() .isEmptyConcGomModule() ) {       return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( l1.getHeadConcGomModule() ,l2) ;     } else {       return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( l1.getHeadConcGomModule() ,tom_append_list_ConcGomModule( l1.getTailConcGomModule() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.GomModuleList  tom_get_slice_ConcGomModule( tom.gom.adt.gom.types.GomModuleList  begin,  tom.gom.adt.gom.types.GomModuleList  end, tom.gom.adt.gom.types.GomModuleList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcGomModule()  ||  (end== tom.gom.adt.gom.types.gommodulelist.EmptyConcGomModule.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule.make( begin.getHeadConcGomModule() ,( tom.gom.adt.gom.types.GomModuleList )tom_get_slice_ConcGomModule( begin.getTailConcGomModule() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.AtomList  tom_append_list_ConcAtom( tom.gom.adt.gom.types.AtomList l1,  tom.gom.adt.gom.types.AtomList  l2) {     if( l1.isEmptyConcAtom() ) {       return l2;     } else if( l2.isEmptyConcAtom() ) {       return l1;     } else if(  l1.getTailConcAtom() .isEmptyConcAtom() ) {       return  tom.gom.adt.gom.types.atomlist.ConsConcAtom.make( l1.getHeadConcAtom() ,l2) ;     } else {       return  tom.gom.adt.gom.types.atomlist.ConsConcAtom.make( l1.getHeadConcAtom() ,tom_append_list_ConcAtom( l1.getTailConcAtom() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.AtomList  tom_get_slice_ConcAtom( tom.gom.adt.gom.types.AtomList  begin,  tom.gom.adt.gom.types.AtomList  end, tom.gom.adt.gom.types.AtomList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcAtom()  ||  (end== tom.gom.adt.gom.types.atomlist.EmptyConcAtom.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.atomlist.ConsConcAtom.make( begin.getHeadConcAtom() ,( tom.gom.adt.gom.types.AtomList )tom_get_slice_ConcAtom( begin.getTailConcAtom() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.GrammarList  tom_append_list_ConcGrammar( tom.gom.adt.gom.types.GrammarList l1,  tom.gom.adt.gom.types.GrammarList  l2) {     if( l1.isEmptyConcGrammar() ) {       return l2;     } else if( l2.isEmptyConcGrammar() ) {       return l1;     } else if(  l1.getTailConcGrammar() .isEmptyConcGrammar() ) {       return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( l1.getHeadConcGrammar() ,l2) ;     } else {       return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( l1.getHeadConcGrammar() ,tom_append_list_ConcGrammar( l1.getTailConcGrammar() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.GrammarList  tom_get_slice_ConcGrammar( tom.gom.adt.gom.types.GrammarList  begin,  tom.gom.adt.gom.types.GrammarList  end, tom.gom.adt.gom.types.GrammarList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcGrammar()  ||  (end== tom.gom.adt.gom.types.grammarlist.EmptyConcGrammar.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.grammarlist.ConsConcGrammar.make( begin.getHeadConcGrammar() ,( tom.gom.adt.gom.types.GrammarList )tom_get_slice_ConcGrammar( begin.getTailConcGrammar() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.SectionList  tom_append_list_ConcSection( tom.gom.adt.gom.types.SectionList l1,  tom.gom.adt.gom.types.SectionList  l2) {     if( l1.isEmptyConcSection() ) {       return l2;     } else if( l2.isEmptyConcSection() ) {       return l1;     } else if(  l1.getTailConcSection() .isEmptyConcSection() ) {       return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( l1.getHeadConcSection() ,l2) ;     } else {       return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( l1.getHeadConcSection() ,tom_append_list_ConcSection( l1.getTailConcSection() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.SectionList  tom_get_slice_ConcSection( tom.gom.adt.gom.types.SectionList  begin,  tom.gom.adt.gom.types.SectionList  end, tom.gom.adt.gom.types.SectionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcSection()  ||  (end== tom.gom.adt.gom.types.sectionlist.EmptyConcSection.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.sectionlist.ConsConcSection.make( begin.getHeadConcSection() ,( tom.gom.adt.gom.types.SectionList )tom_get_slice_ConcSection( begin.getTailConcSection() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.ProductionList  tom_append_list_ConcProduction( tom.gom.adt.gom.types.ProductionList l1,  tom.gom.adt.gom.types.ProductionList  l2) {     if( l1.isEmptyConcProduction() ) {       return l2;     } else if( l2.isEmptyConcProduction() ) {       return l1;     } else if(  l1.getTailConcProduction() .isEmptyConcProduction() ) {       return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( l1.getHeadConcProduction() ,l2) ;     } else {       return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( l1.getHeadConcProduction() ,tom_append_list_ConcProduction( l1.getTailConcProduction() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.ProductionList  tom_get_slice_ConcProduction( tom.gom.adt.gom.types.ProductionList  begin,  tom.gom.adt.gom.types.ProductionList  end, tom.gom.adt.gom.types.ProductionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcProduction()  ||  (end== tom.gom.adt.gom.types.productionlist.EmptyConcProduction.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.productionlist.ConsConcProduction.make( begin.getHeadConcProduction() ,( tom.gom.adt.gom.types.ProductionList )tom_get_slice_ConcProduction( begin.getTailConcProduction() ,end,tail)) ;   }      public static   tom.gom.adt.gom.types.FieldList  tom_append_list_ConcField( tom.gom.adt.gom.types.FieldList l1,  tom.gom.adt.gom.types.FieldList  l2) {     if( l1.isEmptyConcField() ) {       return l2;     } else if( l2.isEmptyConcField() ) {       return l1;     } else if(  l1.getTailConcField() .isEmptyConcField() ) {       return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( l1.getHeadConcField() ,l2) ;     } else {       return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( l1.getHeadConcField() ,tom_append_list_ConcField( l1.getTailConcField() ,l2)) ;     }   }   public static   tom.gom.adt.gom.types.FieldList  tom_get_slice_ConcField( tom.gom.adt.gom.types.FieldList  begin,  tom.gom.adt.gom.types.FieldList  end, tom.gom.adt.gom.types.FieldList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyConcField()  ||  (end== tom.gom.adt.gom.types.fieldlist.EmptyConcField.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.gom.types.fieldlist.ConsConcField.make( begin.getHeadConcField() ,( tom.gom.adt.gom.types.FieldList )tom_get_slice_ConcField( begin.getTailConcField() ,end,tail)) ;   }    /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */    public static   tom.gom.adt.symboltable.types.StringList  tom_append_list_StringList( tom.gom.adt.symboltable.types.StringList l1,  tom.gom.adt.symboltable.types.StringList  l2) {     if( l1.isEmptyStringList() ) {       return l2;     } else if( l2.isEmptyStringList() ) {       return l1;     } else if(  l1.getTailStringList() .isEmptyStringList() ) {       return  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make( l1.getHeadStringList() ,l2) ;     } else {       return  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make( l1.getHeadStringList() ,tom_append_list_StringList( l1.getTailStringList() ,l2)) ;     }   }   public static   tom.gom.adt.symboltable.types.StringList  tom_get_slice_StringList( tom.gom.adt.symboltable.types.StringList  begin,  tom.gom.adt.symboltable.types.StringList  end, tom.gom.adt.symboltable.types.StringList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyStringList()  ||  (end== tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make( begin.getHeadStringList() ,( tom.gom.adt.symboltable.types.StringList )tom_get_slice_StringList( begin.getTailStringList() ,end,tail)) ;   }      public static   tom.gom.adt.symboltable.types.FieldDescriptionList  tom_append_list_concFieldDescription( tom.gom.adt.symboltable.types.FieldDescriptionList l1,  tom.gom.adt.symboltable.types.FieldDescriptionList  l2) {     if( l1.isEmptyconcFieldDescription() ) {       return l2;     } else if( l2.isEmptyconcFieldDescription() ) {       return l1;     } else if(  l1.getTailconcFieldDescription() .isEmptyconcFieldDescription() ) {       return  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( l1.getHeadconcFieldDescription() ,l2) ;     } else {       return  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( l1.getHeadconcFieldDescription() ,tom_append_list_concFieldDescription( l1.getTailconcFieldDescription() ,l2)) ;     }   }   public static   tom.gom.adt.symboltable.types.FieldDescriptionList  tom_get_slice_concFieldDescription( tom.gom.adt.symboltable.types.FieldDescriptionList  begin,  tom.gom.adt.symboltable.types.FieldDescriptionList  end, tom.gom.adt.symboltable.types.FieldDescriptionList  tail) {     if( (begin==end) ) {       return tail;     } else if( (end==tail)  && ( end.isEmptyconcFieldDescription()  ||  (end== tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( begin.getHeadconcFieldDescription() ,( tom.gom.adt.symboltable.types.FieldDescriptionList )tom_get_slice_concFieldDescription( begin.getTailconcFieldDescription() ,end,tail)) ;   }    /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */ /* Generated by TOM (version 2.6): Do not edit this file */   private static java.util.ArrayList concArrayListAppend(Object o, java.util.ArrayList l) {   java.util.ArrayList res = (java.util.ArrayList)l.clone();   res.add(o);   return res; } /* Generated by TOM (version 2.6): Do not edit this file *//* Generated by TOM (version 2.6): Do not edit this file */   public static   tom.library.sl.Strategy  tom_append_list_Sequence( tom.library.sl.Strategy  l1,  tom.library.sl.Strategy  l2) {     if(( l1 == null )) {       return l2;     } else if(( l2 == null )) {       return l1;     } else if(( (l1 instanceof tom.library.sl.Sequence) )) {       if(( ((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )) == null )) {         return ( (l2==null)?((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1):new tom.library.sl.Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1),l2) );       } else {         return ( (tom_append_list_Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),l2)==null)?((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1):new tom.library.sl.Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.FIRST) ):l1),tom_append_list_Sequence(((( (l1 instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)l1.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),l2)) );       }     } else {       return ( (l2==null)?l1:new tom.library.sl.Sequence(l1,l2) );     }   }   public static   tom.library.sl.Strategy  tom_get_slice_Sequence( tom.library.sl.Strategy  begin,  tom.library.sl.Strategy  end, tom.library.sl.Strategy  tail) {     if( (begin.equals(end)) ) {       return tail;     } else if( (end.equals(tail))  && (( end == null ) ||  (end.equals(( null ))) )) {       /* code to avoid a call to make, and thus to avoid looping during list-matching */       return begin;     }     return ( (( tom.library.sl.Strategy )tom_get_slice_Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),end,tail)==null)?((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.FIRST) ):begin):new tom.library.sl.Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.FIRST) ):begin),( tom.library.sl.Strategy )tom_get_slice_Sequence(((( (begin instanceof tom.library.sl.Sequence) ))?( (tom.library.sl.Strategy)begin.getChildAt(tom.library.sl.Sequence.THEN) ):( null )),end,tail)) );   }    /* Generated by TOM (version 2.6): Do not edit this file */ /* Generated by TOM (version 2.6): Do not edit this file */public static  tom.library.sl.Strategy  tom_make_TopDown( tom.library.sl.Strategy  v) { return ( ( new tom.library.sl.Mu(( new tom.library.sl.MuVar("_x") ),( (( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ),( null )) )==null)?v:new tom.library.sl.Sequence(v,( (( null )==null)?( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ):new tom.library.sl.Sequence(( new tom.library.sl.All(( new tom.library.sl.MuVar("_x") )) ),( null )) )) )) ) );}   


  

  public class SortException extends RuntimeException {
    protected String sortName;

    public SortException(String sortName) {
      super();
      this.sortName = sortName;
    }
    public String getSortName() { return sortName; } 
    public String toString() {
      return "sort exception : " + sortName;
    }
  }

  public class UndeclaredSortException extends SortException {
    public UndeclaredSortException(String n) { super(n); }
    public String toString() {
      return "undeclared sort : " + sortName;
    }
  }

  public class ConstructorException extends RuntimeException {
    protected String constructorName;
    public ConstructorException(String constructorName) {
      super();
      this.constructorName = constructorName;
    }
    public String getConstructorName() { return constructorName; } 
    public String toString() {
      return "constructor exception : " + constructorName;
    }
  }

  public class UndeclaredConstructorException extends ConstructorException {
    public UndeclaredConstructorException(String n) { super(n); }
  }
  public class InvalidConstructorException extends ConstructorException {
    public InvalidConstructorException(String n) { super(n); }
  }

  protected Hashtable<String,SortDescription> sorts = 
    new Hashtable<String,SortDescription>();

  protected Hashtable<String,ConstructorDescription> constructors =  
    new Hashtable<String,ConstructorDescription>();

  protected Graph<String> graph = new Graph<String>();

  protected String pack = "";

  public void setPackage(String pack) {
    this.pack = pack;
  }

  public String toString() {
    StringBuffer buf = new StringBuffer();
    for (Map.Entry<String,SortDescription> e: sorts.entrySet()) {
      java.io.StringWriter swriter = new java.io.StringWriter();
      try { tom.library.utils.Viewer.toTree(e.getValue(),swriter); }
      catch(java.io.IOException ex) { ex.printStackTrace(); }
      buf.append("sort " + e.getKey() + ":\n" + swriter + "\n");
    }
    for(Map.Entry<String,ConstructorDescription> e: constructors.entrySet()){
      java.io.StringWriter swriter = new java.io.StringWriter();
      try { tom.library.utils.Viewer.toTree(e.getValue(),swriter); }
      catch(java.io.IOException ex) { ex.printStackTrace(); }
      buf.append("constructor " + e.getKey() + ":\n" + swriter + "\n");
    }
    return buf.toString();
  }

  public static String rawSort(String s) { return "Raw" + s; }

  public String rawCons(String c) { 
    if (isGenerated(c)) {
      {{ Object tomMatch342NameNumber_freshVar_0=getGenerated(c);if ( (tomMatch342NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.GenerationInfo) ) {{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch342NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.GenerationInfo )tomMatch342NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch342NameNumber_freshVar_2=tomMatch342NameNumber_freshSubject_1;if ( (tomMatch342NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.generationinfo.GenCons) ) {{  String  tomMatch342NameNumber_freshVar_1= tomMatch342NameNumber_freshVar_2.getBaseName() ;
 return "ConsRaw" + tomMatch342NameNumber_freshVar_1; }}}}}}{ Object tomMatch342NameNumber_freshVar_3=getGenerated(c);if ( (tomMatch342NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.GenerationInfo) ) {{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch342NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.GenerationInfo )tomMatch342NameNumber_freshVar_3);{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch342NameNumber_freshVar_5=tomMatch342NameNumber_freshSubject_1;if ( (tomMatch342NameNumber_freshVar_5 instanceof tom.gom.adt.symboltable.types.generationinfo.GenNil) ) {{  String  tomMatch342NameNumber_freshVar_4= tomMatch342NameNumber_freshVar_5.getBaseName() ;
 return "EmptyRaw" + tomMatch342NameNumber_freshVar_4; }}}}}}}

    }
    return "Raw" + c; 
  }

  public String qualifiedRawSortId(String sort) {
    SortDescription desc = sorts.get(sort);
    if (desc==null)
      throw new UndeclaredSortException(sort);
    {{ Object tomMatch343NameNumber_freshVar_0=desc;if ( (tomMatch343NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.SortDescription) ) {{  tom.gom.adt.symboltable.types.SortDescription  tomMatch343NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.SortDescription )tomMatch343NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.SortDescription  tomMatch343NameNumber_freshVar_2=tomMatch343NameNumber_freshSubject_1;if ( (tomMatch343NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.sortdescription.SortDescription) ) {{  String  tomMatch343NameNumber_freshVar_1= tomMatch343NameNumber_freshVar_2.getModuleSymbol() ;
 
        return (pack.equals("") ? "" : pack + ".") 
          + tomMatch343NameNumber_freshVar_1.toLowerCase() + ".types." + rawSort(sort); 
      }}}}}}}

    throw new RuntimeException("non exhaustive match");
  }

  public String qualifiedRawConstructorId(String cons) {
    ConstructorDescription desc = constructors.get(cons);
    if (desc==null) 
      throw new UndeclaredConstructorException(cons);
    {{ Object tomMatch344NameNumber_freshVar_0=desc;if ( (tomMatch344NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch344NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch344NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch344NameNumber_freshVar_2=tomMatch344NameNumber_freshSubject_1;if ( (tomMatch344NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  String  tomMatch344NameNumber_freshVar_1= tomMatch344NameNumber_freshVar_2.getSortSymbol() ;

        return qualifiedSortId(tomMatch344NameNumber_freshVar_1) + "." + rawCons(cons); 
      }}}}}}}

    throw new RuntimeException("non exhaustive match");
  }


  public String qualifiedSortId(String sort) {
    SortDescription desc = sorts.get(sort);
    if (desc==null)
      throw new UndeclaredSortException(sort);
    {{ Object tomMatch345NameNumber_freshVar_0=desc;if ( (tomMatch345NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.SortDescription) ) {{  tom.gom.adt.symboltable.types.SortDescription  tomMatch345NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.SortDescription )tomMatch345NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.SortDescription  tomMatch345NameNumber_freshVar_2=tomMatch345NameNumber_freshSubject_1;if ( (tomMatch345NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.sortdescription.SortDescription) ) {{  String  tomMatch345NameNumber_freshVar_1= tomMatch345NameNumber_freshVar_2.getModuleSymbol() ;
 
        return (pack.equals("") ? "" : pack + ".") 
          + tomMatch345NameNumber_freshVar_1.toLowerCase() + ".types." + sort; 
      }}}}}}}

    throw new RuntimeException("non exhaustive match");
  }

  public String qualifiedConstructorId(String cons) {
    ConstructorDescription desc = constructors.get(cons);
    if (desc==null) 
      throw new UndeclaredConstructorException(cons);
    {{ Object tomMatch346NameNumber_freshVar_0=desc;if ( (tomMatch346NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch346NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch346NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch346NameNumber_freshVar_2=tomMatch346NameNumber_freshSubject_1;if ( (tomMatch346NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  String  tomMatch346NameNumber_freshVar_1= tomMatch346NameNumber_freshVar_2.getSortSymbol() ;

        return qualifiedSortId(tomMatch346NameNumber_freshVar_1).toLowerCase() + "." + cons; 
      }}}}}}}

    throw new RuntimeException("non exhaustive match");
  }

  public void fill(GomModuleList gml) {
    {{ Object tomMatch347NameNumber_freshVar_0=gml;if ( (tomMatch347NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.GomModuleList) ) {{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.GomModuleList )tomMatch347NameNumber_freshVar_0);{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_freshVar_1=tomMatch347NameNumber_freshSubject_1;if ( ((tomMatch347NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.gommodulelist.ConsConcGomModule) || (tomMatch347NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.gommodulelist.EmptyConcGomModule)) ) {{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_begin_3=tomMatch347NameNumber_freshVar_1;{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_end_4=tomMatch347NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_freshVar_2=tomMatch347NameNumber_end_4;if (!( tomMatch347NameNumber_freshVar_2.isEmptyConcGomModule() )) {{  tom.gom.adt.gom.types.GomModuleList  tomMatch347NameNumber_freshVar_5= tomMatch347NameNumber_freshVar_2.getTailConcGomModule() ;fill( tomMatch347NameNumber_freshVar_2.getHeadConcGomModule() )
; }}}if ( tomMatch347NameNumber_end_4.isEmptyConcGomModule() ) {tomMatch347NameNumber_end_4=tomMatch347NameNumber_begin_3;} else {tomMatch347NameNumber_end_4= tomMatch347NameNumber_end_4.getTailConcGomModule() ;}}} while(!( (tomMatch347NameNumber_end_4==tomMatch347NameNumber_begin_3) ));}}}}}}}}

    fillGraph();
    isolateFreshSorts();
    //System.out.println("sorts concerned by freshgom: " + getFreshSorts());
    //fillRefreshPoints();
    fillAccessibleAtoms();
    generateConsAndNils();
  }

  public void generateConsAndNils() {
    for(String c: getConstructors()) {
      if(!isVariadic(c)) continue;
      String dom = getDomain(c);
      String codom = getCoDomain(c);
      FieldDescriptionList ConsFields = null; // head and tail
      FieldDescriptionList NilFields =  tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ;
      /* codom binds X = ... | c(dom*) | ...
         => codom binds X = ... | Consc(Headc:dom,Tailc:codom) | ... */
      if(isPatternType(codom)) {
        ConsFields =  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Head"+c, dom,  tom.gom.adt.symboltable.types.status.SPattern.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Tail"+c, codom,  tom.gom.adt.symboltable.types.status.SPattern.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ) ) 

;
      /* codom = ... | c(<dom>*) | ...
         => codom = ... | Consc(Headc:<dom>,Tailc:codom) | ... */
      } else if (isRefreshPoint(c)) {
        ConsFields =  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Head"+c, dom,  tom.gom.adt.symboltable.types.status.SRefreshPoint.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Tail"+c, codom,  tom.gom.adt.symboltable.types.status.SNone.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ) ) 

;
      /* codom = ... | c(dom*) | ...
         => codom = ... | Consc(Headc:dom,Tailc:codom) | ... */
      } else {
        ConsFields =  tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Head"+c, dom,  tom.gom.adt.symboltable.types.status.SNone.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make( tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make("Tail"+c, codom,  tom.gom.adt.symboltable.types.status.SNone.make() ) , tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ) ) 

;
      }

      // add the new constructors to constructors map
      String nilc = "Empty" + c;
      String consc = "Cons" + c;
      constructors.put(nilc,
           tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription.make(codom, NilFields,  tom.gom.adt.symboltable.types.generationinfo.GenNil.make(c) ) );
      constructors.put(consc,
           tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription.make(codom, ConsFields,  tom.gom.adt.symboltable.types.generationinfo.GenCons.make(c) ) );

      // modify the codomain description
      SortDescription sd = sorts.get(codom);
      StringList conslist = sd.getConstructors();
      conslist = tom_append_list_StringList(conslist, tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(nilc, tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(consc, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ) ) );
      sd = sd.setConstructors(conslist);
      sorts.put(codom,sd);
    }
  }

  private void fill(GomModule m) {
    {{ Object tomMatch348NameNumber_freshVar_0=m;if ( (tomMatch348NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.GomModule) ) {{  tom.gom.adt.gom.types.GomModule  tomMatch348NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.GomModule )tomMatch348NameNumber_freshVar_0);{  tom.gom.adt.gom.types.GomModule  tomMatch348NameNumber_freshVar_3=tomMatch348NameNumber_freshSubject_1;if ( (tomMatch348NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.gommodule.GomModule) ) {{  tom.gom.adt.gom.types.GomModuleName  tomMatch348NameNumber_freshVar_1= tomMatch348NameNumber_freshVar_3.getModuleName() ;{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_freshVar_2= tomMatch348NameNumber_freshVar_3.getSectionList() ;{  tom.gom.adt.gom.types.GomModuleName  tomMatch348NameNumber_freshVar_5=tomMatch348NameNumber_freshVar_1;if ( (tomMatch348NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.gommodulename.GomModuleName) ) {{  String  tomMatch348NameNumber_freshVar_4= tomMatch348NameNumber_freshVar_5.getName() ;{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_freshVar_6=tomMatch348NameNumber_freshVar_2;if ( ((tomMatch348NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.sectionlist.ConsConcSection) || (tomMatch348NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.sectionlist.EmptyConcSection)) ) {{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_begin_8=tomMatch348NameNumber_freshVar_6;{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_end_9=tomMatch348NameNumber_freshVar_6;do {{{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_freshVar_7=tomMatch348NameNumber_end_9;if (!( tomMatch348NameNumber_freshVar_7.isEmptyConcSection() )) {{  tom.gom.adt.gom.types.Section  tomMatch348NameNumber_freshVar_13= tomMatch348NameNumber_freshVar_7.getHeadConcSection() ;if ( (tomMatch348NameNumber_freshVar_13 instanceof tom.gom.adt.gom.types.section.Public) ) {{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_freshVar_12= tomMatch348NameNumber_freshVar_13.getGrammarList() ;{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_freshVar_14=tomMatch348NameNumber_freshVar_12;if ( ((tomMatch348NameNumber_freshVar_14 instanceof tom.gom.adt.gom.types.grammarlist.ConsConcGrammar) || (tomMatch348NameNumber_freshVar_14 instanceof tom.gom.adt.gom.types.grammarlist.EmptyConcGrammar)) ) {{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_begin_16=tomMatch348NameNumber_freshVar_14;{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_end_17=tomMatch348NameNumber_freshVar_14;do {{{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_freshVar_15=tomMatch348NameNumber_end_17;if (!( tomMatch348NameNumber_freshVar_15.isEmptyConcGrammar() )) {{  tom.gom.adt.gom.types.GrammarList  tomMatch348NameNumber_freshVar_18= tomMatch348NameNumber_freshVar_15.getTailConcGrammar() ;{  tom.gom.adt.gom.types.SectionList  tomMatch348NameNumber_freshVar_10= tomMatch348NameNumber_freshVar_7.getTailConcSection() ;fill(tomMatch348NameNumber_freshVar_4, tomMatch348NameNumber_freshVar_15.getHeadConcGrammar() )


;
        }}}}if ( tomMatch348NameNumber_end_17.isEmptyConcGrammar() ) {tomMatch348NameNumber_end_17=tomMatch348NameNumber_begin_16;} else {tomMatch348NameNumber_end_17= tomMatch348NameNumber_end_17.getTailConcGrammar() ;}}} while(!( (tomMatch348NameNumber_end_17==tomMatch348NameNumber_begin_16) ));}}}}}}}}}if ( tomMatch348NameNumber_end_9.isEmptyConcSection() ) {tomMatch348NameNumber_end_9=tomMatch348NameNumber_begin_8;} else {tomMatch348NameNumber_end_9= tomMatch348NameNumber_end_9.getTailConcSection() ;}}} while(!( (tomMatch348NameNumber_end_9==tomMatch348NameNumber_begin_8) ));}}}}}}}}}}}}}}}

  }

  private void fill(String moduleName, Grammar g) {
    {{ Object tomMatch349NameNumber_freshVar_0=g;if ( (tomMatch349NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Grammar) ) {{  tom.gom.adt.gom.types.Grammar  tomMatch349NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Grammar )tomMatch349NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Grammar  tomMatch349NameNumber_freshVar_2=tomMatch349NameNumber_freshSubject_1;if ( (tomMatch349NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.grammar.Grammar) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_freshVar_1= tomMatch349NameNumber_freshVar_2.getProductionList() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_freshVar_3=tomMatch349NameNumber_freshVar_1;if ( ((tomMatch349NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch349NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_begin_5=tomMatch349NameNumber_freshVar_3;{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_end_6=tomMatch349NameNumber_freshVar_3;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_freshVar_4=tomMatch349NameNumber_end_6;if (!( tomMatch349NameNumber_freshVar_4.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.ProductionList  tomMatch349NameNumber_freshVar_7= tomMatch349NameNumber_freshVar_4.getTailConcProduction() ;fill(moduleName, tomMatch349NameNumber_freshVar_4.getHeadConcProduction() )

; }}}if ( tomMatch349NameNumber_end_6.isEmptyConcProduction() ) {tomMatch349NameNumber_end_6=tomMatch349NameNumber_begin_5;} else {tomMatch349NameNumber_end_6= tomMatch349NameNumber_end_6.getTailConcProduction() ;}}} while(!( (tomMatch349NameNumber_end_6==tomMatch349NameNumber_begin_5) ));}}}}}}}}}}}

  }

  private static StringList getConstructors(ProductionList pl) {
    StringList res =  tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ;
    {{ Object tomMatch350NameNumber_freshVar_0=pl;if ( (tomMatch350NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ProductionList) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ProductionList )tomMatch350NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_freshVar_1=tomMatch350NameNumber_freshSubject_1;if ( ((tomMatch350NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch350NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_begin_3=tomMatch350NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_end_4=tomMatch350NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_freshVar_2=tomMatch350NameNumber_end_4;if (!( tomMatch350NameNumber_freshVar_2.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.Production  tomMatch350NameNumber_freshVar_8= tomMatch350NameNumber_freshVar_2.getHeadConcProduction() ;if ( (tomMatch350NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.production.Production) ) {{  String  tomMatch350NameNumber_freshVar_7= tomMatch350NameNumber_freshVar_8.getName() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch350NameNumber_freshVar_5= tomMatch350NameNumber_freshVar_2.getTailConcProduction() ;
 
        res =  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(tomMatch350NameNumber_freshVar_7, res) ; 
      }}}}}}if ( tomMatch350NameNumber_end_4.isEmptyConcProduction() ) {tomMatch350NameNumber_end_4=tomMatch350NameNumber_begin_3;} else {tomMatch350NameNumber_end_4= tomMatch350NameNumber_end_4.getTailConcProduction() ;}}} while(!( (tomMatch350NameNumber_end_4==tomMatch350NameNumber_begin_3) ));}}}}}}}}

    return res;
  }

  private static StringList convertBoundAtoms(AtomList al) {
    StringList res =  tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ;
    {{ Object tomMatch351NameNumber_freshVar_0=al;if ( (tomMatch351NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.AtomList) ) {{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.AtomList )tomMatch351NameNumber_freshVar_0);{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_freshVar_1=tomMatch351NameNumber_freshSubject_1;if ( ((tomMatch351NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.atomlist.ConsConcAtom) || (tomMatch351NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.atomlist.EmptyConcAtom)) ) {{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_begin_3=tomMatch351NameNumber_freshVar_1;{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_end_4=tomMatch351NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_freshVar_2=tomMatch351NameNumber_end_4;if (!( tomMatch351NameNumber_freshVar_2.isEmptyConcAtom() )) {{  tom.gom.adt.gom.types.AtomList  tomMatch351NameNumber_freshVar_5= tomMatch351NameNumber_freshVar_2.getTailConcAtom() ;
 res =  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make( tomMatch351NameNumber_freshVar_2.getHeadConcAtom() , res) ; }}}if ( tomMatch351NameNumber_end_4.isEmptyConcAtom() ) {tomMatch351NameNumber_end_4=tomMatch351NameNumber_begin_3;} else {tomMatch351NameNumber_end_4= tomMatch351NameNumber_end_4.getTailConcAtom() ;}}} while(!( (tomMatch351NameNumber_end_4==tomMatch351NameNumber_begin_3) ));}}}}}}}}

    return res;
  }

  private void fill(String moduleName, Production p) {
    {{ Object tomMatch352NameNumber_freshVar_0=p;if ( (tomMatch352NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch352NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch352NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Production  tomMatch352NameNumber_freshVar_4=tomMatch352NameNumber_freshSubject_1;if ( (tomMatch352NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.production.SortType) ) {{  tom.gom.adt.gom.types.GomType  tomMatch352NameNumber_freshVar_1= tomMatch352NameNumber_freshVar_4.getType() ;{  tom.gom.adt.gom.types.AtomList  tomMatch352NameNumber_freshVar_2= tomMatch352NameNumber_freshVar_4.getBinds() ;{  tom.gom.adt.gom.types.ProductionList  tomMatch352NameNumber_freshVar_3= tomMatch352NameNumber_freshVar_4.getProductionList() ;{  tom.gom.adt.gom.types.GomType  tomMatch352NameNumber_freshVar_7=tomMatch352NameNumber_freshVar_1;if ( (tomMatch352NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.gomtype.GomType) ) {{  tom.gom.adt.gom.types.TypeSpec  tomMatch352NameNumber_freshVar_5= tomMatch352NameNumber_freshVar_7.getSpecialization() ;{  String  tomMatch352NameNumber_freshVar_6= tomMatch352NameNumber_freshVar_7.getName() ;{  tom.gom.adt.gom.types.TypeSpec  tom_spe=tomMatch352NameNumber_freshVar_5;{  String  tom_n=tomMatch352NameNumber_freshVar_6;{  tom.gom.adt.gom.types.ProductionList  tom_pl=tomMatch352NameNumber_freshVar_3;


          // filling sorts (except AccessibleAtoms)
          StringList cons = getConstructors(tom_pl);
          StringList bound = convertBoundAtoms(tomMatch352NameNumber_freshVar_2);
          StringList empty =  tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ;
          FreshSortInfo info = null;
          {{ Object tomMatch353NameNumber_freshVar_0=tom_spe;if ( (tomMatch353NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.TypeSpec) ) {{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.TypeSpec )tomMatch353NameNumber_freshVar_0);{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshVar_1=tomMatch353NameNumber_freshSubject_1;if ( (tomMatch353NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.typespec.ExpressionType) ) {
 info =  tom.gom.adt.symboltable.types.freshsortinfo.ExpressionTypeInfo.make(empty) ; }}}}}{ Object tomMatch353NameNumber_freshVar_2=tom_spe;if ( (tomMatch353NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.TypeSpec) ) {{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.TypeSpec )tomMatch353NameNumber_freshVar_2);{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshVar_3=tomMatch353NameNumber_freshSubject_1;if ( (tomMatch353NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.typespec.PatternType) ) {
 info =  tom.gom.adt.symboltable.types.freshsortinfo.PatternTypeInfo.make(bound, empty) ; }}}}}{ Object tomMatch353NameNumber_freshVar_4=tom_spe;if ( (tomMatch353NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.TypeSpec) ) {{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.TypeSpec )tomMatch353NameNumber_freshVar_4);{  tom.gom.adt.gom.types.TypeSpec  tomMatch353NameNumber_freshVar_5=tomMatch353NameNumber_freshSubject_1;if ( (tomMatch353NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.typespec.AtomType) ) {
 info =  tom.gom.adt.symboltable.types.freshsortinfo.AtomTypeInfo.make() ; }}}}}}

          sorts.put(tom_n, tom.gom.adt.symboltable.types.sortdescription.SortDescription.make(cons, moduleName, info) );
          // filling constructors
          {{ Object tomMatch354NameNumber_freshVar_0=tom_pl;if ( (tomMatch354NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ProductionList) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ProductionList )tomMatch354NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_freshVar_1=tomMatch354NameNumber_freshSubject_1;if ( ((tomMatch354NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.ConsConcProduction) || (tomMatch354NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.productionlist.EmptyConcProduction)) ) {{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_begin_3=tomMatch354NameNumber_freshVar_1;{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_end_4=tomMatch354NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_freshVar_2=tomMatch354NameNumber_end_4;if (!( tomMatch354NameNumber_freshVar_2.isEmptyConcProduction() )) {{  tom.gom.adt.gom.types.ProductionList  tomMatch354NameNumber_freshVar_5= tomMatch354NameNumber_freshVar_2.getTailConcProduction() ;fillCons(tom_n, tomMatch354NameNumber_freshVar_2.getHeadConcProduction() )
; }}}if ( tomMatch354NameNumber_end_4.isEmptyConcProduction() ) {tomMatch354NameNumber_end_4=tomMatch354NameNumber_begin_3;} else {tomMatch354NameNumber_end_4= tomMatch354NameNumber_end_4.getTailConcProduction() ;}}} while(!( (tomMatch354NameNumber_end_4==tomMatch354NameNumber_begin_3) ));}}}}}}}}

        }}}}}}}}}}}}}}}}

  }


  private void fillCons(String codom, Production p)  {
    {{ Object tomMatch355NameNumber_freshVar_0=p;if ( (tomMatch355NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.Production) ) {{  tom.gom.adt.gom.types.Production  tomMatch355NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.Production )tomMatch355NameNumber_freshVar_0);{  tom.gom.adt.gom.types.Production  tomMatch355NameNumber_freshVar_3=tomMatch355NameNumber_freshSubject_1;if ( (tomMatch355NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.production.Production) ) {{  String  tomMatch355NameNumber_freshVar_1= tomMatch355NameNumber_freshVar_3.getName() ;{  tom.gom.adt.gom.types.FieldList  tomMatch355NameNumber_freshVar_2= tomMatch355NameNumber_freshVar_3.getDomainList() ;{  String  tom_n=tomMatch355NameNumber_freshVar_1;{  tom.gom.adt.gom.types.FieldList  tom_dl=tomMatch355NameNumber_freshVar_2;{{ Object tomMatch356NameNumber_freshVar_0=tom_dl;if ( (tomMatch356NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.FieldList) ) {{  tom.gom.adt.gom.types.FieldList  tomMatch356NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.FieldList )tomMatch356NameNumber_freshVar_0);{  tom.gom.adt.gom.types.FieldList  tomMatch356NameNumber_freshVar_1=tomMatch356NameNumber_freshSubject_1;if ( ((tomMatch356NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.fieldlist.ConsConcField) || (tomMatch356NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.fieldlist.EmptyConcField)) ) {if (!( tomMatch356NameNumber_freshVar_1.isEmptyConcField() )) {{  tom.gom.adt.gom.types.Field  tomMatch356NameNumber_freshVar_5= tomMatch356NameNumber_freshVar_1.getHeadConcField() ;if ( (tomMatch356NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.field.StarredField) ) {{  tom.gom.adt.gom.types.GomType  tomMatch356NameNumber_freshVar_3= tomMatch356NameNumber_freshVar_5.getFieldType() ;{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch356NameNumber_freshVar_4= tomMatch356NameNumber_freshVar_5.getSpecifier() ;{  tom.gom.adt.gom.types.GomType  tomMatch356NameNumber_freshVar_7=tomMatch356NameNumber_freshVar_3;if ( (tomMatch356NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.gomtype.GomType) ) {{  String  tomMatch356NameNumber_freshVar_6= tomMatch356NameNumber_freshVar_7.getName() ;{  tom.gom.adt.gom.types.FieldList  tomMatch356NameNumber_freshVar_2= tomMatch356NameNumber_freshVar_1.getTailConcField() ;if ( tomMatch356NameNumber_freshVar_2.isEmptyConcField() ) {





            constructors.put(tom_n,
                 tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription.make(codom, tomMatch356NameNumber_freshVar_6, tomMatch356NameNumber_freshVar_4.isRefresh()) );
            return; 
          }}}}}}}}}}}}}}}{ Object tomMatch356NameNumber_freshVar_8=tom_dl;if ( (tomMatch356NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.FieldList) ) {{  tom.gom.adt.gom.types.FieldList  tomMatch356NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.FieldList )tomMatch356NameNumber_freshVar_8);
 
            FieldDescriptionList fl = getFieldList(codom,tom_dl);
            constructors.put(tom_n, tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription.make(codom, fl,  tom.gom.adt.symboltable.types.generationinfo.No.make() ) );
          }}}}

      }}}}}}}}}}

  }

  private FieldDescriptionList getFieldList(String codom, FieldList dl) {
    FieldDescriptionList res =  tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ;
    {{ Object tomMatch357NameNumber_freshVar_0=dl;if ( (tomMatch357NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.FieldList) ) {{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.FieldList )tomMatch357NameNumber_freshVar_0);{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_freshVar_1=tomMatch357NameNumber_freshSubject_1;if ( ((tomMatch357NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.fieldlist.ConsConcField) || (tomMatch357NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.fieldlist.EmptyConcField)) ) {{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_begin_3=tomMatch357NameNumber_freshVar_1;{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_end_4=tomMatch357NameNumber_freshVar_1;do {{{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_freshVar_2=tomMatch357NameNumber_end_4;if (!( tomMatch357NameNumber_freshVar_2.isEmptyConcField() )) {{  tom.gom.adt.gom.types.Field  tomMatch357NameNumber_freshVar_10= tomMatch357NameNumber_freshVar_2.getHeadConcField() ;if ( (tomMatch357NameNumber_freshVar_10 instanceof tom.gom.adt.gom.types.field.NamedField) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch357NameNumber_freshVar_7= tomMatch357NameNumber_freshVar_10.getSpecifier() ;{  String  tomMatch357NameNumber_freshVar_8= tomMatch357NameNumber_freshVar_10.getName() ;{  tom.gom.adt.gom.types.GomType  tomMatch357NameNumber_freshVar_9= tomMatch357NameNumber_freshVar_10.getFieldType() ;{  tom.gom.adt.gom.types.ScopeSpecifier  tom_spe=tomMatch357NameNumber_freshVar_7;{  tom.gom.adt.gom.types.GomType  tomMatch357NameNumber_freshVar_12=tomMatch357NameNumber_freshVar_9;if ( (tomMatch357NameNumber_freshVar_12 instanceof tom.gom.adt.gom.types.gomtype.GomType) ) {{  String  tomMatch357NameNumber_freshVar_11= tomMatch357NameNumber_freshVar_12.getName() ;{  tom.gom.adt.gom.types.FieldList  tomMatch357NameNumber_freshVar_5= tomMatch357NameNumber_freshVar_2.getTailConcField() ;



        Status st = null;
        {{ Object tomMatch358NameNumber_freshVar_0=tom_spe;if ( (tomMatch358NameNumber_freshVar_0 instanceof tom.gom.adt.gom.types.ScopeSpecifier) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ScopeSpecifier )tomMatch358NameNumber_freshVar_0);{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshVar_1=tomMatch358NameNumber_freshSubject_1;if ( (tomMatch358NameNumber_freshVar_1 instanceof tom.gom.adt.gom.types.scopespecifier.Outer) ) {
 st =  tom.gom.adt.symboltable.types.status.SOuter.make() ; }}}}}{ Object tomMatch358NameNumber_freshVar_2=tom_spe;if ( (tomMatch358NameNumber_freshVar_2 instanceof tom.gom.adt.gom.types.ScopeSpecifier) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ScopeSpecifier )tomMatch358NameNumber_freshVar_2);{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshVar_3=tomMatch358NameNumber_freshSubject_1;if ( (tomMatch358NameNumber_freshVar_3 instanceof tom.gom.adt.gom.types.scopespecifier.Inner) ) {
 st =  tom.gom.adt.symboltable.types.status.SInner.make() ; }}}}}{ Object tomMatch358NameNumber_freshVar_4=tom_spe;if ( (tomMatch358NameNumber_freshVar_4 instanceof tom.gom.adt.gom.types.ScopeSpecifier) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ScopeSpecifier )tomMatch358NameNumber_freshVar_4);{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshVar_5=tomMatch358NameNumber_freshSubject_1;if ( (tomMatch358NameNumber_freshVar_5 instanceof tom.gom.adt.gom.types.scopespecifier.Neutral) ) {
 st =  tom.gom.adt.symboltable.types.status.SNeutral.make() ; }}}}}{ Object tomMatch358NameNumber_freshVar_6=tom_spe;if ( (tomMatch358NameNumber_freshVar_6 instanceof tom.gom.adt.gom.types.ScopeSpecifier) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ScopeSpecifier )tomMatch358NameNumber_freshVar_6);{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshVar_7=tomMatch358NameNumber_freshSubject_1;if ( (tomMatch358NameNumber_freshVar_7 instanceof tom.gom.adt.gom.types.scopespecifier.None) ) {
 st = isPatternType(codom) ?  tom.gom.adt.symboltable.types.status.SPattern.make()  :  tom.gom.adt.symboltable.types.status.SNone.make() ; }}}}}{ Object tomMatch358NameNumber_freshVar_8=tom_spe;if ( (tomMatch358NameNumber_freshVar_8 instanceof tom.gom.adt.gom.types.ScopeSpecifier) ) {{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshSubject_1=(( tom.gom.adt.gom.types.ScopeSpecifier )tomMatch358NameNumber_freshVar_8);{  tom.gom.adt.gom.types.ScopeSpecifier  tomMatch358NameNumber_freshVar_9=tomMatch358NameNumber_freshSubject_1;if ( (tomMatch358NameNumber_freshVar_9 instanceof tom.gom.adt.gom.types.scopespecifier.Refresh) ) {
 st =  tom.gom.adt.symboltable.types.status.SRefreshPoint.make() ; }}}}}}

        FieldDescription desc =  tom.gom.adt.symboltable.types.fielddescription.FieldDescription.make(tomMatch357NameNumber_freshVar_8, tomMatch357NameNumber_freshVar_11, st) ;
        res = tom_append_list_concFieldDescription(res, tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription.make(desc, tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription.make() ) );
      }}}}}}}}}}}}if ( tomMatch357NameNumber_end_4.isEmptyConcField() ) {tomMatch357NameNumber_end_4=tomMatch357NameNumber_begin_3;} else {tomMatch357NameNumber_end_4= tomMatch357NameNumber_end_4.getTailConcField() ;}}} while(!( (tomMatch357NameNumber_end_4==tomMatch357NameNumber_begin_3) ));}}}}}}}}

    return res;
  }

  private void setAccessibleAtoms(String sort, StringList atoms) {
    SortDescription desc = sorts.get(sort);
    SortDescription ndesc = null;
    {{ Object tomMatch359NameNumber_freshVar_0=desc;if ( (tomMatch359NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.SortDescription) ) {{  tom.gom.adt.symboltable.types.SortDescription  tomMatch359NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.SortDescription )tomMatch359NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.SortDescription  tomMatch359NameNumber_freshVar_2=tomMatch359NameNumber_freshSubject_1;if ( (tomMatch359NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.sortdescription.SortDescription) ) {{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch359NameNumber_freshVar_1= tomMatch359NameNumber_freshVar_2.getFreshInfo() ;

        ndesc = desc.setFreshInfo(tomMatch359NameNumber_freshVar_1.setAccessibleAtoms(atoms));
      }}}}}}}

    sorts.put(sort,ndesc);
  }

  private void setFreshSortInfo(String sort, FreshSortInfo i) {
    SortDescription desc = sorts.get(sort);
    sorts.put(sort,desc.setFreshInfo(i));
  }

  public boolean isVariadic(String cons) {
    try {
      ConstructorDescription desc = constructors.get(cons);
      {{ Object tomMatch360NameNumber_freshVar_0=desc;if ( (tomMatch360NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch360NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch360NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch360NameNumber_freshVar_1=tomMatch360NameNumber_freshSubject_1;if ( (tomMatch360NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) { return true; }}}}}}
      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredConstructorException(cons);
    }
  }

  public boolean isGenerated(String cons) {
    try {
      ConstructorDescription desc = constructors.get(cons);
      {{ Object tomMatch361NameNumber_freshVar_0=desc;if ( (tomMatch361NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch361NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch361NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch361NameNumber_freshVar_2=tomMatch361NameNumber_freshSubject_1;if ( (tomMatch361NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch361NameNumber_freshVar_1= tomMatch361NameNumber_freshVar_2.getGenerated() ;{ boolean tomMatch361NameNumber_freshVar_4= false ;{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch361NameNumber_freshVar_3=tomMatch361NameNumber_freshVar_1;if ( (tomMatch361NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.generationinfo.No) ) {tomMatch361NameNumber_freshVar_4= true ;}}if ( tomMatch361NameNumber_freshVar_4== false  ) {
 
          return true; 
        }}}}}}}}}

      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredConstructorException(cons);
    }
  }

  public boolean isGeneratedCons(String cons) {
    try {
      ConstructorDescription desc = constructors.get(cons);
      {{ Object tomMatch362NameNumber_freshVar_0=desc;if ( (tomMatch362NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch362NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch362NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch362NameNumber_freshVar_2=tomMatch362NameNumber_freshSubject_1;if ( (tomMatch362NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch362NameNumber_freshVar_1= tomMatch362NameNumber_freshVar_2.getGenerated() ;{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch362NameNumber_freshVar_3=tomMatch362NameNumber_freshVar_1;if ( (tomMatch362NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.generationinfo.GenCons) ) {
 
          return true; 
        }}}}}}}}}

      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredConstructorException(cons);
    }
  }

  public boolean isGeneratedNil(String cons) {
    try {
      ConstructorDescription desc = constructors.get(cons);
      {{ Object tomMatch363NameNumber_freshVar_0=desc;if ( (tomMatch363NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch363NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch363NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch363NameNumber_freshVar_2=tomMatch363NameNumber_freshSubject_1;if ( (tomMatch363NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch363NameNumber_freshVar_1= tomMatch363NameNumber_freshVar_2.getGenerated() ;{  tom.gom.adt.symboltable.types.GenerationInfo  tomMatch363NameNumber_freshVar_3=tomMatch363NameNumber_freshVar_1;if ( (tomMatch363NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.generationinfo.GenNil) ) {
 
          return true; 
        }}}}}}}}}

      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredConstructorException(cons);
    }
  }

  private GenerationInfo getGenerated(String cons) {
    ConstructorDescription desc = constructors.get(cons);
    return desc.getGenerated();
  }

  /**
  * precondition : isGenerated(cons)
  */
  public String getBaseName(String cons) {
    return getGenerated(cons).getBaseName();
  }



  public boolean isExpressionType(String sort) {
    if (GomEnvironment.getInstance().isBuiltin(sort)) return false;
    try {
      FreshSortInfo i = sorts.get(sort).getFreshInfo();
      {{ Object tomMatch364NameNumber_freshVar_0=i;if ( (tomMatch364NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FreshSortInfo) ) {{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch364NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FreshSortInfo )tomMatch364NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch364NameNumber_freshVar_1=tomMatch364NameNumber_freshSubject_1;if ( (tomMatch364NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.freshsortinfo.ExpressionTypeInfo) ) { return true; }}}}}}
      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredSortException(sort);
    }
  }

  public boolean isPatternType(String sort) {
    if (GomEnvironment.getInstance().isBuiltin(sort)) return false;
    try {
      FreshSortInfo i = sorts.get(sort).getFreshInfo();
      {{ Object tomMatch365NameNumber_freshVar_0=i;if ( (tomMatch365NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FreshSortInfo) ) {{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch365NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FreshSortInfo )tomMatch365NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch365NameNumber_freshVar_1=tomMatch365NameNumber_freshSubject_1;if ( (tomMatch365NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.freshsortinfo.PatternTypeInfo) ) { return true; }}}}}}
      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredSortException(sort);
    }
  }

  public boolean isAtomType(String sort) {
    if (GomEnvironment.getInstance().isBuiltin(sort)) return false;
    try {
      FreshSortInfo i = sorts.get(sort).getFreshInfo();
      {{ Object tomMatch366NameNumber_freshVar_0=i;if ( (tomMatch366NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FreshSortInfo) ) {{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch366NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FreshSortInfo )tomMatch366NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch366NameNumber_freshVar_1=tomMatch366NameNumber_freshSubject_1;if ( (tomMatch366NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.freshsortinfo.AtomTypeInfo) ) { return true; }}}}}}
      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredSortException(sort);
    }
  }

  /**
   * true if sort is concerned by freshgom
   **/
  public boolean isFreshType(String sort) {
    try {
      FreshSortInfo i = sorts.get(sort).getFreshInfo();
      {{ Object tomMatch367NameNumber_freshVar_0=i;if ( (tomMatch367NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FreshSortInfo) ) {{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch367NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FreshSortInfo )tomMatch367NameNumber_freshVar_0);{ boolean tomMatch367NameNumber_freshVar_2= false ;{  tom.gom.adt.symboltable.types.FreshSortInfo  tomMatch367NameNumber_freshVar_1=tomMatch367NameNumber_freshSubject_1;if ( (tomMatch367NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.freshsortinfo.NoFreshSort) ) {tomMatch367NameNumber_freshVar_2= true ;}}if ( tomMatch367NameNumber_freshVar_2== false  ) { return true; }}}}}}
      return false;
    } catch (NullPointerException e) {
      throw new UndeclaredSortException(sort);
    }
  }

  public boolean isBuiltin(String sort) {
    {{  String  tomMatch368NameNumber_freshVar_0=sort;if ( true ) {{  String  tomMatch368NameNumber_freshSubject_1=(( String )tomMatch368NameNumber_freshVar_0);{  String  tomMatch368NameNumber_freshVar_1=tomMatch368NameNumber_freshSubject_1;{ boolean tomMatch368NameNumber_freshVar_2= false ;if ( "boolean".equals(tomMatch368NameNumber_freshVar_1) ) {tomMatch368NameNumber_freshVar_2= true ;} else {if ( "String".equals(tomMatch368NameNumber_freshVar_1) ) {tomMatch368NameNumber_freshVar_2= true ;} else {if ( "int".equals(tomMatch368NameNumber_freshVar_1) ) {tomMatch368NameNumber_freshVar_2= true ;}}}if ( tomMatch368NameNumber_freshVar_2== true  ) {
 return true; }}}}}}}

    return false;
  }

  public static class SetRefreshPoints extends tom.library.sl.BasicStrategy {private  tom.gom.SymbolTable  st;private  String  codom;public SetRefreshPoints( tom.gom.SymbolTable  st,  String  codom) {super(( new tom.library.sl.Identity() ));this.st=st;this.codom=codom;}public  tom.gom.SymbolTable  getst() {return st;}public  String  getcodom() {return codom;}public tom.library.sl.Visitable[] getChildren() {tom.library.sl.Visitable[] stratChilds = new tom.library.sl.Visitable[getChildCount()];stratChilds[0] = super.getChildAt(0);return stratChilds;}public tom.library.sl.Visitable setChildren(tom.library.sl.Visitable[] children) {super.setChildAt(0, children[0]);return this;}public int getChildCount() {return 1;}public tom.library.sl.Visitable getChildAt(int index) {switch (index) {case 0: return super.getChildAt(0);default: throw new IndexOutOfBoundsException();}}public tom.library.sl.Visitable setChildAt(int index, tom.library.sl.Visitable child) {switch (index) {case 0: return super.setChildAt(0, child);default: throw new IndexOutOfBoundsException();}}public  tom.gom.adt.symboltable.types.FieldDescription  visit_FieldDescription( tom.gom.adt.symboltable.types.FieldDescription  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch369NameNumber_freshVar_0=tom__arg;if ( (tomMatch369NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescription) ) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch369NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescription )tomMatch369NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch369NameNumber_freshVar_2=tomMatch369NameNumber_freshSubject_1;if ( (tomMatch369NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch369NameNumber_freshVar_1= tomMatch369NameNumber_freshVar_2.getSort() ;




          if(st.isExpressionType(codom) && st.isPatternType(tomMatch369NameNumber_freshVar_1)) {
            return tomMatch369NameNumber_freshSubject_1.setStatusValue( tom.gom.adt.symboltable.types.status.SRefreshPoint.make() );
          }
        }}}}}}}return _visit_FieldDescription(tom__arg,introspector); }public  tom.gom.adt.symboltable.types.ConstructorDescription  visit_ConstructorDescription( tom.gom.adt.symboltable.types.ConstructorDescription  tom__arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {{{ Object tomMatch370NameNumber_freshVar_0=tom__arg;if ( (tomMatch370NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch370NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch370NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch370NameNumber_freshVar_2=tomMatch370NameNumber_freshSubject_1;if ( (tomMatch370NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch370NameNumber_freshVar_1= tomMatch370NameNumber_freshVar_2.getDomain() ;



          if(st.isExpressionType(codom) && st.isPatternType(tomMatch370NameNumber_freshVar_1)) {
            return tomMatch370NameNumber_freshSubject_1.setIsRefreshPoint(true);
          }
        }}}}}}}return _visit_ConstructorDescription(tom__arg,introspector); }public  tom.gom.adt.symboltable.types.FieldDescription  _visit_FieldDescription( tom.gom.adt.symboltable.types.FieldDescription  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.gom.adt.symboltable.types.FieldDescription )any.visit(environment,introspector));} else {return (( tom.gom.adt.symboltable.types.FieldDescription )any.visitLight(arg,introspector));} }public  tom.gom.adt.symboltable.types.ConstructorDescription  _visit_ConstructorDescription( tom.gom.adt.symboltable.types.ConstructorDescription  arg, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if (!( environment== null  )) {return (( tom.gom.adt.symboltable.types.ConstructorDescription )any.visit(environment,introspector));} else {return (( tom.gom.adt.symboltable.types.ConstructorDescription )any.visitLight(arg,introspector));} }public Object visitLight(Object v, tom.library.sl.Introspector introspector) throws tom.library.sl.VisitFailure {if ( (v instanceof tom.gom.adt.symboltable.types.FieldDescription) ) {return visit_FieldDescription((( tom.gom.adt.symboltable.types.FieldDescription )v),introspector);}if ( (v instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {return visit_ConstructorDescription((( tom.gom.adt.symboltable.types.ConstructorDescription )v),introspector);}if (!( environment== null  )) {return any.visit(environment,introspector);} else {return any.visitLight(v,introspector);} }}public static  tom.library.sl.Strategy  tom_make_SetRefreshPoints( tom.gom.SymbolTable  t0,  String  t1) { return new SetRefreshPoints(t0,t1);}



  private void fillRefreshPoints() {
    for(Map.Entry<String,ConstructorDescription> e: 
        constructors.entrySet()) {
      String c = e.getKey();
      ConstructorDescription cd = e.getValue();
      String codom = cd.getSortSymbol();
      try {
        ConstructorDescription ncd = (ConstructorDescription)
          tom_make_TopDown(tom_make_SetRefreshPoints(this,codom)).visit(cd);
        constructors.put(c,ncd);
      } catch(Exception ex) { throw new RuntimeException(); }
    }
  }

  public tom.gom.adt.symboltable.types.stringlist.StringList 
    getConstructors(String sort) {
      return (tom.gom.adt.symboltable.types.stringlist.StringList)
        sorts.get(sort).getConstructors();
    }

  public String getSort(String constructor) {
    try { return constructors.get(constructor).getSortSymbol(); }
    catch(NullPointerException e) {
      throw new UndeclaredConstructorException(constructor);
    }
  }

  public String getChildSort(String constructor,int omega) {
    try {
      ConstructorDescription c = constructors.get(constructor);  
      int count=1;

      {{ Object tomMatch371NameNumber_freshVar_0=c;if ( (tomMatch371NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch371NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch371NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch371NameNumber_freshVar_2=tomMatch371NameNumber_freshSubject_1;if ( (tomMatch371NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch371NameNumber_freshVar_1= tomMatch371NameNumber_freshVar_2.getDomain() ;


          return tomMatch371NameNumber_freshVar_1;
        }}}}}}{ Object tomMatch371NameNumber_freshVar_3=c;if ( (tomMatch371NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch371NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch371NameNumber_freshVar_3);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch371NameNumber_freshVar_5=tomMatch371NameNumber_freshSubject_1;if ( (tomMatch371NameNumber_freshVar_5 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_freshVar_4= tomMatch371NameNumber_freshVar_5.getFields() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_freshVar_6=tomMatch371NameNumber_freshVar_4;if ( ((tomMatch371NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch371NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_begin_8=tomMatch371NameNumber_freshVar_6;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_end_9=tomMatch371NameNumber_freshVar_6;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_freshVar_7=tomMatch371NameNumber_end_9;if (!( tomMatch371NameNumber_freshVar_7.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch371NameNumber_freshVar_13= tomMatch371NameNumber_freshVar_7.getHeadconcFieldDescription() ;if ( (tomMatch371NameNumber_freshVar_13 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch371NameNumber_freshVar_12= tomMatch371NameNumber_freshVar_13.getSort() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch371NameNumber_freshVar_10= tomMatch371NameNumber_freshVar_7.getTailconcFieldDescription() ;


          if (count==omega) {
            return tomMatch371NameNumber_freshVar_12;
          } else {
            count++;
          }
        }}}}}}if ( tomMatch371NameNumber_end_9.isEmptyconcFieldDescription() ) {tomMatch371NameNumber_end_9=tomMatch371NameNumber_begin_8;} else {tomMatch371NameNumber_end_9= tomMatch371NameNumber_end_9.getTailconcFieldDescription() ;}}} while(!( (tomMatch371NameNumber_end_9==tomMatch371NameNumber_begin_8) ));}}}}}}}}}}}

    } catch(NullPointerException e) {
      throw new UndeclaredConstructorException(constructor);
    }
    throw new RuntimeException("Cannot access to the "+omega+"ith child of the constructor "+constructor);
  }

  public tom.gom.adt.symboltable.types.stringlist.StringList 
    getAccessibleAtoms(String sort) {
      try {
        return (tom.gom.adt.symboltable.types.stringlist.StringList)
          sorts.get(sort).getFreshInfo().getAccessibleAtoms();
      } catch(NullPointerException e) {
        throw new UndeclaredSortException(sort);
      }
    }

  public tom.gom.adt.symboltable.types.stringlist.StringList 
    getBoundAtoms(String sort) {
      return (tom.gom.adt.symboltable.types.stringlist.StringList)
        sorts.get(sort).getFreshInfo().getBoundAtoms();
    }

  private FieldDescriptionList getFieldList(String constructor) {
    return constructors.get(constructor).getFields();
  }

  public ArrayList<String> getFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch372NameNumber_freshVar_0=l;if ( (tomMatch372NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch372NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_freshVar_1=tomMatch372NameNumber_freshSubject_1;if ( ((tomMatch372NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch372NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_begin_3=tomMatch372NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_end_4=tomMatch372NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_freshVar_2=tomMatch372NameNumber_end_4;if (!( tomMatch372NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch372NameNumber_freshVar_8= tomMatch372NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch372NameNumber_freshVar_8 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch372NameNumber_freshVar_7= tomMatch372NameNumber_freshVar_8.getFieldName() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch372NameNumber_freshVar_5= tomMatch372NameNumber_freshVar_2.getTailconcFieldDescription() ;

        result.add(tomMatch372NameNumber_freshVar_7);
      }}}}}}if ( tomMatch372NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch372NameNumber_end_4=tomMatch372NameNumber_begin_3;} else {tomMatch372NameNumber_end_4= tomMatch372NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch372NameNumber_end_4==tomMatch372NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  public ArrayList<String> getNeutralFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch373NameNumber_freshVar_0=l;if ( (tomMatch373NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch373NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_freshVar_1=tomMatch373NameNumber_freshSubject_1;if ( ((tomMatch373NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch373NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_begin_3=tomMatch373NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_end_4=tomMatch373NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_freshVar_2=tomMatch373NameNumber_end_4;if (!( tomMatch373NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch373NameNumber_freshVar_9= tomMatch373NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch373NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch373NameNumber_freshVar_7= tomMatch373NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch373NameNumber_freshVar_8= tomMatch373NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch373NameNumber_freshVar_10=tomMatch373NameNumber_freshVar_8;if ( (tomMatch373NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SNeutral) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch373NameNumber_freshVar_5= tomMatch373NameNumber_freshVar_2.getTailconcFieldDescription() ;


        result.add(tomMatch373NameNumber_freshVar_7);
      }}}}}}}}}if ( tomMatch373NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch373NameNumber_end_4=tomMatch373NameNumber_begin_3;} else {tomMatch373NameNumber_end_4= tomMatch373NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch373NameNumber_end_4==tomMatch373NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  public ArrayList<String> getPatternFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch374NameNumber_freshVar_0=l;if ( (tomMatch374NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch374NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_freshVar_1=tomMatch374NameNumber_freshSubject_1;if ( ((tomMatch374NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch374NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_begin_3=tomMatch374NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_end_4=tomMatch374NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_freshVar_2=tomMatch374NameNumber_end_4;if (!( tomMatch374NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch374NameNumber_freshVar_9= tomMatch374NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch374NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch374NameNumber_freshVar_7= tomMatch374NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch374NameNumber_freshVar_8= tomMatch374NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch374NameNumber_freshVar_10=tomMatch374NameNumber_freshVar_8;if ( (tomMatch374NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SPattern) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch374NameNumber_freshVar_5= tomMatch374NameNumber_freshVar_2.getTailconcFieldDescription() ;


        result.add(tomMatch374NameNumber_freshVar_7);
      }}}}}}}}}if ( tomMatch374NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch374NameNumber_end_4=tomMatch374NameNumber_begin_3;} else {tomMatch374NameNumber_end_4= tomMatch374NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch374NameNumber_end_4==tomMatch374NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  /**
  * generates 'getfield()' except for HeadC and TailC
  * where it generates 'getHeadRawC()' and 'getTailRawC()'
  **/
  public String rawGetter(String cons, String field) {
    if (isGenerated(cons)) {
      String suffix = getBaseName(cons);
      if (field.startsWith("Head")) {
        return "getHeadRaw" + suffix + "()";
      } else if (field.startsWith("Tail")) {
        return "getTailRaw" + suffix + "()";
      }
    }
    return "get" + field + "()";
  }

  public ArrayList<String> getNonPatternFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch375NameNumber_freshVar_0=l;if ( (tomMatch375NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch375NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_freshVar_1=tomMatch375NameNumber_freshSubject_1;if ( ((tomMatch375NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch375NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_begin_3=tomMatch375NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_end_4=tomMatch375NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_freshVar_2=tomMatch375NameNumber_end_4;if (!( tomMatch375NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch375NameNumber_freshVar_9= tomMatch375NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch375NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch375NameNumber_freshVar_7= tomMatch375NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch375NameNumber_freshVar_8= tomMatch375NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch375NameNumber_freshVar_5= tomMatch375NameNumber_freshVar_2.getTailconcFieldDescription() ;{ boolean tomMatch375NameNumber_freshVar_11= false ;{  tom.gom.adt.symboltable.types.Status  tomMatch375NameNumber_freshVar_10=tomMatch375NameNumber_freshVar_8;if ( (tomMatch375NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SPattern) ) {tomMatch375NameNumber_freshVar_11= true ;}}if ( tomMatch375NameNumber_freshVar_11== false  ) {


        result.add(tomMatch375NameNumber_freshVar_7);
      }}}}}}}}}if ( tomMatch375NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch375NameNumber_end_4=tomMatch375NameNumber_begin_3;} else {tomMatch375NameNumber_end_4= tomMatch375NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch375NameNumber_end_4==tomMatch375NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  public ArrayList<String> getOuterFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch376NameNumber_freshVar_0=l;if ( (tomMatch376NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch376NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_freshVar_1=tomMatch376NameNumber_freshSubject_1;if ( ((tomMatch376NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch376NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_begin_3=tomMatch376NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_end_4=tomMatch376NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_freshVar_2=tomMatch376NameNumber_end_4;if (!( tomMatch376NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch376NameNumber_freshVar_9= tomMatch376NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch376NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch376NameNumber_freshVar_7= tomMatch376NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch376NameNumber_freshVar_8= tomMatch376NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch376NameNumber_freshVar_10=tomMatch376NameNumber_freshVar_8;if ( (tomMatch376NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SOuter) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch376NameNumber_freshVar_5= tomMatch376NameNumber_freshVar_2.getTailconcFieldDescription() ;


        result.add(tomMatch376NameNumber_freshVar_7);
      }}}}}}}}}if ( tomMatch376NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch376NameNumber_end_4=tomMatch376NameNumber_begin_3;} else {tomMatch376NameNumber_end_4= tomMatch376NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch376NameNumber_end_4==tomMatch376NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  public ArrayList<String> getInnerFields(String constructor) {
    ArrayList<String> result = new ArrayList<String>();
    FieldDescriptionList l = getFieldList(constructor);
    {{ Object tomMatch377NameNumber_freshVar_0=l;if ( (tomMatch377NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch377NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_freshVar_1=tomMatch377NameNumber_freshSubject_1;if ( ((tomMatch377NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch377NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_begin_3=tomMatch377NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_end_4=tomMatch377NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_freshVar_2=tomMatch377NameNumber_end_4;if (!( tomMatch377NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch377NameNumber_freshVar_9= tomMatch377NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch377NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch377NameNumber_freshVar_7= tomMatch377NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch377NameNumber_freshVar_8= tomMatch377NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch377NameNumber_freshVar_10=tomMatch377NameNumber_freshVar_8;if ( (tomMatch377NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SInner) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch377NameNumber_freshVar_5= tomMatch377NameNumber_freshVar_2.getTailconcFieldDescription() ;


        result.add(tomMatch377NameNumber_freshVar_7);
      }}}}}}}}}if ( tomMatch377NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch377NameNumber_end_4=tomMatch377NameNumber_begin_3;} else {tomMatch377NameNumber_end_4= tomMatch377NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch377NameNumber_end_4==tomMatch377NameNumber_begin_3) ));}}}}}}}}

    return result;
  }

  public String getSort(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch378NameNumber_freshVar_0=l;if ( (tomMatch378NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch378NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_freshVar_1=tomMatch378NameNumber_freshSubject_1;if ( ((tomMatch378NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch378NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_begin_3=tomMatch378NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_end_4=tomMatch378NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_freshVar_2=tomMatch378NameNumber_end_4;if (!( tomMatch378NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch378NameNumber_freshVar_9= tomMatch378NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch378NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch378NameNumber_freshVar_7= tomMatch378NameNumber_freshVar_9.getFieldName() ;{  String  tomMatch378NameNumber_freshVar_8= tomMatch378NameNumber_freshVar_9.getSort() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch378NameNumber_freshVar_5= tomMatch378NameNumber_freshVar_2.getTailconcFieldDescription() ;

        if (tomMatch378NameNumber_freshVar_7.equals(field)) return tomMatch378NameNumber_freshVar_8;
      }}}}}}}if ( tomMatch378NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch378NameNumber_end_4=tomMatch378NameNumber_begin_3;} else {tomMatch378NameNumber_end_4= tomMatch378NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch378NameNumber_end_4==tomMatch378NameNumber_begin_3) ));}}}}}}}}

    throw new RuntimeException("sould never happen");
  }

  public boolean containsRefreshPoint(String cons) {
    ConstructorDescription d = constructors.get(cons);
    {{ Object tomMatch379NameNumber_freshVar_0=d;if ( (tomMatch379NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch379NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch379NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch379NameNumber_freshVar_2=tomMatch379NameNumber_freshSubject_1;if ( (tomMatch379NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  boolean  tomMatch379NameNumber_freshVar_1= tomMatch379NameNumber_freshVar_2.getIsRefreshPoint() ;

        return tomMatch379NameNumber_freshVar_1;
      }}}}}}{ Object tomMatch379NameNumber_freshVar_3=d;if ( (tomMatch379NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch379NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch379NameNumber_freshVar_3);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch379NameNumber_freshVar_5=tomMatch379NameNumber_freshSubject_1;if ( (tomMatch379NameNumber_freshVar_5 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_freshVar_4= tomMatch379NameNumber_freshVar_5.getFields() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_freshVar_6=tomMatch379NameNumber_freshVar_4;if ( ((tomMatch379NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch379NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_begin_8=tomMatch379NameNumber_freshVar_6;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_end_9=tomMatch379NameNumber_freshVar_6;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_freshVar_7=tomMatch379NameNumber_end_9;if (!( tomMatch379NameNumber_freshVar_7.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch379NameNumber_freshVar_13= tomMatch379NameNumber_freshVar_7.getHeadconcFieldDescription() ;if ( (tomMatch379NameNumber_freshVar_13 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  tom.gom.adt.symboltable.types.Status  tomMatch379NameNumber_freshVar_12= tomMatch379NameNumber_freshVar_13.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch379NameNumber_freshVar_14=tomMatch379NameNumber_freshVar_12;if ( (tomMatch379NameNumber_freshVar_14 instanceof tom.gom.adt.symboltable.types.status.SRefreshPoint) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch379NameNumber_freshVar_10= tomMatch379NameNumber_freshVar_7.getTailconcFieldDescription() ;



            return true;
        }}}}}}}}if ( tomMatch379NameNumber_end_9.isEmptyconcFieldDescription() ) {tomMatch379NameNumber_end_9=tomMatch379NameNumber_begin_8;} else {tomMatch379NameNumber_end_9= tomMatch379NameNumber_end_9.getTailconcFieldDescription() ;}}} while(!( (tomMatch379NameNumber_end_9==tomMatch379NameNumber_begin_8) ));}}}}}}}}}}}

    return false;
  }

  public boolean isOuter(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch380NameNumber_freshVar_0=l;if ( (tomMatch380NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch380NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_freshVar_1=tomMatch380NameNumber_freshSubject_1;if ( ((tomMatch380NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch380NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_begin_3=tomMatch380NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_end_4=tomMatch380NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_freshVar_2=tomMatch380NameNumber_end_4;if (!( tomMatch380NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch380NameNumber_freshVar_9= tomMatch380NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch380NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch380NameNumber_freshVar_7= tomMatch380NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch380NameNumber_freshVar_8= tomMatch380NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch380NameNumber_freshVar_10=tomMatch380NameNumber_freshVar_8;if ( (tomMatch380NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SOuter) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch380NameNumber_freshVar_5= tomMatch380NameNumber_freshVar_2.getTailconcFieldDescription() ;


        if (tomMatch380NameNumber_freshVar_7.equals(field)) return true;
      }}}}}}}}}if ( tomMatch380NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch380NameNumber_end_4=tomMatch380NameNumber_begin_3;} else {tomMatch380NameNumber_end_4= tomMatch380NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch380NameNumber_end_4==tomMatch380NameNumber_begin_3) ));}}}}}}}}

    return false;
  }

  public boolean isPattern(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch381NameNumber_freshVar_0=l;if ( (tomMatch381NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch381NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_freshVar_1=tomMatch381NameNumber_freshSubject_1;if ( ((tomMatch381NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch381NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_begin_3=tomMatch381NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_end_4=tomMatch381NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_freshVar_2=tomMatch381NameNumber_end_4;if (!( tomMatch381NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch381NameNumber_freshVar_9= tomMatch381NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch381NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch381NameNumber_freshVar_7= tomMatch381NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch381NameNumber_freshVar_8= tomMatch381NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch381NameNumber_freshVar_10=tomMatch381NameNumber_freshVar_8;if ( (tomMatch381NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SPattern) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch381NameNumber_freshVar_5= tomMatch381NameNumber_freshVar_2.getTailconcFieldDescription() ;


        if (tomMatch381NameNumber_freshVar_7.equals(field)) return true;
      }}}}}}}}}if ( tomMatch381NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch381NameNumber_end_4=tomMatch381NameNumber_begin_3;} else {tomMatch381NameNumber_end_4= tomMatch381NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch381NameNumber_end_4==tomMatch381NameNumber_begin_3) ));}}}}}}}}

    return false;
  }

  public boolean isInner(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch382NameNumber_freshVar_0=l;if ( (tomMatch382NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch382NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_freshVar_1=tomMatch382NameNumber_freshSubject_1;if ( ((tomMatch382NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch382NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_begin_3=tomMatch382NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_end_4=tomMatch382NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_freshVar_2=tomMatch382NameNumber_end_4;if (!( tomMatch382NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch382NameNumber_freshVar_9= tomMatch382NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch382NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch382NameNumber_freshVar_7= tomMatch382NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch382NameNumber_freshVar_8= tomMatch382NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch382NameNumber_freshVar_10=tomMatch382NameNumber_freshVar_8;if ( (tomMatch382NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SInner) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch382NameNumber_freshVar_5= tomMatch382NameNumber_freshVar_2.getTailconcFieldDescription() ;


        if (tomMatch382NameNumber_freshVar_7.equals(field)) return true;
      }}}}}}}}}if ( tomMatch382NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch382NameNumber_end_4=tomMatch382NameNumber_begin_3;} else {tomMatch382NameNumber_end_4= tomMatch382NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch382NameNumber_end_4==tomMatch382NameNumber_begin_3) ));}}}}}}}}

    return false;
  }

  public boolean isNeutral(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch383NameNumber_freshVar_0=l;if ( (tomMatch383NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch383NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_freshVar_1=tomMatch383NameNumber_freshSubject_1;if ( ((tomMatch383NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch383NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_begin_3=tomMatch383NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_end_4=tomMatch383NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_freshVar_2=tomMatch383NameNumber_end_4;if (!( tomMatch383NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch383NameNumber_freshVar_9= tomMatch383NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch383NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch383NameNumber_freshVar_7= tomMatch383NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch383NameNumber_freshVar_8= tomMatch383NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch383NameNumber_freshVar_10=tomMatch383NameNumber_freshVar_8;if ( (tomMatch383NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SNeutral) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch383NameNumber_freshVar_5= tomMatch383NameNumber_freshVar_2.getTailconcFieldDescription() ;


        if (tomMatch383NameNumber_freshVar_7.equals(field)) return true;
      }}}}}}}}}if ( tomMatch383NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch383NameNumber_end_4=tomMatch383NameNumber_begin_3;} else {tomMatch383NameNumber_end_4= tomMatch383NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch383NameNumber_end_4==tomMatch383NameNumber_begin_3) ));}}}}}}}}

    return false;
  }


  /**
  * for variadic operators 
  */
  public boolean isRefreshPoint(String cons) {
    ConstructorDescription d = constructors.get(cons);
    {{ Object tomMatch384NameNumber_freshVar_0=d;if ( (tomMatch384NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch384NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch384NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch384NameNumber_freshVar_2=tomMatch384NameNumber_freshSubject_1;if ( (tomMatch384NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  boolean  tomMatch384NameNumber_freshVar_1= tomMatch384NameNumber_freshVar_2.getIsRefreshPoint() ;
 
        return tomMatch384NameNumber_freshVar_1; 
      }}}}}}}

    return false;
  }

  /**
   * for variadic operators 
   */
  public String getDomain(String cons) {
    ConstructorDescription d = constructors.get(cons);
    {{ Object tomMatch385NameNumber_freshVar_0=d;if ( (tomMatch385NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch385NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch385NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch385NameNumber_freshVar_2=tomMatch385NameNumber_freshSubject_1;if ( (tomMatch385NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch385NameNumber_freshVar_1= tomMatch385NameNumber_freshVar_2.getDomain() ;
 return tomMatch385NameNumber_freshVar_1; }}}}}}}

    throw new RuntimeException("not a variadic operator");
  }

  /**
   * for variadic operators 
   */
  public String getCoDomain(String cons) {
    ConstructorDescription d = constructors.get(cons);
    {{ Object tomMatch386NameNumber_freshVar_0=d;if ( (tomMatch386NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch386NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch386NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch386NameNumber_freshVar_2=tomMatch386NameNumber_freshSubject_1;if ( (tomMatch386NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch386NameNumber_freshVar_1= tomMatch386NameNumber_freshVar_2.getSortSymbol() ;
 return tomMatch386NameNumber_freshVar_1; }}}}}}}

    throw new RuntimeException("not a variadic operator");
  }


  public boolean isRefreshPoint(String cons, String field) {
    FieldDescriptionList l = getFieldList(cons);
    {{ Object tomMatch387NameNumber_freshVar_0=l;if ( (tomMatch387NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.FieldDescriptionList) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.FieldDescriptionList )tomMatch387NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_freshVar_1=tomMatch387NameNumber_freshSubject_1;if ( ((tomMatch387NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch387NameNumber_freshVar_1 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_begin_3=tomMatch387NameNumber_freshVar_1;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_end_4=tomMatch387NameNumber_freshVar_1;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_freshVar_2=tomMatch387NameNumber_end_4;if (!( tomMatch387NameNumber_freshVar_2.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch387NameNumber_freshVar_9= tomMatch387NameNumber_freshVar_2.getHeadconcFieldDescription() ;if ( (tomMatch387NameNumber_freshVar_9 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch387NameNumber_freshVar_7= tomMatch387NameNumber_freshVar_9.getFieldName() ;{  tom.gom.adt.symboltable.types.Status  tomMatch387NameNumber_freshVar_8= tomMatch387NameNumber_freshVar_9.getStatusValue() ;{  tom.gom.adt.symboltable.types.Status  tomMatch387NameNumber_freshVar_10=tomMatch387NameNumber_freshVar_8;if ( (tomMatch387NameNumber_freshVar_10 instanceof tom.gom.adt.symboltable.types.status.SRefreshPoint) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch387NameNumber_freshVar_5= tomMatch387NameNumber_freshVar_2.getTailconcFieldDescription() ;


        if (tomMatch387NameNumber_freshVar_7.equals(field)) return true;
      }}}}}}}}}if ( tomMatch387NameNumber_end_4.isEmptyconcFieldDescription() ) {tomMatch387NameNumber_end_4=tomMatch387NameNumber_begin_3;} else {tomMatch387NameNumber_end_4= tomMatch387NameNumber_end_4.getTailconcFieldDescription() ;}}} while(!( (tomMatch387NameNumber_end_4==tomMatch387NameNumber_begin_3) ));}}}}}}}}

    return false;
  }

  public boolean isBound(String cons, String field) {
    String sort = getSort(cons);
    return getBoundAtoms(sort).contains(getSort(cons,field));
  }

  /**
   * returns the set of all constructor symbols
   **/
  public Set<String> getConstructors() {
    return new HashSet(constructors.keySet());
  }

  /**
   * returns the set of all constructor symbols
   * concerned by freshgom
   **/
  public Set<String> getFreshConstructors() {
    HashSet<String> res = new HashSet();
    for(String c: constructors.keySet())
      if(isFreshType(getSort(c)))
        res.add(c);
    return res;
  }


  /**
   * returns the set of all sort symbols
   **/
  public Set<String> getSorts() {
    return new HashSet(sorts.keySet());
  }

  /**
   * returns only sorts concerned by freshGom
   **/
  public Set<String> getFreshSorts() {
    Set<String> res = getSorts();
    Iterator<String> it = res.iterator();
    while(it.hasNext()) 
      if (!isFreshType(it.next())) it.remove();
    return res;
  }

  public Set<String> getAtoms() {
    Set<String> res = getSorts();
    Iterator<String> it = res.iterator();
    while(it.hasNext()) 
      if (!isAtomType(it.next())) it.remove();
    return res;
  }

  private StringList getAccessibleAtoms
    (String sort, HashSet<String> visited)  {
      if (GomEnvironment.getInstance().isBuiltin(sort) || visited.contains(sort)) return  tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ;
      visited.add(sort);
      if (isAtomType(sort)) return  tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(sort, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ) ;
      StringList res =  tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ;
      for(String c: getConstructors(sort)) {
        ConstructorDescription cd = constructors.get(c);
        {{ Object tomMatch388NameNumber_freshVar_0=cd;if ( (tomMatch388NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch388NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch388NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch388NameNumber_freshVar_2=tomMatch388NameNumber_freshSubject_1;if ( (tomMatch388NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch388NameNumber_freshVar_1= tomMatch388NameNumber_freshVar_2.getDomain() ;

            StringList tyatoms = getAccessibleAtoms(tomMatch388NameNumber_freshVar_1,visited);
            res = tom_append_list_StringList(tyatoms,tom_append_list_StringList(res, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ));
          }}}}}}{ Object tomMatch388NameNumber_freshVar_3=cd;if ( (tomMatch388NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch388NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch388NameNumber_freshVar_3);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch388NameNumber_freshVar_5=tomMatch388NameNumber_freshSubject_1;if ( (tomMatch388NameNumber_freshVar_5 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_freshVar_4= tomMatch388NameNumber_freshVar_5.getFields() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_freshVar_6=tomMatch388NameNumber_freshVar_4;if ( ((tomMatch388NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch388NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_begin_8=tomMatch388NameNumber_freshVar_6;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_end_9=tomMatch388NameNumber_freshVar_6;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_freshVar_7=tomMatch388NameNumber_end_9;if (!( tomMatch388NameNumber_freshVar_7.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch388NameNumber_freshVar_13= tomMatch388NameNumber_freshVar_7.getHeadconcFieldDescription() ;if ( (tomMatch388NameNumber_freshVar_13 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch388NameNumber_freshVar_12= tomMatch388NameNumber_freshVar_13.getSort() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch388NameNumber_freshVar_10= tomMatch388NameNumber_freshVar_7.getTailconcFieldDescription() ;


              StringList tyatoms = getAccessibleAtoms(tomMatch388NameNumber_freshVar_12,visited);
              res = tom_append_list_StringList(tyatoms,tom_append_list_StringList(res, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ));
            }}}}}}if ( tomMatch388NameNumber_end_9.isEmptyconcFieldDescription() ) {tomMatch388NameNumber_end_9=tomMatch388NameNumber_begin_8;} else {tomMatch388NameNumber_end_9= tomMatch388NameNumber_end_9.getTailconcFieldDescription() ;}}} while(!( (tomMatch388NameNumber_end_9==tomMatch388NameNumber_begin_8) ));}}}}}}}}}}}

      }
      return res;
    }

  private void fillAccessibleAtoms() {
    for(String s: getSorts()) {
      if(isExpressionType(s) || isPatternType(s)) {
        StringList atoms = getAccessibleAtoms(s,new HashSet<String>());
        setAccessibleAtoms(s,atoms);
      }
    }
  }

  private void fillGraph() {
    for(String sort: getSorts()) {
      if (GomEnvironment.getInstance().isBuiltin(sort)) continue;
      for(String c: getConstructors(sort)) {
        ConstructorDescription cd = constructors.get(c);
        {{ Object tomMatch389NameNumber_freshVar_0=cd;if ( (tomMatch389NameNumber_freshVar_0 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch389NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch389NameNumber_freshVar_0);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch389NameNumber_freshVar_2=tomMatch389NameNumber_freshSubject_1;if ( (tomMatch389NameNumber_freshVar_2 instanceof tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription) ) {{  String  tomMatch389NameNumber_freshVar_1= tomMatch389NameNumber_freshVar_2.getDomain() ;{  String  tom_ty=tomMatch389NameNumber_freshVar_1;

            if (!GomEnvironment.getInstance().isBuiltin(tom_ty)) 
              graph.addLink(sort,tom_ty);
          }}}}}}}{ Object tomMatch389NameNumber_freshVar_3=cd;if ( (tomMatch389NameNumber_freshVar_3 instanceof tom.gom.adt.symboltable.types.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch389NameNumber_freshSubject_1=(( tom.gom.adt.symboltable.types.ConstructorDescription )tomMatch389NameNumber_freshVar_3);{  tom.gom.adt.symboltable.types.ConstructorDescription  tomMatch389NameNumber_freshVar_5=tomMatch389NameNumber_freshSubject_1;if ( (tomMatch389NameNumber_freshVar_5 instanceof tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_freshVar_4= tomMatch389NameNumber_freshVar_5.getFields() ;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_freshVar_6=tomMatch389NameNumber_freshVar_4;if ( ((tomMatch389NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.ConsconcFieldDescription) || (tomMatch389NameNumber_freshVar_6 instanceof tom.gom.adt.symboltable.types.fielddescriptionlist.EmptyconcFieldDescription)) ) {{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_begin_8=tomMatch389NameNumber_freshVar_6;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_end_9=tomMatch389NameNumber_freshVar_6;do {{{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_freshVar_7=tomMatch389NameNumber_end_9;if (!( tomMatch389NameNumber_freshVar_7.isEmptyconcFieldDescription() )) {{  tom.gom.adt.symboltable.types.FieldDescription  tomMatch389NameNumber_freshVar_13= tomMatch389NameNumber_freshVar_7.getHeadconcFieldDescription() ;if ( (tomMatch389NameNumber_freshVar_13 instanceof tom.gom.adt.symboltable.types.fielddescription.FieldDescription) ) {{  String  tomMatch389NameNumber_freshVar_12= tomMatch389NameNumber_freshVar_13.getSort() ;{  String  tom_ty=tomMatch389NameNumber_freshVar_12;{  tom.gom.adt.symboltable.types.FieldDescriptionList  tomMatch389NameNumber_freshVar_10= tomMatch389NameNumber_freshVar_7.getTailconcFieldDescription() ;


              if (!GomEnvironment.getInstance().isBuiltin(tom_ty)) 
                graph.addLink(sort,tom_ty);
            }}}}}}}if ( tomMatch389NameNumber_end_9.isEmptyconcFieldDescription() ) {tomMatch389NameNumber_end_9=tomMatch389NameNumber_begin_8;} else {tomMatch389NameNumber_end_9= tomMatch389NameNumber_end_9.getTailconcFieldDescription() ;}}} while(!( (tomMatch389NameNumber_end_9==tomMatch389NameNumber_begin_8) ));}}}}}}}}}}}

      }
    }
  }

  /**
   * sets sorts that are not connected to any atom at NoFreshSort
   **/
  private void isolateFreshSorts() {
    Set<String> atoms = getAtoms();
    Set<String> sorts = getSorts();
    Set<String> connected = graph.connected(atoms);
    sorts.removeAll(connected);
    for(String s: sorts) { setFreshSortInfo(s, tom.gom.adt.symboltable.types.freshsortinfo.NoFreshSort.make() ); }
  }

  public void addConstructor(String symbol, String codomain, FieldDescriptionList fields) {
    constructors.put(symbol, tom.gom.adt.symboltable.types.constructordescription.ConstructorDescription.make(codomain, fields,  tom.gom.adt.symboltable.types.generationinfo.No.make() ) );
    SortDescription s = sorts.get(codomain);
    StringList l = s.getConstructors();
    sorts.put(codomain,s.setConstructors(tom_append_list_StringList(l, tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(symbol, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ) )));
  }

  public void addVariadicConstructor(String symbol, String domain, String codomain) {
    constructors.put(symbol, tom.gom.adt.symboltable.types.constructordescription.VariadicConstructorDescription.make(codomain, domain, false) );
    SortDescription s = sorts.get(codomain);
    StringList l = s.getConstructors();
    sorts.put(codomain,s.setConstructors(tom_append_list_StringList(l, tom.gom.adt.symboltable.types.stringlist.ConsStringList.make(symbol, tom.gom.adt.symboltable.types.stringlist.EmptyStringList.make() ) )));
  }

  public void clear() {
    sorts.clear();
    constructors.clear();
  }

}

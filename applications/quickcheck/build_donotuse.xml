<?xml version="1.0" encoding="UTF-8"?>

<project default="javac" basedir=".">

  <property environment="env"/>
  <property name="tom.home"                location="../../src/dist"/>
  <property name="quickcheck.dir"          location="."/>
  <property name="quickcheck.src"          location="${quickcheck.dir}/src"/>
  <property name="quickcheck.gen"          location="${quickcheck.dir}/gen"/>
  <property name="quickcheck.build"        location="${quickcheck.dir}/build"/>
  <property name="quickcheck.package"      value="quickcheck"/>
  <property name="quickcheck.ast"          value="${quickcheck.package}/Ast"/>
  <property name="quickcheck.grammarname"  value="Langage"/>
  <property name="quickcheck.grammar"      value="${quickcheck.package}/${quickcheck.grammarname}"/>

  <import file="${tom.home}/lib/tom-common.xml"/>

  <target name="init" depends="tom.init">
    <mkdir dir="${quickcheck.build}"/>
    <mkdir dir="${quickcheck.gen}"/>
  </target>
  
  <target name="gom" depends="init">
    <gom.preset srcdir="${quickcheck.src}"
                destdir="${quickcheck.gen}">
      <include name="${quickcheck.ast}.gom"/>
    </gom.preset>
  </target>

  <target name="tom" depends="gom">
    <tom.preset srcdir="${quickcheck.src}"
                destdir="${quickcheck.gen}"
                import="${quickcheck.gen}">
      <include name="**/*.t"/>
      <exclude name="**/*.g.t"/>
    </tom.preset>
  </target>

  <target name="javac" depends="tom">
    <javac.preset destdir="${quickcheck.build}" >
      <!--<src path="${quickcheck.src}"/>-->
      <src path="${quickcheck.gen}"/>
      <src path="${quickcheck.src}"/>
      <include name="**/*.java"/>
    </javac.preset>
  </target>

  <target name="clean">
    <delete dir="${quickcheck.gen}"/>
    <delete dir="${quickcheck.build}"/>
  </target>

</project>
